services:
- name: wabi
  git:
    repo_clone_url: https://github.com/azurefoxstudios/wabi
    branch: main
  dockerfile_path: Dockerfile
  wabi:
    build: .
    ports:
      - "3000:3000"
    environment:
      PORT: 3000
      NODE_ENV: production
      FRONTEND_URL: http://localhost:3000
      PUBLIC_URL: http://localhost:3000
    healthcheck:
      test: ["CMD", "bun", "-e", "const r = await fetch('http://localhost:3000/health'); process.exit(r.ok ? 0 : 1)"]
      interval: 30s
      timeout: 5s
      retries: 3
      start_period: 10s
    restart: unless-stopped

