var za=Object.defineProperty;var qa=(s,e,t)=>e in s?za(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t;var Le=(s,e,t)=>qa(s,typeof e!="symbol"?e+"":e,t);import{A as De,s as ot,n as Ce,d as _,O as lt,i as V,e as c,P as X,x as d,f as k,h as D,k as P,Q as $,l as y,m as F,R as or,r as rs,p as Ie,S as Be,b as ne,T as vt,j as Z,t as K,U as ds,y as Ee,o as Ne,B as Is,z as st,V as Dn,W as Ft,q as ja,X as Gl,Y as Wl,Z as me,v as Ha,_ as Ga,$ as Rr,a0 as Yl,I as Wa,a1 as Ya,a2 as Xa,a3 as Xl}from"../chunks/CdCOery0.js";import{a as ke,S as ct,i as ut,f as Lt,d as He,t as Ae,g as xs,c as Us,m as Ge,e as We,b as Ye}from"../chunks/CqCFC2cg.js";import{w as _t}from"../chunks/BHhKbfRM.js";/* empty css                */const Zl=typeof window<"u"?window:typeof globalThis<"u"?globalThis:global;function ze(s){return(s==null?void 0:s.length)!==void 0?s:Array.from(s)}function Kt(s,e){s.d(1),e.delete(s.key)}function Qt(s,e,t,n,r,i,a,l,o,u,f,p){let h=s.length,g=i.length,m=h;const v={};for(;m--;)v[s[m].key]=m;const T=[],C=new Map,E=new Map,S=[];for(m=g;m--;){const w=p(r,i,m),O=t(w);let N=a.get(O);N?S.push(()=>N.p(w,e)):(N=u(O,w),N.c()),C.set(O,T[m]=N),O in v&&E.set(O,Math.abs(m-v[O]))}const b=new Set,A=new Set;function I(w){ke(w,1),w.m(l,f),a.set(w.key,w),f=w.first,g--}for(;h&&g;){const w=T[g-1],O=s[h-1],N=w.key,M=O.key;w===O?(f=w.first,h--,g--):C.has(M)?!a.has(N)||b.has(N)?I(w):A.has(M)?h--:E.get(N)>E.get(M)?(A.add(N),I(w)):(b.add(M),h--):(o(O,a),h--)}for(;h--;){const w=s[h];C.has(w.key)||o(w,a)}for(;g;)I(T[g-1]);return De(S),T}const ss=Object.create(null);ss.open="0";ss.close="1";ss.ping="2";ss.pong="3";ss.message="4";ss.upgrade="5";ss.noop="6";const vn=Object.create(null);Object.keys(ss).forEach(s=>{vn[ss[s]]=s});const Kn={type:"error",data:"parser error"},Kl=typeof Blob=="function"||typeof Blob<"u"&&Object.prototype.toString.call(Blob)==="[object BlobConstructor]",Ql=typeof ArrayBuffer=="function",Jl=s=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(s):s&&s.buffer instanceof ArrayBuffer,cr=({type:s,data:e},t,n)=>Kl&&e instanceof Blob?t?n(e):Pr(e,n):Ql&&(e instanceof ArrayBuffer||Jl(e))?t?n(e):Pr(new Blob([e]),n):n(ss[s]+(e||"")),Pr=(s,e)=>{const t=new FileReader;return t.onload=function(){const n=t.result.split(",")[1];e("b"+(n||""))},t.readAsDataURL(s)};function Fr(s){return s instanceof Uint8Array?s:s instanceof ArrayBuffer?new Uint8Array(s):new Uint8Array(s.buffer,s.byteOffset,s.byteLength)}let Mn;function Za(s,e){if(Kl&&s.data instanceof Blob)return s.data.arrayBuffer().then(Fr).then(e);if(Ql&&(s.data instanceof ArrayBuffer||Jl(s.data)))return e(Fr(s.data));cr(s,!1,t=>{Mn||(Mn=new TextEncoder),e(Mn.encode(t))})}const Lr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Qs=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(let s=0;s<Lr.length;s++)Qs[Lr.charCodeAt(s)]=s;const Ka=s=>{let e=s.length*.75,t=s.length,n,r=0,i,a,l,o;s[s.length-1]==="="&&(e--,s[s.length-2]==="="&&e--);const u=new ArrayBuffer(e),f=new Uint8Array(u);for(n=0;n<t;n+=4)i=Qs[s.charCodeAt(n)],a=Qs[s.charCodeAt(n+1)],l=Qs[s.charCodeAt(n+2)],o=Qs[s.charCodeAt(n+3)],f[r++]=i<<2|a>>4,f[r++]=(a&15)<<4|l>>2,f[r++]=(l&3)<<6|o&63;return u},Qa=typeof ArrayBuffer=="function",ur=(s,e)=>{if(typeof s!="string")return{type:"message",data:$l(s,e)};const t=s.charAt(0);return t==="b"?{type:"message",data:Ja(s.substring(1),e)}:vn[t]?s.length>1?{type:vn[t],data:s.substring(1)}:{type:vn[t]}:Kn},Ja=(s,e)=>{if(Qa){const t=Ka(s);return $l(t,e)}else return{base64:!0,data:s}},$l=(s,e)=>{switch(e){case"blob":return s instanceof Blob?s:new Blob([s]);case"arraybuffer":default:return s instanceof ArrayBuffer?s:s.buffer}},ea="",$a=(s,e)=>{const t=s.length,n=new Array(t);let r=0;s.forEach((i,a)=>{cr(i,!1,l=>{n[a]=l,++r===t&&e(n.join(ea))})})},eo=(s,e)=>{const t=s.split(ea),n=[];for(let r=0;r<t.length;r++){const i=ur(t[r],e);if(n.push(i),i.type==="error")break}return n};function to(){return new TransformStream({transform(s,e){Za(s,t=>{const n=t.length;let r;if(n<126)r=new Uint8Array(1),new DataView(r.buffer).setUint8(0,n);else if(n<65536){r=new Uint8Array(3);const i=new DataView(r.buffer);i.setUint8(0,126),i.setUint16(1,n)}else{r=new Uint8Array(9);const i=new DataView(r.buffer);i.setUint8(0,127),i.setBigUint64(1,BigInt(n))}s.data&&typeof s.data!="string"&&(r[0]|=128),e.enqueue(r),e.enqueue(t)})}})}let xn;function on(s){return s.reduce((e,t)=>e+t.length,0)}function cn(s,e){if(s[0].length===e)return s.shift();const t=new Uint8Array(e);let n=0;for(let r=0;r<e;r++)t[r]=s[0][n++],n===s[0].length&&(s.shift(),n=0);return s.length&&n<s[0].length&&(s[0]=s[0].slice(n)),t}function so(s,e){xn||(xn=new TextDecoder);const t=[];let n=0,r=-1,i=!1;return new TransformStream({transform(a,l){for(t.push(a);;){if(n===0){if(on(t)<1)break;const o=cn(t,1);i=(o[0]&128)===128,r=o[0]&127,r<126?n=3:r===126?n=1:n=2}else if(n===1){if(on(t)<2)break;const o=cn(t,2);r=new DataView(o.buffer,o.byteOffset,o.length).getUint16(0),n=3}else if(n===2){if(on(t)<8)break;const o=cn(t,8),u=new DataView(o.buffer,o.byteOffset,o.length),f=u.getUint32(0);if(f>Math.pow(2,21)-1){l.enqueue(Kn);break}r=f*Math.pow(2,32)+u.getUint32(4),n=3}else{if(on(t)<r)break;const o=cn(t,r);l.enqueue(ur(i?o:xn.decode(o),e)),n=0}if(r===0||r>s){l.enqueue(Kn);break}}}})}const ta=4;function at(s){if(s)return no(s)}function no(s){for(var e in at.prototype)s[e]=at.prototype[e];return s}at.prototype.on=at.prototype.addEventListener=function(s,e){return this._callbacks=this._callbacks||{},(this._callbacks["$"+s]=this._callbacks["$"+s]||[]).push(e),this};at.prototype.once=function(s,e){function t(){this.off(s,t),e.apply(this,arguments)}return t.fn=e,this.on(s,t),this};at.prototype.off=at.prototype.removeListener=at.prototype.removeAllListeners=at.prototype.removeEventListener=function(s,e){if(this._callbacks=this._callbacks||{},arguments.length==0)return this._callbacks={},this;var t=this._callbacks["$"+s];if(!t)return this;if(arguments.length==1)return delete this._callbacks["$"+s],this;for(var n,r=0;r<t.length;r++)if(n=t[r],n===e||n.fn===e){t.splice(r,1);break}return t.length===0&&delete this._callbacks["$"+s],this};at.prototype.emit=function(s){this._callbacks=this._callbacks||{};for(var e=new Array(arguments.length-1),t=this._callbacks["$"+s],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(t){t=t.slice(0);for(var n=0,r=t.length;n<r;++n)t[n].apply(this,e)}return this};at.prototype.emitReserved=at.prototype.emit;at.prototype.listeners=function(s){return this._callbacks=this._callbacks||{},this._callbacks["$"+s]||[]};at.prototype.hasListeners=function(s){return!!this.listeners(s).length};const On=typeof Promise=="function"&&typeof Promise.resolve=="function"?e=>Promise.resolve().then(e):(e,t)=>t(e,0),zt=typeof self<"u"?self:typeof window<"u"?window:Function("return this")(),ro="arraybuffer";function sa(s,...e){return e.reduce((t,n)=>(s.hasOwnProperty(n)&&(t[n]=s[n]),t),{})}const io=zt.setTimeout,lo=zt.clearTimeout;function Nn(s,e){e.useNativeTimers?(s.setTimeoutFn=io.bind(zt),s.clearTimeoutFn=lo.bind(zt)):(s.setTimeoutFn=zt.setTimeout.bind(zt),s.clearTimeoutFn=zt.clearTimeout.bind(zt))}const ao=1.33;function oo(s){return typeof s=="string"?co(s):Math.ceil((s.byteLength||s.size)*ao)}function co(s){let e=0,t=0;for(let n=0,r=s.length;n<r;n++)e=s.charCodeAt(n),e<128?t+=1:e<2048?t+=2:e<55296||e>=57344?t+=3:(n++,t+=4);return t}function na(){return Date.now().toString(36).substring(3)+Math.random().toString(36).substring(2,5)}function uo(s){let e="";for(let t in s)s.hasOwnProperty(t)&&(e.length&&(e+="&"),e+=encodeURIComponent(t)+"="+encodeURIComponent(s[t]));return e}function fo(s){let e={},t=s.split("&");for(let n=0,r=t.length;n<r;n++){let i=t[n].split("=");e[decodeURIComponent(i[0])]=decodeURIComponent(i[1])}return e}class ho extends Error{constructor(e,t,n){super(e),this.description=t,this.context=n,this.type="TransportError"}}class fr extends at{constructor(e){super(),this.writable=!1,Nn(this,e),this.opts=e,this.query=e.query,this.socket=e.socket,this.supportsBinary=!e.forceBase64}onError(e,t,n){return super.emitReserved("error",new ho(e,t,n)),this}open(){return this.readyState="opening",this.doOpen(),this}close(){return(this.readyState==="opening"||this.readyState==="open")&&(this.doClose(),this.onClose()),this}send(e){this.readyState==="open"&&this.write(e)}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(e){const t=ur(e,this.socket.binaryType);this.onPacket(t)}onPacket(e){super.emitReserved("packet",e)}onClose(e){this.readyState="closed",super.emitReserved("close",e)}pause(e){}createUri(e,t={}){return e+"://"+this._hostname()+this._port()+this.opts.path+this._query(t)}_hostname(){const e=this.opts.hostname;return e.indexOf(":")===-1?e:"["+e+"]"}_port(){return this.opts.port&&(this.opts.secure&&+(this.opts.port!==443)||!this.opts.secure&&Number(this.opts.port)!==80)?":"+this.opts.port:""}_query(e){const t=uo(e);return t.length?"?"+t:""}}class po extends fr{constructor(){super(...arguments),this._polling=!1}get name(){return"polling"}doOpen(){this._poll()}pause(e){this.readyState="pausing";const t=()=>{this.readyState="paused",e()};if(this._polling||!this.writable){let n=0;this._polling&&(n++,this.once("pollComplete",function(){--n||t()})),this.writable||(n++,this.once("drain",function(){--n||t()}))}else t()}_poll(){this._polling=!0,this.doPoll(),this.emitReserved("poll")}onData(e){const t=n=>{if(this.readyState==="opening"&&n.type==="open"&&this.onOpen(),n.type==="close")return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(n)};eo(e,this.socket.binaryType).forEach(t),this.readyState!=="closed"&&(this._polling=!1,this.emitReserved("pollComplete"),this.readyState==="open"&&this._poll())}doClose(){const e=()=>{this.write([{type:"close"}])};this.readyState==="open"?e():this.once("open",e)}write(e){this.writable=!1,$a(e,t=>{this.doWrite(t,()=>{this.writable=!0,this.emitReserved("drain")})})}uri(){const e=this.opts.secure?"https":"http",t=this.query||{};return this.opts.timestampRequests!==!1&&(t[this.opts.timestampParam]=na()),!this.supportsBinary&&!t.sid&&(t.b64=1),this.createUri(e,t)}}let ra=!1;try{ra=typeof XMLHttpRequest<"u"&&"withCredentials"in new XMLHttpRequest}catch{}const go=ra;function mo(){}class vo extends po{constructor(e){if(super(e),typeof location<"u"){const t=location.protocol==="https:";let n=location.port;n||(n=t?"443":"80"),this.xd=typeof location<"u"&&e.hostname!==location.hostname||n!==e.port}}doWrite(e,t){const n=this.request({method:"POST",data:e});n.on("success",t),n.on("error",(r,i)=>{this.onError("xhr post error",r,i)})}doPoll(){const e=this.request();e.on("data",this.onData.bind(this)),e.on("error",(t,n)=>{this.onError("xhr poll error",t,n)}),this.pollXhr=e}}class ts extends at{constructor(e,t,n){super(),this.createRequest=e,Nn(this,n),this._opts=n,this._method=n.method||"GET",this._uri=t,this._data=n.data!==void 0?n.data:null,this._create()}_create(){var e;const t=sa(this._opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");t.xdomain=!!this._opts.xd;const n=this._xhr=this.createRequest(t);try{n.open(this._method,this._uri,!0);try{if(this._opts.extraHeaders){n.setDisableHeaderCheck&&n.setDisableHeaderCheck(!0);for(let r in this._opts.extraHeaders)this._opts.extraHeaders.hasOwnProperty(r)&&n.setRequestHeader(r,this._opts.extraHeaders[r])}}catch{}if(this._method==="POST")try{n.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch{}try{n.setRequestHeader("Accept","*/*")}catch{}(e=this._opts.cookieJar)===null||e===void 0||e.addCookies(n),"withCredentials"in n&&(n.withCredentials=this._opts.withCredentials),this._opts.requestTimeout&&(n.timeout=this._opts.requestTimeout),n.onreadystatechange=()=>{var r;n.readyState===3&&((r=this._opts.cookieJar)===null||r===void 0||r.parseCookies(n.getResponseHeader("set-cookie"))),n.readyState===4&&(n.status===200||n.status===1223?this._onLoad():this.setTimeoutFn(()=>{this._onError(typeof n.status=="number"?n.status:0)},0))},n.send(this._data)}catch(r){this.setTimeoutFn(()=>{this._onError(r)},0);return}typeof document<"u"&&(this._index=ts.requestsCount++,ts.requests[this._index]=this)}_onError(e){this.emitReserved("error",e,this._xhr),this._cleanup(!0)}_cleanup(e){if(!(typeof this._xhr>"u"||this._xhr===null)){if(this._xhr.onreadystatechange=mo,e)try{this._xhr.abort()}catch{}typeof document<"u"&&delete ts.requests[this._index],this._xhr=null}}_onLoad(){const e=this._xhr.responseText;e!==null&&(this.emitReserved("data",e),this.emitReserved("success"),this._cleanup())}abort(){this._cleanup()}}ts.requestsCount=0;ts.requests={};if(typeof document<"u"){if(typeof attachEvent=="function")attachEvent("onunload",Mr);else if(typeof addEventListener=="function"){const s="onpagehide"in zt?"pagehide":"unload";addEventListener(s,Mr,!1)}}function Mr(){for(let s in ts.requests)ts.requests.hasOwnProperty(s)&&ts.requests[s].abort()}const _o=function(){const s=ia({xdomain:!1});return s&&s.responseType!==null}();class bo extends vo{constructor(e){super(e);const t=e&&e.forceBase64;this.supportsBinary=_o&&!t}request(e={}){return Object.assign(e,{xd:this.xd},this.opts),new ts(ia,this.uri(),e)}}function ia(s){const e=s.xdomain;try{if(typeof XMLHttpRequest<"u"&&(!e||go))return new XMLHttpRequest}catch{}if(!e)try{return new zt[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP")}catch{}}const la=typeof navigator<"u"&&typeof navigator.product=="string"&&navigator.product.toLowerCase()==="reactnative";class ko extends fr{get name(){return"websocket"}doOpen(){const e=this.uri(),t=this.opts.protocols,n=la?{}:sa(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(n.headers=this.opts.extraHeaders);try{this.ws=this.createSocket(e,t,n)}catch(r){return this.emitReserved("error",r)}this.ws.binaryType=this.socket.binaryType,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=e=>this.onClose({description:"websocket connection closed",context:e}),this.ws.onmessage=e=>this.onData(e.data),this.ws.onerror=e=>this.onError("websocket error",e)}write(e){this.writable=!1;for(let t=0;t<e.length;t++){const n=e[t],r=t===e.length-1;cr(n,this.supportsBinary,i=>{try{this.doWrite(n,i)}catch{}r&&On(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){typeof this.ws<"u"&&(this.ws.onerror=()=>{},this.ws.close(),this.ws=null)}uri(){const e=this.opts.secure?"wss":"ws",t=this.query||{};return this.opts.timestampRequests&&(t[this.opts.timestampParam]=na()),this.supportsBinary||(t.b64=1),this.createUri(e,t)}}const Un=zt.WebSocket||zt.MozWebSocket;class yo extends ko{createSocket(e,t,n){return la?new Un(e,t,n):t?new Un(e,t):new Un(e)}doWrite(e,t){this.ws.send(t)}}class wo extends fr{get name(){return"webtransport"}doOpen(){try{this._transport=new WebTransport(this.createUri("https"),this.opts.transportOptions[this.name])}catch(e){return this.emitReserved("error",e)}this._transport.closed.then(()=>{this.onClose()}).catch(e=>{this.onError("webtransport error",e)}),this._transport.ready.then(()=>{this._transport.createBidirectionalStream().then(e=>{const t=so(Number.MAX_SAFE_INTEGER,this.socket.binaryType),n=e.readable.pipeThrough(t).getReader(),r=to();r.readable.pipeTo(e.writable),this._writer=r.writable.getWriter();const i=()=>{n.read().then(({done:l,value:o})=>{l||(this.onPacket(o),i())}).catch(l=>{})};i();const a={type:"open"};this.query.sid&&(a.data=`{"sid":"${this.query.sid}"}`),this._writer.write(a).then(()=>this.onOpen())})})}write(e){this.writable=!1;for(let t=0;t<e.length;t++){const n=e[t],r=t===e.length-1;this._writer.write(n).then(()=>{r&&On(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){var e;(e=this._transport)===null||e===void 0||e.close()}}const Eo={websocket:yo,webtransport:wo,polling:bo},To=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,So=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function Qn(s){if(s.length>8e3)throw"URI too long";const e=s,t=s.indexOf("["),n=s.indexOf("]");t!=-1&&n!=-1&&(s=s.substring(0,t)+s.substring(t,n).replace(/:/g,";")+s.substring(n,s.length));let r=To.exec(s||""),i={},a=14;for(;a--;)i[So[a]]=r[a]||"";return t!=-1&&n!=-1&&(i.source=e,i.host=i.host.substring(1,i.host.length-1).replace(/;/g,":"),i.authority=i.authority.replace("[","").replace("]","").replace(/;/g,":"),i.ipv6uri=!0),i.pathNames=Ao(i,i.path),i.queryKey=Co(i,i.query),i}function Ao(s,e){const t=/\/{2,9}/g,n=e.replace(t,"/").split("/");return(e.slice(0,1)=="/"||e.length===0)&&n.splice(0,1),e.slice(-1)=="/"&&n.splice(n.length-1,1),n}function Co(s,e){const t={};return e.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(n,r,i){r&&(t[r]=i)}),t}const Jn=typeof addEventListener=="function"&&typeof removeEventListener=="function",_n=[];Jn&&addEventListener("offline",()=>{_n.forEach(s=>s())},!1);class ps extends at{constructor(e,t){if(super(),this.binaryType=ro,this.writeBuffer=[],this._prevBufferLen=0,this._pingInterval=-1,this._pingTimeout=-1,this._maxPayload=-1,this._pingTimeoutTime=1/0,e&&typeof e=="object"&&(t=e,e=null),e){const n=Qn(e);t.hostname=n.host,t.secure=n.protocol==="https"||n.protocol==="wss",t.port=n.port,n.query&&(t.query=n.query)}else t.host&&(t.hostname=Qn(t.host).host);Nn(this,t),this.secure=t.secure!=null?t.secure:typeof location<"u"&&location.protocol==="https:",t.hostname&&!t.port&&(t.port=this.secure?"443":"80"),this.hostname=t.hostname||(typeof location<"u"?location.hostname:"localhost"),this.port=t.port||(typeof location<"u"&&location.port?location.port:this.secure?"443":"80"),this.transports=[],this._transportsByName={},t.transports.forEach(n=>{const r=n.prototype.name;this.transports.push(r),this._transportsByName[r]=n}),this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,addTrailingSlash:!0,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!1},t),this.opts.path=this.opts.path.replace(/\/$/,"")+(this.opts.addTrailingSlash?"/":""),typeof this.opts.query=="string"&&(this.opts.query=fo(this.opts.query)),Jn&&(this.opts.closeOnBeforeunload&&(this._beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this._beforeunloadEventListener,!1)),this.hostname!=="localhost"&&(this._offlineEventListener=()=>{this._onClose("transport close",{description:"network connection lost"})},_n.push(this._offlineEventListener))),this.opts.withCredentials&&(this._cookieJar=void 0),this._open()}createTransport(e){const t=Object.assign({},this.opts.query);t.EIO=ta,t.transport=e,this.id&&(t.sid=this.id);const n=Object.assign({},this.opts,{query:t,socket:this,hostname:this.hostname,secure:this.secure,port:this.port},this.opts.transportOptions[e]);return new this._transportsByName[e](n)}_open(){if(this.transports.length===0){this.setTimeoutFn(()=>{this.emitReserved("error","No transports available")},0);return}const e=this.opts.rememberUpgrade&&ps.priorWebsocketSuccess&&this.transports.indexOf("websocket")!==-1?"websocket":this.transports[0];this.readyState="opening";const t=this.createTransport(e);t.open(),this.setTransport(t)}setTransport(e){this.transport&&this.transport.removeAllListeners(),this.transport=e,e.on("drain",this._onDrain.bind(this)).on("packet",this._onPacket.bind(this)).on("error",this._onError.bind(this)).on("close",t=>this._onClose("transport close",t))}onOpen(){this.readyState="open",ps.priorWebsocketSuccess=this.transport.name==="websocket",this.emitReserved("open"),this.flush()}_onPacket(e){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")switch(this.emitReserved("packet",e),this.emitReserved("heartbeat"),e.type){case"open":this.onHandshake(JSON.parse(e.data));break;case"ping":this._sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong"),this._resetPingTimeout();break;case"error":const t=new Error("server error");t.code=e.data,this._onError(t);break;case"message":this.emitReserved("data",e.data),this.emitReserved("message",e.data);break}}onHandshake(e){this.emitReserved("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this._pingInterval=e.pingInterval,this._pingTimeout=e.pingTimeout,this._maxPayload=e.maxPayload,this.onOpen(),this.readyState!=="closed"&&this._resetPingTimeout()}_resetPingTimeout(){this.clearTimeoutFn(this._pingTimeoutTimer);const e=this._pingInterval+this._pingTimeout;this._pingTimeoutTime=Date.now()+e,this._pingTimeoutTimer=this.setTimeoutFn(()=>{this._onClose("ping timeout")},e),this.opts.autoUnref&&this._pingTimeoutTimer.unref()}_onDrain(){this.writeBuffer.splice(0,this._prevBufferLen),this._prevBufferLen=0,this.writeBuffer.length===0?this.emitReserved("drain"):this.flush()}flush(){if(this.readyState!=="closed"&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){const e=this._getWritablePackets();this.transport.send(e),this._prevBufferLen=e.length,this.emitReserved("flush")}}_getWritablePackets(){if(!(this._maxPayload&&this.transport.name==="polling"&&this.writeBuffer.length>1))return this.writeBuffer;let t=1;for(let n=0;n<this.writeBuffer.length;n++){const r=this.writeBuffer[n].data;if(r&&(t+=oo(r)),n>0&&t>this._maxPayload)return this.writeBuffer.slice(0,n);t+=2}return this.writeBuffer}_hasPingExpired(){if(!this._pingTimeoutTime)return!0;const e=Date.now()>this._pingTimeoutTime;return e&&(this._pingTimeoutTime=0,On(()=>{this._onClose("ping timeout")},this.setTimeoutFn)),e}write(e,t,n){return this._sendPacket("message",e,t,n),this}send(e,t,n){return this._sendPacket("message",e,t,n),this}_sendPacket(e,t,n,r){if(typeof t=="function"&&(r=t,t=void 0),typeof n=="function"&&(r=n,n=null),this.readyState==="closing"||this.readyState==="closed")return;n=n||{},n.compress=n.compress!==!1;const i={type:e,data:t,options:n};this.emitReserved("packetCreate",i),this.writeBuffer.push(i),r&&this.once("flush",r),this.flush()}close(){const e=()=>{this._onClose("forced close"),this.transport.close()},t=()=>{this.off("upgrade",t),this.off("upgradeError",t),e()},n=()=>{this.once("upgrade",t),this.once("upgradeError",t)};return(this.readyState==="opening"||this.readyState==="open")&&(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?n():e()}):this.upgrading?n():e()),this}_onError(e){if(ps.priorWebsocketSuccess=!1,this.opts.tryAllTransports&&this.transports.length>1&&this.readyState==="opening")return this.transports.shift(),this._open();this.emitReserved("error",e),this._onClose("transport error",e)}_onClose(e,t){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing"){if(this.clearTimeoutFn(this._pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),Jn&&(this._beforeunloadEventListener&&removeEventListener("beforeunload",this._beforeunloadEventListener,!1),this._offlineEventListener)){const n=_n.indexOf(this._offlineEventListener);n!==-1&&_n.splice(n,1)}this.readyState="closed",this.id=null,this.emitReserved("close",e,t),this.writeBuffer=[],this._prevBufferLen=0}}}ps.protocol=ta;class Io extends ps{constructor(){super(...arguments),this._upgrades=[]}onOpen(){if(super.onOpen(),this.readyState==="open"&&this.opts.upgrade)for(let e=0;e<this._upgrades.length;e++)this._probe(this._upgrades[e])}_probe(e){let t=this.createTransport(e),n=!1;ps.priorWebsocketSuccess=!1;const r=()=>{n||(t.send([{type:"ping",data:"probe"}]),t.once("packet",p=>{if(!n)if(p.type==="pong"&&p.data==="probe"){if(this.upgrading=!0,this.emitReserved("upgrading",t),!t)return;ps.priorWebsocketSuccess=t.name==="websocket",this.transport.pause(()=>{n||this.readyState!=="closed"&&(f(),this.setTransport(t),t.send([{type:"upgrade"}]),this.emitReserved("upgrade",t),t=null,this.upgrading=!1,this.flush())})}else{const h=new Error("probe error");h.transport=t.name,this.emitReserved("upgradeError",h)}}))};function i(){n||(n=!0,f(),t.close(),t=null)}const a=p=>{const h=new Error("probe error: "+p);h.transport=t.name,i(),this.emitReserved("upgradeError",h)};function l(){a("transport closed")}function o(){a("socket closed")}function u(p){t&&p.name!==t.name&&i()}const f=()=>{t.removeListener("open",r),t.removeListener("error",a),t.removeListener("close",l),this.off("close",o),this.off("upgrading",u)};t.once("open",r),t.once("error",a),t.once("close",l),this.once("close",o),this.once("upgrading",u),this._upgrades.indexOf("webtransport")!==-1&&e!=="webtransport"?this.setTimeoutFn(()=>{n||t.open()},200):t.open()}onHandshake(e){this._upgrades=this._filterUpgrades(e.upgrades),super.onHandshake(e)}_filterUpgrades(e){const t=[];for(let n=0;n<e.length;n++)~this.transports.indexOf(e[n])&&t.push(e[n]);return t}}let Do=class extends Io{constructor(e,t={}){const n=typeof e=="object"?e:t;(!n.transports||n.transports&&typeof n.transports[0]=="string")&&(n.transports=(n.transports||["polling","websocket","webtransport"]).map(r=>Eo[r]).filter(r=>!!r)),super(e,n)}};function Oo(s,e="",t){let n=s;t=t||typeof location<"u"&&location,s==null&&(s=t.protocol+"//"+t.host),typeof s=="string"&&(s.charAt(0)==="/"&&(s.charAt(1)==="/"?s=t.protocol+s:s=t.host+s),/^(https?|wss?):\/\//.test(s)||(typeof t<"u"?s=t.protocol+"//"+s:s="https://"+s),n=Qn(s)),n.port||(/^(http|ws)$/.test(n.protocol)?n.port="80":/^(http|ws)s$/.test(n.protocol)&&(n.port="443")),n.path=n.path||"/";const i=n.host.indexOf(":")!==-1?"["+n.host+"]":n.host;return n.id=n.protocol+"://"+i+":"+n.port+e,n.href=n.protocol+"://"+i+(t&&t.port===n.port?"":":"+n.port),n}const No=typeof ArrayBuffer=="function",Ro=s=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(s):s.buffer instanceof ArrayBuffer,aa=Object.prototype.toString,Po=typeof Blob=="function"||typeof Blob<"u"&&aa.call(Blob)==="[object BlobConstructor]",Fo=typeof File=="function"||typeof File<"u"&&aa.call(File)==="[object FileConstructor]";function dr(s){return No&&(s instanceof ArrayBuffer||Ro(s))||Po&&s instanceof Blob||Fo&&s instanceof File}function bn(s,e){if(!s||typeof s!="object")return!1;if(Array.isArray(s)){for(let t=0,n=s.length;t<n;t++)if(bn(s[t]))return!0;return!1}if(dr(s))return!0;if(s.toJSON&&typeof s.toJSON=="function"&&arguments.length===1)return bn(s.toJSON(),!0);for(const t in s)if(Object.prototype.hasOwnProperty.call(s,t)&&bn(s[t]))return!0;return!1}function Lo(s){const e=[],t=s.data,n=s;return n.data=$n(t,e),n.attachments=e.length,{packet:n,buffers:e}}function $n(s,e){if(!s)return s;if(dr(s)){const t={_placeholder:!0,num:e.length};return e.push(s),t}else if(Array.isArray(s)){const t=new Array(s.length);for(let n=0;n<s.length;n++)t[n]=$n(s[n],e);return t}else if(typeof s=="object"&&!(s instanceof Date)){const t={};for(const n in s)Object.prototype.hasOwnProperty.call(s,n)&&(t[n]=$n(s[n],e));return t}return s}function Mo(s,e){return s.data=er(s.data,e),delete s.attachments,s}function er(s,e){if(!s)return s;if(s&&s._placeholder===!0){if(typeof s.num=="number"&&s.num>=0&&s.num<e.length)return e[s.num];throw new Error("illegal attachments")}else if(Array.isArray(s))for(let t=0;t<s.length;t++)s[t]=er(s[t],e);else if(typeof s=="object")for(const t in s)Object.prototype.hasOwnProperty.call(s,t)&&(s[t]=er(s[t],e));return s}const xo=["connect","connect_error","disconnect","disconnecting","newListener","removeListener"],Uo=5;var Fe;(function(s){s[s.CONNECT=0]="CONNECT",s[s.DISCONNECT=1]="DISCONNECT",s[s.EVENT=2]="EVENT",s[s.ACK=3]="ACK",s[s.CONNECT_ERROR=4]="CONNECT_ERROR",s[s.BINARY_EVENT=5]="BINARY_EVENT",s[s.BINARY_ACK=6]="BINARY_ACK"})(Fe||(Fe={}));class Bo{constructor(e){this.replacer=e}encode(e){return(e.type===Fe.EVENT||e.type===Fe.ACK)&&bn(e)?this.encodeAsBinary({type:e.type===Fe.EVENT?Fe.BINARY_EVENT:Fe.BINARY_ACK,nsp:e.nsp,data:e.data,id:e.id}):[this.encodeAsString(e)]}encodeAsString(e){let t=""+e.type;return(e.type===Fe.BINARY_EVENT||e.type===Fe.BINARY_ACK)&&(t+=e.attachments+"-"),e.nsp&&e.nsp!=="/"&&(t+=e.nsp+","),e.id!=null&&(t+=e.id),e.data!=null&&(t+=JSON.stringify(e.data,this.replacer)),t}encodeAsBinary(e){const t=Lo(e),n=this.encodeAsString(t.packet),r=t.buffers;return r.unshift(n),r}}function xr(s){return Object.prototype.toString.call(s)==="[object Object]"}class hr extends at{constructor(e){super(),this.reviver=e}add(e){let t;if(typeof e=="string"){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");t=this.decodeString(e);const n=t.type===Fe.BINARY_EVENT;n||t.type===Fe.BINARY_ACK?(t.type=n?Fe.EVENT:Fe.ACK,this.reconstructor=new Vo(t),t.attachments===0&&super.emitReserved("decoded",t)):super.emitReserved("decoded",t)}else if(dr(e)||e.base64)if(this.reconstructor)t=this.reconstructor.takeBinaryData(e),t&&(this.reconstructor=null,super.emitReserved("decoded",t));else throw new Error("got binary data when not reconstructing a packet");else throw new Error("Unknown type: "+e)}decodeString(e){let t=0;const n={type:Number(e.charAt(0))};if(Fe[n.type]===void 0)throw new Error("unknown packet type "+n.type);if(n.type===Fe.BINARY_EVENT||n.type===Fe.BINARY_ACK){const i=t+1;for(;e.charAt(++t)!=="-"&&t!=e.length;);const a=e.substring(i,t);if(a!=Number(a)||e.charAt(t)!=="-")throw new Error("Illegal attachments");n.attachments=Number(a)}if(e.charAt(t+1)==="/"){const i=t+1;for(;++t&&!(e.charAt(t)===","||t===e.length););n.nsp=e.substring(i,t)}else n.nsp="/";const r=e.charAt(t+1);if(r!==""&&Number(r)==r){const i=t+1;for(;++t;){const a=e.charAt(t);if(a==null||Number(a)!=a){--t;break}if(t===e.length)break}n.id=Number(e.substring(i,t+1))}if(e.charAt(++t)){const i=this.tryParse(e.substr(t));if(hr.isPayloadValid(n.type,i))n.data=i;else throw new Error("invalid payload")}return n}tryParse(e){try{return JSON.parse(e,this.reviver)}catch{return!1}}static isPayloadValid(e,t){switch(e){case Fe.CONNECT:return xr(t);case Fe.DISCONNECT:return t===void 0;case Fe.CONNECT_ERROR:return typeof t=="string"||xr(t);case Fe.EVENT:case Fe.BINARY_EVENT:return Array.isArray(t)&&(typeof t[0]=="number"||typeof t[0]=="string"&&xo.indexOf(t[0])===-1);case Fe.ACK:case Fe.BINARY_ACK:return Array.isArray(t)}}destroy(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)}}class Vo{constructor(e){this.packet=e,this.buffers=[],this.reconPack=e}takeBinaryData(e){if(this.buffers.push(e),this.buffers.length===this.reconPack.attachments){const t=Mo(this.reconPack,this.buffers);return this.finishedReconstruction(),t}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}const zo=Object.freeze(Object.defineProperty({__proto__:null,Decoder:hr,Encoder:Bo,get PacketType(){return Fe},protocol:Uo},Symbol.toStringTag,{value:"Module"}));function Gt(s,e,t){return s.on(e,t),function(){s.off(e,t)}}const qo=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class oa extends at{constructor(e,t,n){super(),this.connected=!1,this.recovered=!1,this.receiveBuffer=[],this.sendBuffer=[],this._queue=[],this._queueSeq=0,this.ids=0,this.acks={},this.flags={},this.io=e,this.nsp=t,n&&n.auth&&(this.auth=n.auth),this._opts=Object.assign({},n),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;const e=this.io;this.subs=[Gt(e,"open",this.onopen.bind(this)),Gt(e,"packet",this.onpacket.bind(this)),Gt(e,"error",this.onerror.bind(this)),Gt(e,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected?this:(this.subEvents(),this.io._reconnecting||this.io.open(),this.io._readyState==="open"&&this.onopen(),this)}open(){return this.connect()}send(...e){return e.unshift("message"),this.emit.apply(this,e),this}emit(e,...t){var n,r,i;if(qo.hasOwnProperty(e))throw new Error('"'+e.toString()+'" is a reserved event name');if(t.unshift(e),this._opts.retries&&!this.flags.fromQueue&&!this.flags.volatile)return this._addToQueue(t),this;const a={type:Fe.EVENT,data:t};if(a.options={},a.options.compress=this.flags.compress!==!1,typeof t[t.length-1]=="function"){const f=this.ids++,p=t.pop();this._registerAckCallback(f,p),a.id=f}const l=(r=(n=this.io.engine)===null||n===void 0?void 0:n.transport)===null||r===void 0?void 0:r.writable,o=this.connected&&!(!((i=this.io.engine)===null||i===void 0)&&i._hasPingExpired());return this.flags.volatile&&!l||(o?(this.notifyOutgoingListeners(a),this.packet(a)):this.sendBuffer.push(a)),this.flags={},this}_registerAckCallback(e,t){var n;const r=(n=this.flags.timeout)!==null&&n!==void 0?n:this._opts.ackTimeout;if(r===void 0){this.acks[e]=t;return}const i=this.io.setTimeoutFn(()=>{delete this.acks[e];for(let l=0;l<this.sendBuffer.length;l++)this.sendBuffer[l].id===e&&this.sendBuffer.splice(l,1);t.call(this,new Error("operation has timed out"))},r),a=(...l)=>{this.io.clearTimeoutFn(i),t.apply(this,l)};a.withError=!0,this.acks[e]=a}emitWithAck(e,...t){return new Promise((n,r)=>{const i=(a,l)=>a?r(a):n(l);i.withError=!0,t.push(i),this.emit(e,...t)})}_addToQueue(e){let t;typeof e[e.length-1]=="function"&&(t=e.pop());const n={id:this._queueSeq++,tryCount:0,pending:!1,args:e,flags:Object.assign({fromQueue:!0},this.flags)};e.push((r,...i)=>n!==this._queue[0]?void 0:(r!==null?n.tryCount>this._opts.retries&&(this._queue.shift(),t&&t(r)):(this._queue.shift(),t&&t(null,...i)),n.pending=!1,this._drainQueue())),this._queue.push(n),this._drainQueue()}_drainQueue(e=!1){if(!this.connected||this._queue.length===0)return;const t=this._queue[0];t.pending&&!e||(t.pending=!0,t.tryCount++,this.flags=t.flags,this.emit.apply(this,t.args))}packet(e){e.nsp=this.nsp,this.io._packet(e)}onopen(){typeof this.auth=="function"?this.auth(e=>{this._sendConnectPacket(e)}):this._sendConnectPacket(this.auth)}_sendConnectPacket(e){this.packet({type:Fe.CONNECT,data:this._pid?Object.assign({pid:this._pid,offset:this._lastOffset},e):e})}onerror(e){this.connected||this.emitReserved("connect_error",e)}onclose(e,t){this.connected=!1,delete this.id,this.emitReserved("disconnect",e,t),this._clearAcks()}_clearAcks(){Object.keys(this.acks).forEach(e=>{if(!this.sendBuffer.some(n=>String(n.id)===e)){const n=this.acks[e];delete this.acks[e],n.withError&&n.call(this,new Error("socket has been disconnected"))}})}onpacket(e){if(e.nsp===this.nsp)switch(e.type){case Fe.CONNECT:e.data&&e.data.sid?this.onconnect(e.data.sid,e.data.pid):this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case Fe.EVENT:case Fe.BINARY_EVENT:this.onevent(e);break;case Fe.ACK:case Fe.BINARY_ACK:this.onack(e);break;case Fe.DISCONNECT:this.ondisconnect();break;case Fe.CONNECT_ERROR:this.destroy();const n=new Error(e.data.message);n.data=e.data.data,this.emitReserved("connect_error",n);break}}onevent(e){const t=e.data||[];e.id!=null&&t.push(this.ack(e.id)),this.connected?this.emitEvent(t):this.receiveBuffer.push(Object.freeze(t))}emitEvent(e){if(this._anyListeners&&this._anyListeners.length){const t=this._anyListeners.slice();for(const n of t)n.apply(this,e)}super.emit.apply(this,e),this._pid&&e.length&&typeof e[e.length-1]=="string"&&(this._lastOffset=e[e.length-1])}ack(e){const t=this;let n=!1;return function(...r){n||(n=!0,t.packet({type:Fe.ACK,id:e,data:r}))}}onack(e){const t=this.acks[e.id];typeof t=="function"&&(delete this.acks[e.id],t.withError&&e.data.unshift(null),t.apply(this,e.data))}onconnect(e,t){this.id=e,this.recovered=t&&this._pid===t,this._pid=t,this.connected=!0,this.emitBuffered(),this.emitReserved("connect"),this._drainQueue(!0)}emitBuffered(){this.receiveBuffer.forEach(e=>this.emitEvent(e)),this.receiveBuffer=[],this.sendBuffer.forEach(e=>{this.notifyOutgoingListeners(e),this.packet(e)}),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(e=>e()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&this.packet({type:Fe.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(e){return this.flags.compress=e,this}get volatile(){return this.flags.volatile=!0,this}timeout(e){return this.flags.timeout=e,this}onAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(e),this}prependAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(e),this}offAny(e){if(!this._anyListeners)return this;if(e){const t=this._anyListeners;for(let n=0;n<t.length;n++)if(e===t[n])return t.splice(n,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(e),this}prependAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(e),this}offAnyOutgoing(e){if(!this._anyOutgoingListeners)return this;if(e){const t=this._anyOutgoingListeners;for(let n=0;n<t.length;n++)if(e===t[n])return t.splice(n,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(e){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){const t=this._anyOutgoingListeners.slice();for(const n of t)n.apply(this,e.data)}}}function Bs(s){s=s||{},this.ms=s.min||100,this.max=s.max||1e4,this.factor=s.factor||2,this.jitter=s.jitter>0&&s.jitter<=1?s.jitter:0,this.attempts=0}Bs.prototype.duration=function(){var s=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var e=Math.random(),t=Math.floor(e*this.jitter*s);s=Math.floor(e*10)&1?s+t:s-t}return Math.min(s,this.max)|0};Bs.prototype.reset=function(){this.attempts=0};Bs.prototype.setMin=function(s){this.ms=s};Bs.prototype.setMax=function(s){this.max=s};Bs.prototype.setJitter=function(s){this.jitter=s};class tr extends at{constructor(e,t){var n;super(),this.nsps={},this.subs=[],e&&typeof e=="object"&&(t=e,e=void 0),t=t||{},t.path=t.path||"/socket.io",this.opts=t,Nn(this,t),this.reconnection(t.reconnection!==!1),this.reconnectionAttempts(t.reconnectionAttempts||1/0),this.reconnectionDelay(t.reconnectionDelay||1e3),this.reconnectionDelayMax(t.reconnectionDelayMax||5e3),this.randomizationFactor((n=t.randomizationFactor)!==null&&n!==void 0?n:.5),this.backoff=new Bs({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(t.timeout==null?2e4:t.timeout),this._readyState="closed",this.uri=e;const r=t.parser||zo;this.encoder=new r.Encoder,this.decoder=new r.Decoder,this._autoConnect=t.autoConnect!==!1,this._autoConnect&&this.open()}reconnection(e){return arguments.length?(this._reconnection=!!e,e||(this.skipReconnect=!0),this):this._reconnection}reconnectionAttempts(e){return e===void 0?this._reconnectionAttempts:(this._reconnectionAttempts=e,this)}reconnectionDelay(e){var t;return e===void 0?this._reconnectionDelay:(this._reconnectionDelay=e,(t=this.backoff)===null||t===void 0||t.setMin(e),this)}randomizationFactor(e){var t;return e===void 0?this._randomizationFactor:(this._randomizationFactor=e,(t=this.backoff)===null||t===void 0||t.setJitter(e),this)}reconnectionDelayMax(e){var t;return e===void 0?this._reconnectionDelayMax:(this._reconnectionDelayMax=e,(t=this.backoff)===null||t===void 0||t.setMax(e),this)}timeout(e){return arguments.length?(this._timeout=e,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&this.backoff.attempts===0&&this.reconnect()}open(e){if(~this._readyState.indexOf("open"))return this;this.engine=new Do(this.uri,this.opts);const t=this.engine,n=this;this._readyState="opening",this.skipReconnect=!1;const r=Gt(t,"open",function(){n.onopen(),e&&e()}),i=l=>{this.cleanup(),this._readyState="closed",this.emitReserved("error",l),e?e(l):this.maybeReconnectOnOpen()},a=Gt(t,"error",i);if(this._timeout!==!1){const l=this._timeout,o=this.setTimeoutFn(()=>{r(),i(new Error("timeout")),t.close()},l);this.opts.autoUnref&&o.unref(),this.subs.push(()=>{this.clearTimeoutFn(o)})}return this.subs.push(r),this.subs.push(a),this}connect(e){return this.open(e)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");const e=this.engine;this.subs.push(Gt(e,"ping",this.onping.bind(this)),Gt(e,"data",this.ondata.bind(this)),Gt(e,"error",this.onerror.bind(this)),Gt(e,"close",this.onclose.bind(this)),Gt(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(e){try{this.decoder.add(e)}catch(t){this.onclose("parse error",t)}}ondecoded(e){On(()=>{this.emitReserved("packet",e)},this.setTimeoutFn)}onerror(e){this.emitReserved("error",e)}socket(e,t){let n=this.nsps[e];return n?this._autoConnect&&!n.active&&n.connect():(n=new oa(this,e,t),this.nsps[e]=n),n}_destroy(e){const t=Object.keys(this.nsps);for(const n of t)if(this.nsps[n].active)return;this._close()}_packet(e){const t=this.encoder.encode(e);for(let n=0;n<t.length;n++)this.engine.write(t[n],e.options)}cleanup(){this.subs.forEach(e=>e()),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close")}disconnect(){return this._close()}onclose(e,t){var n;this.cleanup(),(n=this.engine)===null||n===void 0||n.close(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",e,t),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const e=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{const t=this.backoff.duration();this._reconnecting=!0;const n=this.setTimeoutFn(()=>{e.skipReconnect||(this.emitReserved("reconnect_attempt",e.backoff.attempts),!e.skipReconnect&&e.open(r=>{r?(e._reconnecting=!1,e.reconnect(),this.emitReserved("reconnect_error",r)):e.onreconnect()}))},t);this.opts.autoUnref&&n.unref(),this.subs.push(()=>{this.clearTimeoutFn(n)})}}onreconnect(){const e=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",e)}}const js={};function kn(s,e){typeof s=="object"&&(e=s,s=void 0),e=e||{};const t=Oo(s,e.path||"/socket.io"),n=t.source,r=t.id,i=t.path,a=js[r]&&i in js[r].nsps,l=e.forceNew||e["force new connection"]||e.multiplex===!1||a;let o;return l?o=new tr(n,e):(js[r]||(js[r]=new tr(n,e)),o=js[r]),t.query&&!e.query&&(e.query=t.queryKey),o.socket(t.path,e)}Object.assign(kn,{Manager:tr,Socket:oa,io:kn,connect:kn});let tt=null;function ca(){tt||(tt=new(window.AudioContext||window.webkitAudioContext))}function ua(){if(ca(),!tt)return;const s=tt.createOscillator(),e=tt.createGain();s.connect(e),e.connect(tt.destination),s.frequency.value=800,s.type="sine",e.gain.setValueAtTime(.1,tt.currentTime),e.gain.exponentialRampToValueAtTime(.01,tt.currentTime+.1),s.start(tt.currentTime),s.stop(tt.currentTime+.1)}function fa(){if(ca(),!tt)return;const s=()=>{const e=tt.createOscillator(),t=tt.createOscillator(),n=tt.createGain();e.connect(n),t.connect(n),n.connect(tt.destination),e.frequency.value=480,t.frequency.value=620,e.type="sine",t.type="sine",n.gain.setValueAtTime(.15,tt.currentTime),n.gain.exponentialRampToValueAtTime(.01,tt.currentTime+.8),e.start(tt.currentTime),t.start(tt.currentTime),e.stop(tt.currentTime+.8),t.stop(tt.currentTime+.8)};s(),setTimeout(s,1e3)}function jo(s,e,t){if(e)return;if(!(localStorage.getItem("notificationsEnabled")!=="false")){console.log("Notifications disabled in settings");return}if(Notification.permission!=="granted"){console.log("Notification permission not granted:",Notification.permission);return}if(ua(),!document.hidden){console.log("Page is visible, skipping desktop notification");return}let r="",i="",a="/icon-192.png";const l=t?`${s.user} in #${t}`:s.user;switch(s.type){case"text":r=l,i=s.text;break;case"gif":r=l,i="ðŸŽ¬ Sent a GIF";break;case"file":r=l,i=`ðŸ“Ž Sent a file: ${s.fileName}`;break}const o=new Notification(r,{body:i,icon:a,badge:a,tag:`message-${s.id}`,requireInteraction:!1,silent:!1});o.onclick=()=>{window.focus(),o.close()},setTimeout(()=>{o.close()},5e3)}function Ho(s,e,t,n){if(!(localStorage.getItem("notificationsEnabled")!=="false"))return console.log("Notifications disabled in settings"),null;if(Notification.permission!=="granted")return console.log("Notification permission not granted"),null;fa();const i=`Incoming ${e?"Video":"Voice"} Call`,a=`${s} is calling...`,l="/icon-192.png",o=new Notification(i,{body:a,icon:l,badge:l,tag:`call-${s}`,requireInteraction:!0,silent:!1,actions:[{action:"answer",title:"Answer"},{action:"reject",title:"Decline"}]});return o.onclick=()=>{window.focus(),t&&t(),o.close()},o}function Go(){return"Notification"in window?Notification.permission==="granted"?Promise.resolve("granted"):Notification.requestPermission():Promise.resolve("denied")}function pr(){return{async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null}}var Ns=pr();function da(s){Ns=s}var en={exec:()=>null};function Me(s,e=""){let t=typeof s=="string"?s:s.source,n={replace:(r,i)=>{let a=typeof i=="string"?i:i.source;return a=a.replace(At.caret,"$1"),t=t.replace(r,a),n},getRegex:()=>new RegExp(t,e)};return n}var Wo=(()=>{try{return!!new RegExp("(?<=1)(?<!1)")}catch{return!1}})(),At={codeRemoveIndent:/^(?: {1,4}| {0,3}\t)/gm,outputLinkReplace:/\\([\[\]])/g,indentCodeCompensation:/^(\s+)(?:```)/,beginningSpace:/^\s+/,endingHash:/#$/,startingSpaceChar:/^ /,endingSpaceChar:/ $/,nonSpaceChar:/[^ ]/,newLineCharGlobal:/\n/g,tabCharGlobal:/\t/g,multipleSpaceGlobal:/\s+/g,blankLine:/^[ \t]*$/,doubleBlankLine:/\n[ \t]*\n[ \t]*$/,blockquoteStart:/^ {0,3}>/,blockquoteSetextReplace:/\n {0,3}((?:=+|-+) *)(?=\n|$)/g,blockquoteSetextReplace2:/^ {0,3}>[ \t]?/gm,listReplaceTabs:/^\t+/,listReplaceNesting:/^ {1,4}(?=( {4})*[^ ])/g,listIsTask:/^\[[ xX]\] +\S/,listReplaceTask:/^\[[ xX]\] +/,listTaskCheckbox:/\[[ xX]\]/,anyLine:/\n.*\n/,hrefBrackets:/^<(.*)>$/,tableDelimiter:/[:|]/,tableAlignChars:/^\||\| *$/g,tableRowBlankLine:/\n[ \t]*$/,tableAlignRight:/^ *-+: *$/,tableAlignCenter:/^ *:-+: *$/,tableAlignLeft:/^ *:-+ *$/,startATag:/^<a /i,endATag:/^<\/a>/i,startPreScriptTag:/^<(pre|code|kbd|script)(\s|>)/i,endPreScriptTag:/^<\/(pre|code|kbd|script)(\s|>)/i,startAngleBracket:/^</,endAngleBracket:/>$/,pedanticHrefTitle:/^([^'"]*[^\s])\s+(['"])(.*)\2/,unicodeAlphaNumeric:/[\p{L}\p{N}]/u,escapeTest:/[&<>"']/,escapeReplace:/[&<>"']/g,escapeTestNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,escapeReplaceNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/g,unescapeTest:/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/ig,caret:/(^|[^\[])\^/g,percentDecode:/%25/g,findPipe:/\|/g,splitPipe:/ \|/,slashPipe:/\\\|/g,carriageReturn:/\r\n|\r/g,spaceLine:/^ +$/gm,notSpaceStart:/^\S*/,endingNewline:/\n$/,listItemRegex:s=>new RegExp(`^( {0,3}${s})((?:[	 ][^\\n]*)?(?:\\n|$))`),nextBulletRegex:s=>new RegExp(`^ {0,${Math.min(3,s-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ 	][^\\n]*)?(?:\\n|$))`),hrRegex:s=>new RegExp(`^ {0,${Math.min(3,s-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),fencesBeginRegex:s=>new RegExp(`^ {0,${Math.min(3,s-1)}}(?:\`\`\`|~~~)`),headingBeginRegex:s=>new RegExp(`^ {0,${Math.min(3,s-1)}}#`),htmlBeginRegex:s=>new RegExp(`^ {0,${Math.min(3,s-1)}}<(?:[a-z].*>|!--)`,"i")},Yo=/^(?:[ \t]*(?:\n|$))+/,Xo=/^((?: {4}| {0,3}\t)[^\n]+(?:\n(?:[ \t]*(?:\n|$))*)?)+/,Zo=/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,nn=/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,Ko=/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,gr=/(?:[*+-]|\d{1,9}[.)])/,ha=/^(?!bull |blockCode|fences|blockquote|heading|html|table)((?:.|\n(?!\s*?\n|bull |blockCode|fences|blockquote|heading|html|table))+?)\n {0,3}(=+|-+) *(?:\n+|$)/,pa=Me(ha).replace(/bull/g,gr).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/\|table/g,"").getRegex(),Qo=Me(ha).replace(/bull/g,gr).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/table/g,/ {0,3}\|?(?:[:\- ]*\|)+[\:\- ]*\n/).getRegex(),mr=/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,Jo=/^[^\n]+/,vr=/(?!\s*\])(?:\\[\s\S]|[^\[\]\\])+/,$o=Me(/^ {0,3}\[(label)\]: *(?:\n[ \t]*)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n[ \t]*)?| *\n[ \t]*)(title))? *(?:\n+|$)/).replace("label",vr).replace("title",/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/).getRegex(),ec=Me(/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/).replace(/bull/g,gr).getRegex(),Rn="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|search|section|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",_r=/<!--(?:-?>|[\s\S]*?(?:-->|$))/,tc=Me("^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$))","i").replace("comment",_r).replace("tag",Rn).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),ga=Me(mr).replace("hr",nn).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Rn).getRegex(),sc=Me(/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/).replace("paragraph",ga).getRegex(),br={blockquote:sc,code:Xo,def:$o,fences:Zo,heading:Ko,hr:nn,html:tc,lheading:pa,list:ec,newline:Yo,paragraph:ga,table:en,text:Jo},Ur=Me("^ *([^\\n ].*)\\n {0,3}((?:\\| *)?:?-+:? *(?:\\| *:?-+:? *)*(?:\\| *)?)(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)").replace("hr",nn).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("blockquote"," {0,3}>").replace("code","(?: {4}| {0,3}	)[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Rn).getRegex(),nc={...br,lheading:Qo,table:Ur,paragraph:Me(mr).replace("hr",nn).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("table",Ur).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Rn).getRegex()},rc={...br,html:Me(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",_r).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:en,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:Me(mr).replace("hr",nn).replace("heading",` *#{1,6} *[^
]`).replace("lheading",pa).replace("|table","").replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").replace("|tag","").getRegex()},ic=/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,lc=/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,ma=/^( {2,}|\\)\n(?!\s*$)/,ac=/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,Pn=/[\p{P}\p{S}]/u,kr=/[\s\p{P}\p{S}]/u,va=/[^\s\p{P}\p{S}]/u,oc=Me(/^((?![*_])punctSpace)/,"u").replace(/punctSpace/g,kr).getRegex(),_a=/(?!~)[\p{P}\p{S}]/u,cc=/(?!~)[\s\p{P}\p{S}]/u,uc=/(?:[^\s\p{P}\p{S}]|~)/u,fc=Me(/link|precode-code|html/,"g").replace("link",/\[(?:[^\[\]`]|(?<a>`+)[^`]+\k<a>(?!`))*?\]\((?:\\[\s\S]|[^\\\(\)]|\((?:\\[\s\S]|[^\\\(\)])*\))*\)/).replace("precode-",Wo?"(?<!`)()":"(^^|[^`])").replace("code",/(?<b>`+)[^`]+\k<b>(?!`)/).replace("html",/<(?! )[^<>]*?>/).getRegex(),ba=/^(?:\*+(?:((?!\*)punct)|[^\s*]))|^_+(?:((?!_)punct)|([^\s_]))/,dc=Me(ba,"u").replace(/punct/g,Pn).getRegex(),hc=Me(ba,"u").replace(/punct/g,_a).getRegex(),ka="^[^_*]*?__[^_*]*?\\*[^_*]*?(?=__)|[^*]+(?=[^*])|(?!\\*)punct(\\*+)(?=[\\s]|$)|notPunctSpace(\\*+)(?!\\*)(?=punctSpace|$)|(?!\\*)punctSpace(\\*+)(?=notPunctSpace)|[\\s](\\*+)(?!\\*)(?=punct)|(?!\\*)punct(\\*+)(?!\\*)(?=punct)|notPunctSpace(\\*+)(?=notPunctSpace)",pc=Me(ka,"gu").replace(/notPunctSpace/g,va).replace(/punctSpace/g,kr).replace(/punct/g,Pn).getRegex(),gc=Me(ka,"gu").replace(/notPunctSpace/g,uc).replace(/punctSpace/g,cc).replace(/punct/g,_a).getRegex(),mc=Me("^[^_*]*?\\*\\*[^_*]*?_[^_*]*?(?=\\*\\*)|[^_]+(?=[^_])|(?!_)punct(_+)(?=[\\s]|$)|notPunctSpace(_+)(?!_)(?=punctSpace|$)|(?!_)punctSpace(_+)(?=notPunctSpace)|[\\s](_+)(?!_)(?=punct)|(?!_)punct(_+)(?!_)(?=punct)","gu").replace(/notPunctSpace/g,va).replace(/punctSpace/g,kr).replace(/punct/g,Pn).getRegex(),vc=Me(/\\(punct)/,"gu").replace(/punct/g,Pn).getRegex(),_c=Me(/^<(scheme:[^\s\x00-\x1f<>]*|email)>/).replace("scheme",/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/).replace("email",/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/).getRegex(),bc=Me(_r).replace("(?:-->|$)","-->").getRegex(),kc=Me("^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>").replace("comment",bc).replace("attribute",/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/).getRegex(),wn=/(?:\[(?:\\[\s\S]|[^\[\]\\])*\]|\\[\s\S]|`+[^`]*?`+(?!`)|[^\[\]\\`])*?/,yc=Me(/^!?\[(label)\]\(\s*(href)(?:(?:[ \t]*(?:\n[ \t]*)?)(title))?\s*\)/).replace("label",wn).replace("href",/<(?:\\.|[^\n<>\\])+>|[^ \t\n\x00-\x1f]*/).replace("title",/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/).getRegex(),ya=Me(/^!?\[(label)\]\[(ref)\]/).replace("label",wn).replace("ref",vr).getRegex(),wa=Me(/^!?\[(ref)\](?:\[\])?/).replace("ref",vr).getRegex(),wc=Me("reflink|nolink(?!\\()","g").replace("reflink",ya).replace("nolink",wa).getRegex(),Br=/[hH][tT][tT][pP][sS]?|[fF][tT][pP]/,yr={_backpedal:en,anyPunctuation:vc,autolink:_c,blockSkip:fc,br:ma,code:lc,del:en,emStrongLDelim:dc,emStrongRDelimAst:pc,emStrongRDelimUnd:mc,escape:ic,link:yc,nolink:wa,punctuation:oc,reflink:ya,reflinkSearch:wc,tag:kc,text:ac,url:en},Ec={...yr,link:Me(/^!?\[(label)\]\((.*?)\)/).replace("label",wn).getRegex(),reflink:Me(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",wn).getRegex()},sr={...yr,emStrongRDelimAst:gc,emStrongLDelim:hc,url:Me(/^((?:protocol):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/).replace("protocol",Br).replace("email",/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/).getRegex(),_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])((?:\\[\s\S]|[^\\])*?(?:\\[\s\S]|[^\s~\\]))\1(?=[^~]|$)/,text:Me(/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|protocol:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/).replace("protocol",Br).getRegex()},Tc={...sr,br:Me(ma).replace("{2,}","*").getRegex(),text:Me(sr.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()},un={normal:br,gfm:nc,pedantic:rc},Hs={normal:yr,gfm:sr,breaks:Tc,pedantic:Ec},Sc={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},Vr=s=>Sc[s];function os(s,e){if(e){if(At.escapeTest.test(s))return s.replace(At.escapeReplace,Vr)}else if(At.escapeTestNoEncode.test(s))return s.replace(At.escapeReplaceNoEncode,Vr);return s}function zr(s){try{s=encodeURI(s).replace(At.percentDecode,"%")}catch{return null}return s}function qr(s,e){var i;let t=s.replace(At.findPipe,(a,l,o)=>{let u=!1,f=l;for(;--f>=0&&o[f]==="\\";)u=!u;return u?"|":" |"}),n=t.split(At.splitPipe),r=0;if(n[0].trim()||n.shift(),n.length>0&&!((i=n.at(-1))!=null&&i.trim())&&n.pop(),e)if(n.length>e)n.splice(e);else for(;n.length<e;)n.push("");for(;r<n.length;r++)n[r]=n[r].trim().replace(At.slashPipe,"|");return n}function Gs(s,e,t){let n=s.length;if(n===0)return"";let r=0;for(;r<n&&s.charAt(n-r-1)===e;)r++;return s.slice(0,n-r)}function Ac(s,e){if(s.indexOf(e[1])===-1)return-1;let t=0;for(let n=0;n<s.length;n++)if(s[n]==="\\")n++;else if(s[n]===e[0])t++;else if(s[n]===e[1]&&(t--,t<0))return n;return t>0?-2:-1}function jr(s,e,t,n,r){let i=e.href,a=e.title||null,l=s[1].replace(r.other.outputLinkReplace,"$1");n.state.inLink=!0;let o={type:s[0].charAt(0)==="!"?"image":"link",raw:t,href:i,title:a,text:l,tokens:n.inlineTokens(l)};return n.state.inLink=!1,o}function Cc(s,e,t){let n=s.match(t.other.indentCodeCompensation);if(n===null)return e;let r=n[1];return e.split(`
`).map(i=>{let a=i.match(t.other.beginningSpace);if(a===null)return i;let[l]=a;return l.length>=r.length?i.slice(r.length):i}).join(`
`)}var En=class{constructor(s){Le(this,"options");Le(this,"rules");Le(this,"lexer");this.options=s||Ns}space(s){let e=this.rules.block.newline.exec(s);if(e&&e[0].length>0)return{type:"space",raw:e[0]}}code(s){let e=this.rules.block.code.exec(s);if(e){let t=e[0].replace(this.rules.other.codeRemoveIndent,"");return{type:"code",raw:e[0],codeBlockStyle:"indented",text:this.options.pedantic?t:Gs(t,`
`)}}}fences(s){let e=this.rules.block.fences.exec(s);if(e){let t=e[0],n=Cc(t,e[3]||"",this.rules);return{type:"code",raw:t,lang:e[2]?e[2].trim().replace(this.rules.inline.anyPunctuation,"$1"):e[2],text:n}}}heading(s){let e=this.rules.block.heading.exec(s);if(e){let t=e[2].trim();if(this.rules.other.endingHash.test(t)){let n=Gs(t,"#");(this.options.pedantic||!n||this.rules.other.endingSpaceChar.test(n))&&(t=n.trim())}return{type:"heading",raw:e[0],depth:e[1].length,text:t,tokens:this.lexer.inline(t)}}}hr(s){let e=this.rules.block.hr.exec(s);if(e)return{type:"hr",raw:Gs(e[0],`
`)}}blockquote(s){let e=this.rules.block.blockquote.exec(s);if(e){let t=Gs(e[0],`
`).split(`
`),n="",r="",i=[];for(;t.length>0;){let a=!1,l=[],o;for(o=0;o<t.length;o++)if(this.rules.other.blockquoteStart.test(t[o]))l.push(t[o]),a=!0;else if(!a)l.push(t[o]);else break;t=t.slice(o);let u=l.join(`
`),f=u.replace(this.rules.other.blockquoteSetextReplace,`
    $1`).replace(this.rules.other.blockquoteSetextReplace2,"");n=n?`${n}
${u}`:u,r=r?`${r}
${f}`:f;let p=this.lexer.state.top;if(this.lexer.state.top=!0,this.lexer.blockTokens(f,i,!0),this.lexer.state.top=p,t.length===0)break;let h=i.at(-1);if((h==null?void 0:h.type)==="code")break;if((h==null?void 0:h.type)==="blockquote"){let g=h,m=g.raw+`
`+t.join(`
`),v=this.blockquote(m);i[i.length-1]=v,n=n.substring(0,n.length-g.raw.length)+v.raw,r=r.substring(0,r.length-g.text.length)+v.text;break}else if((h==null?void 0:h.type)==="list"){let g=h,m=g.raw+`
`+t.join(`
`),v=this.list(m);i[i.length-1]=v,n=n.substring(0,n.length-h.raw.length)+v.raw,r=r.substring(0,r.length-g.raw.length)+v.raw,t=m.substring(i.at(-1).raw.length).split(`
`);continue}}return{type:"blockquote",raw:n,tokens:i,text:r}}}list(s){var t,n;let e=this.rules.block.list.exec(s);if(e){let r=e[1].trim(),i=r.length>1,a={type:"list",raw:"",ordered:i,start:i?+r.slice(0,-1):"",loose:!1,items:[]};r=i?`\\d{1,9}\\${r.slice(-1)}`:`\\${r}`,this.options.pedantic&&(r=i?r:"[*+-]");let l=this.rules.other.listItemRegex(r),o=!1;for(;s;){let f=!1,p="",h="";if(!(e=l.exec(s))||this.rules.block.hr.test(s))break;p=e[0],s=s.substring(p.length);let g=e[2].split(`
`,1)[0].replace(this.rules.other.listReplaceTabs,C=>" ".repeat(3*C.length)),m=s.split(`
`,1)[0],v=!g.trim(),T=0;if(this.options.pedantic?(T=2,h=g.trimStart()):v?T=e[1].length+1:(T=e[2].search(this.rules.other.nonSpaceChar),T=T>4?1:T,h=g.slice(T),T+=e[1].length),v&&this.rules.other.blankLine.test(m)&&(p+=m+`
`,s=s.substring(m.length+1),f=!0),!f){let C=this.rules.other.nextBulletRegex(T),E=this.rules.other.hrRegex(T),S=this.rules.other.fencesBeginRegex(T),b=this.rules.other.headingBeginRegex(T),A=this.rules.other.htmlBeginRegex(T);for(;s;){let I=s.split(`
`,1)[0],w;if(m=I,this.options.pedantic?(m=m.replace(this.rules.other.listReplaceNesting,"  "),w=m):w=m.replace(this.rules.other.tabCharGlobal,"    "),S.test(m)||b.test(m)||A.test(m)||C.test(m)||E.test(m))break;if(w.search(this.rules.other.nonSpaceChar)>=T||!m.trim())h+=`
`+w.slice(T);else{if(v||g.replace(this.rules.other.tabCharGlobal,"    ").search(this.rules.other.nonSpaceChar)>=4||S.test(g)||b.test(g)||E.test(g))break;h+=`
`+m}!v&&!m.trim()&&(v=!0),p+=I+`
`,s=s.substring(I.length+1),g=w.slice(T)}}a.loose||(o?a.loose=!0:this.rules.other.doubleBlankLine.test(p)&&(o=!0)),a.items.push({type:"list_item",raw:p,task:!!this.options.gfm&&this.rules.other.listIsTask.test(h),loose:!1,text:h,tokens:[]}),a.raw+=p}let u=a.items.at(-1);if(u)u.raw=u.raw.trimEnd(),u.text=u.text.trimEnd();else return;a.raw=a.raw.trimEnd();for(let f of a.items){if(this.lexer.state.top=!1,f.tokens=this.lexer.blockTokens(f.text,[]),f.task){if(f.text=f.text.replace(this.rules.other.listReplaceTask,""),((t=f.tokens[0])==null?void 0:t.type)==="text"||((n=f.tokens[0])==null?void 0:n.type)==="paragraph"){f.tokens[0].raw=f.tokens[0].raw.replace(this.rules.other.listReplaceTask,""),f.tokens[0].text=f.tokens[0].text.replace(this.rules.other.listReplaceTask,"");for(let h=this.lexer.inlineQueue.length-1;h>=0;h--)if(this.rules.other.listIsTask.test(this.lexer.inlineQueue[h].src)){this.lexer.inlineQueue[h].src=this.lexer.inlineQueue[h].src.replace(this.rules.other.listReplaceTask,"");break}}let p=this.rules.other.listTaskCheckbox.exec(f.raw);if(p){let h={type:"checkbox",raw:p[0]+" ",checked:p[0]!=="[ ]"};f.checked=h.checked,a.loose?f.tokens[0]&&["paragraph","text"].includes(f.tokens[0].type)&&"tokens"in f.tokens[0]&&f.tokens[0].tokens?(f.tokens[0].raw=h.raw+f.tokens[0].raw,f.tokens[0].text=h.raw+f.tokens[0].text,f.tokens[0].tokens.unshift(h)):f.tokens.unshift({type:"paragraph",raw:h.raw,text:h.raw,tokens:[h]}):f.tokens.unshift(h)}}if(!a.loose){let p=f.tokens.filter(g=>g.type==="space"),h=p.length>0&&p.some(g=>this.rules.other.anyLine.test(g.raw));a.loose=h}}if(a.loose)for(let f of a.items){f.loose=!0;for(let p of f.tokens)p.type==="text"&&(p.type="paragraph")}return a}}html(s){let e=this.rules.block.html.exec(s);if(e)return{type:"html",block:!0,raw:e[0],pre:e[1]==="pre"||e[1]==="script"||e[1]==="style",text:e[0]}}def(s){let e=this.rules.block.def.exec(s);if(e){let t=e[1].toLowerCase().replace(this.rules.other.multipleSpaceGlobal," "),n=e[2]?e[2].replace(this.rules.other.hrefBrackets,"$1").replace(this.rules.inline.anyPunctuation,"$1"):"",r=e[3]?e[3].substring(1,e[3].length-1).replace(this.rules.inline.anyPunctuation,"$1"):e[3];return{type:"def",tag:t,raw:e[0],href:n,title:r}}}table(s){var a;let e=this.rules.block.table.exec(s);if(!e||!this.rules.other.tableDelimiter.test(e[2]))return;let t=qr(e[1]),n=e[2].replace(this.rules.other.tableAlignChars,"").split("|"),r=(a=e[3])!=null&&a.trim()?e[3].replace(this.rules.other.tableRowBlankLine,"").split(`
`):[],i={type:"table",raw:e[0],header:[],align:[],rows:[]};if(t.length===n.length){for(let l of n)this.rules.other.tableAlignRight.test(l)?i.align.push("right"):this.rules.other.tableAlignCenter.test(l)?i.align.push("center"):this.rules.other.tableAlignLeft.test(l)?i.align.push("left"):i.align.push(null);for(let l=0;l<t.length;l++)i.header.push({text:t[l],tokens:this.lexer.inline(t[l]),header:!0,align:i.align[l]});for(let l of r)i.rows.push(qr(l,i.header.length).map((o,u)=>({text:o,tokens:this.lexer.inline(o),header:!1,align:i.align[u]})));return i}}lheading(s){let e=this.rules.block.lheading.exec(s);if(e)return{type:"heading",raw:e[0],depth:e[2].charAt(0)==="="?1:2,text:e[1],tokens:this.lexer.inline(e[1])}}paragraph(s){let e=this.rules.block.paragraph.exec(s);if(e){let t=e[1].charAt(e[1].length-1)===`
`?e[1].slice(0,-1):e[1];return{type:"paragraph",raw:e[0],text:t,tokens:this.lexer.inline(t)}}}text(s){let e=this.rules.block.text.exec(s);if(e)return{type:"text",raw:e[0],text:e[0],tokens:this.lexer.inline(e[0])}}escape(s){let e=this.rules.inline.escape.exec(s);if(e)return{type:"escape",raw:e[0],text:e[1]}}tag(s){let e=this.rules.inline.tag.exec(s);if(e)return!this.lexer.state.inLink&&this.rules.other.startATag.test(e[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&this.rules.other.endATag.test(e[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&this.rules.other.startPreScriptTag.test(e[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&this.rules.other.endPreScriptTag.test(e[0])&&(this.lexer.state.inRawBlock=!1),{type:"html",raw:e[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,block:!1,text:e[0]}}link(s){let e=this.rules.inline.link.exec(s);if(e){let t=e[2].trim();if(!this.options.pedantic&&this.rules.other.startAngleBracket.test(t)){if(!this.rules.other.endAngleBracket.test(t))return;let i=Gs(t.slice(0,-1),"\\");if((t.length-i.length)%2===0)return}else{let i=Ac(e[2],"()");if(i===-2)return;if(i>-1){let a=(e[0].indexOf("!")===0?5:4)+e[1].length+i;e[2]=e[2].substring(0,i),e[0]=e[0].substring(0,a).trim(),e[3]=""}}let n=e[2],r="";if(this.options.pedantic){let i=this.rules.other.pedanticHrefTitle.exec(n);i&&(n=i[1],r=i[3])}else r=e[3]?e[3].slice(1,-1):"";return n=n.trim(),this.rules.other.startAngleBracket.test(n)&&(this.options.pedantic&&!this.rules.other.endAngleBracket.test(t)?n=n.slice(1):n=n.slice(1,-1)),jr(e,{href:n&&n.replace(this.rules.inline.anyPunctuation,"$1"),title:r&&r.replace(this.rules.inline.anyPunctuation,"$1")},e[0],this.lexer,this.rules)}}reflink(s,e){let t;if((t=this.rules.inline.reflink.exec(s))||(t=this.rules.inline.nolink.exec(s))){let n=(t[2]||t[1]).replace(this.rules.other.multipleSpaceGlobal," "),r=e[n.toLowerCase()];if(!r){let i=t[0].charAt(0);return{type:"text",raw:i,text:i}}return jr(t,r,t[0],this.lexer,this.rules)}}emStrong(s,e,t=""){let n=this.rules.inline.emStrongLDelim.exec(s);if(!(!n||n[3]&&t.match(this.rules.other.unicodeAlphaNumeric))&&(!(n[1]||n[2])||!t||this.rules.inline.punctuation.exec(t))){let r=[...n[0]].length-1,i,a,l=r,o=0,u=n[0][0]==="*"?this.rules.inline.emStrongRDelimAst:this.rules.inline.emStrongRDelimUnd;for(u.lastIndex=0,e=e.slice(-1*s.length+r);(n=u.exec(e))!=null;){if(i=n[1]||n[2]||n[3]||n[4]||n[5]||n[6],!i)continue;if(a=[...i].length,n[3]||n[4]){l+=a;continue}else if((n[5]||n[6])&&r%3&&!((r+a)%3)){o+=a;continue}if(l-=a,l>0)continue;a=Math.min(a,a+l+o);let f=[...n[0]][0].length,p=s.slice(0,r+n.index+f+a);if(Math.min(r,a)%2){let g=p.slice(1,-1);return{type:"em",raw:p,text:g,tokens:this.lexer.inlineTokens(g)}}let h=p.slice(2,-2);return{type:"strong",raw:p,text:h,tokens:this.lexer.inlineTokens(h)}}}}codespan(s){let e=this.rules.inline.code.exec(s);if(e){let t=e[2].replace(this.rules.other.newLineCharGlobal," "),n=this.rules.other.nonSpaceChar.test(t),r=this.rules.other.startingSpaceChar.test(t)&&this.rules.other.endingSpaceChar.test(t);return n&&r&&(t=t.substring(1,t.length-1)),{type:"codespan",raw:e[0],text:t}}}br(s){let e=this.rules.inline.br.exec(s);if(e)return{type:"br",raw:e[0]}}del(s){let e=this.rules.inline.del.exec(s);if(e)return{type:"del",raw:e[0],text:e[2],tokens:this.lexer.inlineTokens(e[2])}}autolink(s){let e=this.rules.inline.autolink.exec(s);if(e){let t,n;return e[2]==="@"?(t=e[1],n="mailto:"+t):(t=e[1],n=t),{type:"link",raw:e[0],text:t,href:n,tokens:[{type:"text",raw:t,text:t}]}}}url(s){var t;let e;if(e=this.rules.inline.url.exec(s)){let n,r;if(e[2]==="@")n=e[0],r="mailto:"+n;else{let i;do i=e[0],e[0]=((t=this.rules.inline._backpedal.exec(e[0]))==null?void 0:t[0])??"";while(i!==e[0]);n=e[0],e[1]==="www."?r="http://"+e[0]:r=e[0]}return{type:"link",raw:e[0],text:n,href:r,tokens:[{type:"text",raw:n,text:n}]}}}inlineText(s){let e=this.rules.inline.text.exec(s);if(e){let t=this.lexer.state.inRawBlock;return{type:"text",raw:e[0],text:e[0],escaped:t}}}},Yt=class nr{constructor(e){Le(this,"tokens");Le(this,"options");Le(this,"state");Le(this,"inlineQueue");Le(this,"tokenizer");this.tokens=[],this.tokens.links=Object.create(null),this.options=e||Ns,this.options.tokenizer=this.options.tokenizer||new En,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};let t={other:At,block:un.normal,inline:Hs.normal};this.options.pedantic?(t.block=un.pedantic,t.inline=Hs.pedantic):this.options.gfm&&(t.block=un.gfm,this.options.breaks?t.inline=Hs.breaks:t.inline=Hs.gfm),this.tokenizer.rules=t}static get rules(){return{block:un,inline:Hs}}static lex(e,t){return new nr(t).lex(e)}static lexInline(e,t){return new nr(t).inlineTokens(e)}lex(e){e=e.replace(At.carriageReturn,`
`),this.blockTokens(e,this.tokens);for(let t=0;t<this.inlineQueue.length;t++){let n=this.inlineQueue[t];this.inlineTokens(n.src,n.tokens)}return this.inlineQueue=[],this.tokens}blockTokens(e,t=[],n=!1){var r,i,a;for(this.options.pedantic&&(e=e.replace(At.tabCharGlobal,"    ").replace(At.spaceLine,""));e;){let l;if((i=(r=this.options.extensions)==null?void 0:r.block)!=null&&i.some(u=>(l=u.call({lexer:this},e,t))?(e=e.substring(l.raw.length),t.push(l),!0):!1))continue;if(l=this.tokenizer.space(e)){e=e.substring(l.raw.length);let u=t.at(-1);l.raw.length===1&&u!==void 0?u.raw+=`
`:t.push(l);continue}if(l=this.tokenizer.code(e)){e=e.substring(l.raw.length);let u=t.at(-1);(u==null?void 0:u.type)==="paragraph"||(u==null?void 0:u.type)==="text"?(u.raw+=(u.raw.endsWith(`
`)?"":`
`)+l.raw,u.text+=`
`+l.text,this.inlineQueue.at(-1).src=u.text):t.push(l);continue}if(l=this.tokenizer.fences(e)){e=e.substring(l.raw.length),t.push(l);continue}if(l=this.tokenizer.heading(e)){e=e.substring(l.raw.length),t.push(l);continue}if(l=this.tokenizer.hr(e)){e=e.substring(l.raw.length),t.push(l);continue}if(l=this.tokenizer.blockquote(e)){e=e.substring(l.raw.length),t.push(l);continue}if(l=this.tokenizer.list(e)){e=e.substring(l.raw.length),t.push(l);continue}if(l=this.tokenizer.html(e)){e=e.substring(l.raw.length),t.push(l);continue}if(l=this.tokenizer.def(e)){e=e.substring(l.raw.length);let u=t.at(-1);(u==null?void 0:u.type)==="paragraph"||(u==null?void 0:u.type)==="text"?(u.raw+=(u.raw.endsWith(`
`)?"":`
`)+l.raw,u.text+=`
`+l.raw,this.inlineQueue.at(-1).src=u.text):this.tokens.links[l.tag]||(this.tokens.links[l.tag]={href:l.href,title:l.title},t.push(l));continue}if(l=this.tokenizer.table(e)){e=e.substring(l.raw.length),t.push(l);continue}if(l=this.tokenizer.lheading(e)){e=e.substring(l.raw.length),t.push(l);continue}let o=e;if((a=this.options.extensions)!=null&&a.startBlock){let u=1/0,f=e.slice(1),p;this.options.extensions.startBlock.forEach(h=>{p=h.call({lexer:this},f),typeof p=="number"&&p>=0&&(u=Math.min(u,p))}),u<1/0&&u>=0&&(o=e.substring(0,u+1))}if(this.state.top&&(l=this.tokenizer.paragraph(o))){let u=t.at(-1);n&&(u==null?void 0:u.type)==="paragraph"?(u.raw+=(u.raw.endsWith(`
`)?"":`
`)+l.raw,u.text+=`
`+l.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=u.text):t.push(l),n=o.length!==e.length,e=e.substring(l.raw.length);continue}if(l=this.tokenizer.text(e)){e=e.substring(l.raw.length);let u=t.at(-1);(u==null?void 0:u.type)==="text"?(u.raw+=(u.raw.endsWith(`
`)?"":`
`)+l.raw,u.text+=`
`+l.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=u.text):t.push(l);continue}if(e){let u="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(u);break}else throw new Error(u)}}return this.state.top=!0,t}inline(e,t=[]){return this.inlineQueue.push({src:e,tokens:t}),t}inlineTokens(e,t=[]){var o,u,f,p,h;let n=e,r=null;if(this.tokens.links){let g=Object.keys(this.tokens.links);if(g.length>0)for(;(r=this.tokenizer.rules.inline.reflinkSearch.exec(n))!=null;)g.includes(r[0].slice(r[0].lastIndexOf("[")+1,-1))&&(n=n.slice(0,r.index)+"["+"a".repeat(r[0].length-2)+"]"+n.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;(r=this.tokenizer.rules.inline.anyPunctuation.exec(n))!=null;)n=n.slice(0,r.index)+"++"+n.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex);let i;for(;(r=this.tokenizer.rules.inline.blockSkip.exec(n))!=null;)i=r[2]?r[2].length:0,n=n.slice(0,r.index+i)+"["+"a".repeat(r[0].length-i-2)+"]"+n.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);n=((u=(o=this.options.hooks)==null?void 0:o.emStrongMask)==null?void 0:u.call({lexer:this},n))??n;let a=!1,l="";for(;e;){a||(l=""),a=!1;let g;if((p=(f=this.options.extensions)==null?void 0:f.inline)!=null&&p.some(v=>(g=v.call({lexer:this},e,t))?(e=e.substring(g.raw.length),t.push(g),!0):!1))continue;if(g=this.tokenizer.escape(e)){e=e.substring(g.raw.length),t.push(g);continue}if(g=this.tokenizer.tag(e)){e=e.substring(g.raw.length),t.push(g);continue}if(g=this.tokenizer.link(e)){e=e.substring(g.raw.length),t.push(g);continue}if(g=this.tokenizer.reflink(e,this.tokens.links)){e=e.substring(g.raw.length);let v=t.at(-1);g.type==="text"&&(v==null?void 0:v.type)==="text"?(v.raw+=g.raw,v.text+=g.text):t.push(g);continue}if(g=this.tokenizer.emStrong(e,n,l)){e=e.substring(g.raw.length),t.push(g);continue}if(g=this.tokenizer.codespan(e)){e=e.substring(g.raw.length),t.push(g);continue}if(g=this.tokenizer.br(e)){e=e.substring(g.raw.length),t.push(g);continue}if(g=this.tokenizer.del(e)){e=e.substring(g.raw.length),t.push(g);continue}if(g=this.tokenizer.autolink(e)){e=e.substring(g.raw.length),t.push(g);continue}if(!this.state.inLink&&(g=this.tokenizer.url(e))){e=e.substring(g.raw.length),t.push(g);continue}let m=e;if((h=this.options.extensions)!=null&&h.startInline){let v=1/0,T=e.slice(1),C;this.options.extensions.startInline.forEach(E=>{C=E.call({lexer:this},T),typeof C=="number"&&C>=0&&(v=Math.min(v,C))}),v<1/0&&v>=0&&(m=e.substring(0,v+1))}if(g=this.tokenizer.inlineText(m)){e=e.substring(g.raw.length),g.raw.slice(-1)!=="_"&&(l=g.raw.slice(-1)),a=!0;let v=t.at(-1);(v==null?void 0:v.type)==="text"?(v.raw+=g.raw,v.text+=g.text):t.push(g);continue}if(e){let v="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(v);break}else throw new Error(v)}}return t}},Tn=class{constructor(s){Le(this,"options");Le(this,"parser");this.options=s||Ns}space(s){return""}code({text:s,lang:e,escaped:t}){var i;let n=(i=(e||"").match(At.notSpaceStart))==null?void 0:i[0],r=s.replace(At.endingNewline,"")+`
`;return n?'<pre><code class="language-'+os(n)+'">'+(t?r:os(r,!0))+`</code></pre>
`:"<pre><code>"+(t?r:os(r,!0))+`</code></pre>
`}blockquote({tokens:s}){return`<blockquote>
${this.parser.parse(s)}</blockquote>
`}html({text:s}){return s}def(s){return""}heading({tokens:s,depth:e}){return`<h${e}>${this.parser.parseInline(s)}</h${e}>
`}hr(s){return`<hr>
`}list(s){let e=s.ordered,t=s.start,n="";for(let a=0;a<s.items.length;a++){let l=s.items[a];n+=this.listitem(l)}let r=e?"ol":"ul",i=e&&t!==1?' start="'+t+'"':"";return"<"+r+i+`>
`+n+"</"+r+`>
`}listitem(s){return`<li>${this.parser.parse(s.tokens)}</li>
`}checkbox({checked:s}){return"<input "+(s?'checked="" ':"")+'disabled="" type="checkbox"> '}paragraph({tokens:s}){return`<p>${this.parser.parseInline(s)}</p>
`}table(s){let e="",t="";for(let r=0;r<s.header.length;r++)t+=this.tablecell(s.header[r]);e+=this.tablerow({text:t});let n="";for(let r=0;r<s.rows.length;r++){let i=s.rows[r];t="";for(let a=0;a<i.length;a++)t+=this.tablecell(i[a]);n+=this.tablerow({text:t})}return n&&(n=`<tbody>${n}</tbody>`),`<table>
<thead>
`+e+`</thead>
`+n+`</table>
`}tablerow({text:s}){return`<tr>
${s}</tr>
`}tablecell(s){let e=this.parser.parseInline(s.tokens),t=s.header?"th":"td";return(s.align?`<${t} align="${s.align}">`:`<${t}>`)+e+`</${t}>
`}strong({tokens:s}){return`<strong>${this.parser.parseInline(s)}</strong>`}em({tokens:s}){return`<em>${this.parser.parseInline(s)}</em>`}codespan({text:s}){return`<code>${os(s,!0)}</code>`}br(s){return"<br>"}del({tokens:s}){return`<del>${this.parser.parseInline(s)}</del>`}link({href:s,title:e,tokens:t}){let n=this.parser.parseInline(t),r=zr(s);if(r===null)return n;s=r;let i='<a href="'+s+'"';return e&&(i+=' title="'+os(e)+'"'),i+=">"+n+"</a>",i}image({href:s,title:e,text:t,tokens:n}){n&&(t=this.parser.parseInline(n,this.parser.textRenderer));let r=zr(s);if(r===null)return os(t);s=r;let i=`<img src="${s}" alt="${t}"`;return e&&(i+=` title="${os(e)}"`),i+=">",i}text(s){return"tokens"in s&&s.tokens?this.parser.parseInline(s.tokens):"escaped"in s&&s.escaped?s.text:os(s.text)}},wr=class{strong({text:s}){return s}em({text:s}){return s}codespan({text:s}){return s}del({text:s}){return s}html({text:s}){return s}text({text:s}){return s}link({text:s}){return""+s}image({text:s}){return""+s}br(){return""}checkbox({raw:s}){return s}},Xt=class rr{constructor(e){Le(this,"options");Le(this,"renderer");Le(this,"textRenderer");this.options=e||Ns,this.options.renderer=this.options.renderer||new Tn,this.renderer=this.options.renderer,this.renderer.options=this.options,this.renderer.parser=this,this.textRenderer=new wr}static parse(e,t){return new rr(t).parse(e)}static parseInline(e,t){return new rr(t).parseInline(e)}parse(e){var n,r;let t="";for(let i=0;i<e.length;i++){let a=e[i];if((r=(n=this.options.extensions)==null?void 0:n.renderers)!=null&&r[a.type]){let o=a,u=this.options.extensions.renderers[o.type].call({parser:this},o);if(u!==!1||!["space","hr","heading","code","table","blockquote","list","html","def","paragraph","text"].includes(o.type)){t+=u||"";continue}}let l=a;switch(l.type){case"space":{t+=this.renderer.space(l);break}case"hr":{t+=this.renderer.hr(l);break}case"heading":{t+=this.renderer.heading(l);break}case"code":{t+=this.renderer.code(l);break}case"table":{t+=this.renderer.table(l);break}case"blockquote":{t+=this.renderer.blockquote(l);break}case"list":{t+=this.renderer.list(l);break}case"checkbox":{t+=this.renderer.checkbox(l);break}case"html":{t+=this.renderer.html(l);break}case"def":{t+=this.renderer.def(l);break}case"paragraph":{t+=this.renderer.paragraph(l);break}case"text":{t+=this.renderer.text(l);break}default:{let o='Token with "'+l.type+'" type was not found.';if(this.options.silent)return console.error(o),"";throw new Error(o)}}}return t}parseInline(e,t=this.renderer){var r,i;let n="";for(let a=0;a<e.length;a++){let l=e[a];if((i=(r=this.options.extensions)==null?void 0:r.renderers)!=null&&i[l.type]){let u=this.options.extensions.renderers[l.type].call({parser:this},l);if(u!==!1||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(l.type)){n+=u||"";continue}}let o=l;switch(o.type){case"escape":{n+=t.text(o);break}case"html":{n+=t.html(o);break}case"link":{n+=t.link(o);break}case"image":{n+=t.image(o);break}case"checkbox":{n+=t.checkbox(o);break}case"strong":{n+=t.strong(o);break}case"em":{n+=t.em(o);break}case"codespan":{n+=t.codespan(o);break}case"br":{n+=t.br(o);break}case"del":{n+=t.del(o);break}case"text":{n+=t.text(o);break}default:{let u='Token with "'+o.type+'" type was not found.';if(this.options.silent)return console.error(u),"";throw new Error(u)}}}return n}},mn,Js=(mn=class{constructor(s){Le(this,"options");Le(this,"block");this.options=s||Ns}preprocess(s){return s}postprocess(s){return s}processAllTokens(s){return s}emStrongMask(s){return s}provideLexer(){return this.block?Yt.lex:Yt.lexInline}provideParser(){return this.block?Xt.parse:Xt.parseInline}},Le(mn,"passThroughHooks",new Set(["preprocess","postprocess","processAllTokens","emStrongMask"])),Le(mn,"passThroughHooksRespectAsync",new Set(["preprocess","postprocess","processAllTokens"])),mn),Ic=class{constructor(...s){Le(this,"defaults",pr());Le(this,"options",this.setOptions);Le(this,"parse",this.parseMarkdown(!0));Le(this,"parseInline",this.parseMarkdown(!1));Le(this,"Parser",Xt);Le(this,"Renderer",Tn);Le(this,"TextRenderer",wr);Le(this,"Lexer",Yt);Le(this,"Tokenizer",En);Le(this,"Hooks",Js);this.use(...s)}walkTokens(s,e){var n,r;let t=[];for(let i of s)switch(t=t.concat(e.call(this,i)),i.type){case"table":{let a=i;for(let l of a.header)t=t.concat(this.walkTokens(l.tokens,e));for(let l of a.rows)for(let o of l)t=t.concat(this.walkTokens(o.tokens,e));break}case"list":{let a=i;t=t.concat(this.walkTokens(a.items,e));break}default:{let a=i;(r=(n=this.defaults.extensions)==null?void 0:n.childTokens)!=null&&r[a.type]?this.defaults.extensions.childTokens[a.type].forEach(l=>{let o=a[l].flat(1/0);t=t.concat(this.walkTokens(o,e))}):a.tokens&&(t=t.concat(this.walkTokens(a.tokens,e)))}}return t}use(...s){let e=this.defaults.extensions||{renderers:{},childTokens:{}};return s.forEach(t=>{let n={...t};if(n.async=this.defaults.async||n.async||!1,t.extensions&&(t.extensions.forEach(r=>{if(!r.name)throw new Error("extension name required");if("renderer"in r){let i=e.renderers[r.name];i?e.renderers[r.name]=function(...a){let l=r.renderer.apply(this,a);return l===!1&&(l=i.apply(this,a)),l}:e.renderers[r.name]=r.renderer}if("tokenizer"in r){if(!r.level||r.level!=="block"&&r.level!=="inline")throw new Error("extension level must be 'block' or 'inline'");let i=e[r.level];i?i.unshift(r.tokenizer):e[r.level]=[r.tokenizer],r.start&&(r.level==="block"?e.startBlock?e.startBlock.push(r.start):e.startBlock=[r.start]:r.level==="inline"&&(e.startInline?e.startInline.push(r.start):e.startInline=[r.start]))}"childTokens"in r&&r.childTokens&&(e.childTokens[r.name]=r.childTokens)}),n.extensions=e),t.renderer){let r=this.defaults.renderer||new Tn(this.defaults);for(let i in t.renderer){if(!(i in r))throw new Error(`renderer '${i}' does not exist`);if(["options","parser"].includes(i))continue;let a=i,l=t.renderer[a],o=r[a];r[a]=(...u)=>{let f=l.apply(r,u);return f===!1&&(f=o.apply(r,u)),f||""}}n.renderer=r}if(t.tokenizer){let r=this.defaults.tokenizer||new En(this.defaults);for(let i in t.tokenizer){if(!(i in r))throw new Error(`tokenizer '${i}' does not exist`);if(["options","rules","lexer"].includes(i))continue;let a=i,l=t.tokenizer[a],o=r[a];r[a]=(...u)=>{let f=l.apply(r,u);return f===!1&&(f=o.apply(r,u)),f}}n.tokenizer=r}if(t.hooks){let r=this.defaults.hooks||new Js;for(let i in t.hooks){if(!(i in r))throw new Error(`hook '${i}' does not exist`);if(["options","block"].includes(i))continue;let a=i,l=t.hooks[a],o=r[a];Js.passThroughHooks.has(i)?r[a]=u=>{if(this.defaults.async&&Js.passThroughHooksRespectAsync.has(i))return(async()=>{let p=await l.call(r,u);return o.call(r,p)})();let f=l.call(r,u);return o.call(r,f)}:r[a]=(...u)=>{if(this.defaults.async)return(async()=>{let p=await l.apply(r,u);return p===!1&&(p=await o.apply(r,u)),p})();let f=l.apply(r,u);return f===!1&&(f=o.apply(r,u)),f}}n.hooks=r}if(t.walkTokens){let r=this.defaults.walkTokens,i=t.walkTokens;n.walkTokens=function(a){let l=[];return l.push(i.call(this,a)),r&&(l=l.concat(r.call(this,a))),l}}this.defaults={...this.defaults,...n}}),this}setOptions(s){return this.defaults={...this.defaults,...s},this}lexer(s,e){return Yt.lex(s,e??this.defaults)}parser(s,e){return Xt.parse(s,e??this.defaults)}parseMarkdown(s){return(e,t)=>{let n={...t},r={...this.defaults,...n},i=this.onError(!!r.silent,!!r.async);if(this.defaults.async===!0&&n.async===!1)return i(new Error("marked(): The async option was set to true by an extension. Remove async: false from the parse options object to return a Promise."));if(typeof e>"u"||e===null)return i(new Error("marked(): input parameter is undefined or null"));if(typeof e!="string")return i(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(e)+", string expected"));if(r.hooks&&(r.hooks.options=r,r.hooks.block=s),r.async)return(async()=>{let a=r.hooks?await r.hooks.preprocess(e):e,l=await(r.hooks?await r.hooks.provideLexer():s?Yt.lex:Yt.lexInline)(a,r),o=r.hooks?await r.hooks.processAllTokens(l):l;r.walkTokens&&await Promise.all(this.walkTokens(o,r.walkTokens));let u=await(r.hooks?await r.hooks.provideParser():s?Xt.parse:Xt.parseInline)(o,r);return r.hooks?await r.hooks.postprocess(u):u})().catch(i);try{r.hooks&&(e=r.hooks.preprocess(e));let a=(r.hooks?r.hooks.provideLexer():s?Yt.lex:Yt.lexInline)(e,r);r.hooks&&(a=r.hooks.processAllTokens(a)),r.walkTokens&&this.walkTokens(a,r.walkTokens);let l=(r.hooks?r.hooks.provideParser():s?Xt.parse:Xt.parseInline)(a,r);return r.hooks&&(l=r.hooks.postprocess(l)),l}catch(a){return i(a)}}}onError(s,e){return t=>{if(t.message+=`
Please report this to https://github.com/markedjs/marked.`,s){let n="<p>An error occurred:</p><pre>"+os(t.message+"",!0)+"</pre>";return e?Promise.resolve(n):n}if(e)return Promise.reject(t);throw t}}},Ds=new Ic;function Ue(s,e){return Ds.parse(s,e)}Ue.options=Ue.setOptions=function(s){return Ds.setOptions(s),Ue.defaults=Ds.defaults,da(Ue.defaults),Ue};Ue.getDefaults=pr;Ue.defaults=Ns;Ue.use=function(...s){return Ds.use(...s),Ue.defaults=Ds.defaults,da(Ue.defaults),Ue};Ue.walkTokens=function(s,e){return Ds.walkTokens(s,e)};Ue.parseInline=Ds.parseInline;Ue.Parser=Xt;Ue.parser=Xt.parse;Ue.Renderer=Tn;Ue.TextRenderer=wr;Ue.Lexer=Yt;Ue.lexer=Yt.lex;Ue.Tokenizer=En;Ue.Hooks=Js;Ue.parse=Ue;Ue.options;Ue.setOptions;Ue.use;Ue.walkTokens;Ue.parseInline;Xt.parse;Yt.lex;var Hr=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Dc(s){return s&&s.__esModule&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s}var Ea={exports:{}};(function(s){var e=typeof window<"u"?window:typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope?self:{};/**
 * Prism: Lightweight, robust, elegant syntax highlighting
 *
 * @license MIT <https://opensource.org/licenses/MIT>
 * @author Lea Verou <https://lea.verou.me>
 * @namespace
 * @public
 */var t=function(n){var r=/(?:^|\s)lang(?:uage)?-([\w-]+)(?=\s|$)/i,i=0,a={},l={manual:n.Prism&&n.Prism.manual,disableWorkerMessageHandler:n.Prism&&n.Prism.disableWorkerMessageHandler,util:{encode:function E(S){return S instanceof o?new o(S.type,E(S.content),S.alias):Array.isArray(S)?S.map(E):S.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/\u00a0/g," ")},type:function(E){return Object.prototype.toString.call(E).slice(8,-1)},objId:function(E){return E.__id||Object.defineProperty(E,"__id",{value:++i}),E.__id},clone:function E(S,b){b=b||{};var A,I;switch(l.util.type(S)){case"Object":if(I=l.util.objId(S),b[I])return b[I];A={},b[I]=A;for(var w in S)S.hasOwnProperty(w)&&(A[w]=E(S[w],b));return A;case"Array":return I=l.util.objId(S),b[I]?b[I]:(A=[],b[I]=A,S.forEach(function(O,N){A[N]=E(O,b)}),A);default:return S}},getLanguage:function(E){for(;E;){var S=r.exec(E.className);if(S)return S[1].toLowerCase();E=E.parentElement}return"none"},setLanguage:function(E,S){E.className=E.className.replace(RegExp(r,"gi"),""),E.classList.add("language-"+S)},currentScript:function(){if(typeof document>"u")return null;if(document.currentScript&&document.currentScript.tagName==="SCRIPT")return document.currentScript;try{throw new Error}catch(A){var E=(/at [^(\r\n]*\((.*):[^:]+:[^:]+\)$/i.exec(A.stack)||[])[1];if(E){var S=document.getElementsByTagName("script");for(var b in S)if(S[b].src==E)return S[b]}return null}},isActive:function(E,S,b){for(var A="no-"+S;E;){var I=E.classList;if(I.contains(S))return!0;if(I.contains(A))return!1;E=E.parentElement}return!!b}},languages:{plain:a,plaintext:a,text:a,txt:a,extend:function(E,S){var b=l.util.clone(l.languages[E]);for(var A in S)b[A]=S[A];return b},insertBefore:function(E,S,b,A){A=A||l.languages;var I=A[E],w={};for(var O in I)if(I.hasOwnProperty(O)){if(O==S)for(var N in b)b.hasOwnProperty(N)&&(w[N]=b[N]);b.hasOwnProperty(O)||(w[O]=I[O])}var M=A[E];return A[E]=w,l.languages.DFS(l.languages,function(L,B){B===M&&L!=E&&(this[L]=w)}),w},DFS:function E(S,b,A,I){I=I||{};var w=l.util.objId;for(var O in S)if(S.hasOwnProperty(O)){b.call(S,O,S[O],A||O);var N=S[O],M=l.util.type(N);M==="Object"&&!I[w(N)]?(I[w(N)]=!0,E(N,b,null,I)):M==="Array"&&!I[w(N)]&&(I[w(N)]=!0,E(N,b,O,I))}}},plugins:{},highlightAll:function(E,S){l.highlightAllUnder(document,E,S)},highlightAllUnder:function(E,S,b){var A={callback:b,container:E,selector:'code[class*="language-"], [class*="language-"] code, code[class*="lang-"], [class*="lang-"] code'};l.hooks.run("before-highlightall",A),A.elements=Array.prototype.slice.apply(A.container.querySelectorAll(A.selector)),l.hooks.run("before-all-elements-highlight",A);for(var I=0,w;w=A.elements[I++];)l.highlightElement(w,S===!0,A.callback)},highlightElement:function(E,S,b){var A=l.util.getLanguage(E),I=l.languages[A];l.util.setLanguage(E,A);var w=E.parentElement;w&&w.nodeName.toLowerCase()==="pre"&&l.util.setLanguage(w,A);var O=E.textContent,N={element:E,language:A,grammar:I,code:O};function M(B){N.highlightedCode=B,l.hooks.run("before-insert",N),N.element.innerHTML=N.highlightedCode,l.hooks.run("after-highlight",N),l.hooks.run("complete",N),b&&b.call(N.element)}if(l.hooks.run("before-sanity-check",N),w=N.element.parentElement,w&&w.nodeName.toLowerCase()==="pre"&&!w.hasAttribute("tabindex")&&w.setAttribute("tabindex","0"),!N.code){l.hooks.run("complete",N),b&&b.call(N.element);return}if(l.hooks.run("before-highlight",N),!N.grammar){M(l.util.encode(N.code));return}if(S&&n.Worker){var L=new Worker(l.filename);L.onmessage=function(B){M(B.data)},L.postMessage(JSON.stringify({language:N.language,code:N.code,immediateClose:!0}))}else M(l.highlight(N.code,N.grammar,N.language))},highlight:function(E,S,b){var A={code:E,grammar:S,language:b};if(l.hooks.run("before-tokenize",A),!A.grammar)throw new Error('The language "'+A.language+'" has no grammar.');return A.tokens=l.tokenize(A.code,A.grammar),l.hooks.run("after-tokenize",A),o.stringify(l.util.encode(A.tokens),A.language)},tokenize:function(E,S){var b=S.rest;if(b){for(var A in b)S[A]=b[A];delete S.rest}var I=new p;return h(I,I.head,E),f(E,I,S,I.head,0),m(I)},hooks:{all:{},add:function(E,S){var b=l.hooks.all;b[E]=b[E]||[],b[E].push(S)},run:function(E,S){var b=l.hooks.all[E];if(!(!b||!b.length))for(var A=0,I;I=b[A++];)I(S)}},Token:o};n.Prism=l;function o(E,S,b,A){this.type=E,this.content=S,this.alias=b,this.length=(A||"").length|0}o.stringify=function E(S,b){if(typeof S=="string")return S;if(Array.isArray(S)){var A="";return S.forEach(function(M){A+=E(M,b)}),A}var I={type:S.type,content:E(S.content,b),tag:"span",classes:["token",S.type],attributes:{},language:b},w=S.alias;w&&(Array.isArray(w)?Array.prototype.push.apply(I.classes,w):I.classes.push(w)),l.hooks.run("wrap",I);var O="";for(var N in I.attributes)O+=" "+N+'="'+(I.attributes[N]||"").replace(/"/g,"&quot;")+'"';return"<"+I.tag+' class="'+I.classes.join(" ")+'"'+O+">"+I.content+"</"+I.tag+">"};function u(E,S,b,A){E.lastIndex=S;var I=E.exec(b);if(I&&A&&I[1]){var w=I[1].length;I.index+=w,I[0]=I[0].slice(w)}return I}function f(E,S,b,A,I,w){for(var O in b)if(!(!b.hasOwnProperty(O)||!b[O])){var N=b[O];N=Array.isArray(N)?N:[N];for(var M=0;M<N.length;++M){if(w&&w.cause==O+","+M)return;var L=N[M],B=L.inside,H=!!L.lookbehind,z=!!L.greedy,R=L.alias;if(z&&!L.pattern.global){var x=L.pattern.toString().match(/[imsuy]*$/)[0];L.pattern=RegExp(L.pattern.source,x+"g")}for(var W=L.pattern||L,q=A.next,j=I;q!==S.tail&&!(w&&j>=w.reach);j+=q.value.length,q=q.next){var G=q.value;if(S.length>E.length)return;if(!(G instanceof o)){var Q=1,Y;if(z){if(Y=u(W,j,E,H),!Y||Y.index>=E.length)break;var ue=Y.index,te=Y.index+Y[0].length,fe=j;for(fe+=q.value.length;ue>=fe;)q=q.next,fe+=q.value.length;if(fe-=q.value.length,j=fe,q.value instanceof o)continue;for(var se=q;se!==S.tail&&(fe<te||typeof se.value=="string");se=se.next)Q++,fe+=se.value.length;Q--,G=E.slice(j,fe),Y.index-=j}else if(Y=u(W,0,G,H),!Y)continue;var ue=Y.index,ce=Y[0],le=G.slice(0,ue),he=G.slice(ue+ce.length),Re=j+G.length;w&&Re>w.reach&&(w.reach=Re);var ae=q.prev;le&&(ae=h(S,ae,le),j+=le.length),g(S,ae,Q);var Ve=new o(O,B?l.tokenize(ce,B):ce,R,ce);if(q=h(S,ae,Ve),he&&h(S,q,he),Q>1){var Te={cause:O+","+M,reach:Re};f(E,S,b,q.prev,j,Te),w&&Te.reach>w.reach&&(w.reach=Te.reach)}}}}}}function p(){var E={value:null,prev:null,next:null},S={value:null,prev:E,next:null};E.next=S,this.head=E,this.tail=S,this.length=0}function h(E,S,b){var A=S.next,I={value:b,prev:S,next:A};return S.next=I,A.prev=I,E.length++,I}function g(E,S,b){for(var A=S.next,I=0;I<b&&A!==E.tail;I++)A=A.next;S.next=A,A.prev=S,E.length-=I}function m(E){for(var S=[],b=E.head.next;b!==E.tail;)S.push(b.value),b=b.next;return S}if(!n.document)return n.addEventListener&&(l.disableWorkerMessageHandler||n.addEventListener("message",function(E){var S=JSON.parse(E.data),b=S.language,A=S.code,I=S.immediateClose;n.postMessage(l.highlight(A,l.languages[b],b)),I&&n.close()},!1)),l;var v=l.util.currentScript();v&&(l.filename=v.src,v.hasAttribute("data-manual")&&(l.manual=!0));function T(){l.manual||l.highlightAll()}if(!l.manual){var C=document.readyState;C==="loading"||C==="interactive"&&v&&v.defer?document.addEventListener("DOMContentLoaded",T):window.requestAnimationFrame?window.requestAnimationFrame(T):window.setTimeout(T,16)}return l}(e);s.exports&&(s.exports=t),typeof Hr<"u"&&(Hr.Prism=t),t.languages.markup={comment:{pattern:/<!--(?:(?!<!--)[\s\S])*?-->/,greedy:!0},prolog:{pattern:/<\?[\s\S]+?\?>/,greedy:!0},doctype:{pattern:/<!DOCTYPE(?:[^>"'[\]]|"[^"]*"|'[^']*')+(?:\[(?:[^<"'\]]|"[^"]*"|'[^']*'|<(?!!--)|<!--(?:[^-]|-(?!->))*-->)*\]\s*)?>/i,greedy:!0,inside:{"internal-subset":{pattern:/(^[^\[]*\[)[\s\S]+(?=\]>$)/,lookbehind:!0,greedy:!0,inside:null},string:{pattern:/"[^"]*"|'[^']*'/,greedy:!0},punctuation:/^<!|>$|[[\]]/,"doctype-tag":/^DOCTYPE/i,name:/[^\s<>'"]+/}},cdata:{pattern:/<!\[CDATA\[[\s\S]*?\]\]>/i,greedy:!0},tag:{pattern:/<\/?(?!\d)[^\s>\/=$<%]+(?:\s(?:\s*[^\s>\/=]+(?:\s*=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+(?=[\s>]))|(?=[\s/>])))+)?\s*\/?>/,greedy:!0,inside:{tag:{pattern:/^<\/?[^\s>\/]+/,inside:{punctuation:/^<\/?/,namespace:/^[^\s>\/:]+:/}},"special-attr":[],"attr-value":{pattern:/=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+)/,inside:{punctuation:[{pattern:/^=/,alias:"attr-equals"},{pattern:/^(\s*)["']|["']$/,lookbehind:!0}]}},punctuation:/\/?>/,"attr-name":{pattern:/[^\s>\/]+/,inside:{namespace:/^[^\s>\/:]+:/}}}},entity:[{pattern:/&[\da-z]{1,8};/i,alias:"named-entity"},/&#x?[\da-f]{1,8};/i]},t.languages.markup.tag.inside["attr-value"].inside.entity=t.languages.markup.entity,t.languages.markup.doctype.inside["internal-subset"].inside=t.languages.markup,t.hooks.add("wrap",function(n){n.type==="entity"&&(n.attributes.title=n.content.replace(/&amp;/,"&"))}),Object.defineProperty(t.languages.markup.tag,"addInlined",{value:function(r,i){var a={};a["language-"+i]={pattern:/(^<!\[CDATA\[)[\s\S]+?(?=\]\]>$)/i,lookbehind:!0,inside:t.languages[i]},a.cdata=/^<!\[CDATA\[|\]\]>$/i;var l={"included-cdata":{pattern:/<!\[CDATA\[[\s\S]*?\]\]>/i,inside:a}};l["language-"+i]={pattern:/[\s\S]+/,inside:t.languages[i]};var o={};o[r]={pattern:RegExp(/(<__[^>]*>)(?:<!\[CDATA\[(?:[^\]]|\](?!\]>))*\]\]>|(?!<!\[CDATA\[)[\s\S])*?(?=<\/__>)/.source.replace(/__/g,function(){return r}),"i"),lookbehind:!0,greedy:!0,inside:l},t.languages.insertBefore("markup","cdata",o)}}),Object.defineProperty(t.languages.markup.tag,"addAttribute",{value:function(n,r){t.languages.markup.tag.inside["special-attr"].push({pattern:RegExp(/(^|["'\s])/.source+"(?:"+n+")"+/\s*=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+(?=[\s>]))/.source,"i"),lookbehind:!0,inside:{"attr-name":/^[^\s=]+/,"attr-value":{pattern:/=[\s\S]+/,inside:{value:{pattern:/(^=\s*(["']|(?!["'])))\S[\s\S]*(?=\2$)/,lookbehind:!0,alias:[r,"language-"+r],inside:t.languages[r]},punctuation:[{pattern:/^=/,alias:"attr-equals"},/"|'/]}}}})}}),t.languages.html=t.languages.markup,t.languages.mathml=t.languages.markup,t.languages.svg=t.languages.markup,t.languages.xml=t.languages.extend("markup",{}),t.languages.ssml=t.languages.xml,t.languages.atom=t.languages.xml,t.languages.rss=t.languages.xml,function(n){var r=/(?:"(?:\\(?:\r\n|[\s\S])|[^"\\\r\n])*"|'(?:\\(?:\r\n|[\s\S])|[^'\\\r\n])*')/;n.languages.css={comment:/\/\*[\s\S]*?\*\//,atrule:{pattern:RegExp("@[\\w-](?:"+/[^;{\s"']|\s+(?!\s)/.source+"|"+r.source+")*?"+/(?:;|(?=\s*\{))/.source),inside:{rule:/^@[\w-]+/,"selector-function-argument":{pattern:/(\bselector\s*\(\s*(?![\s)]))(?:[^()\s]|\s+(?![\s)])|\((?:[^()]|\([^()]*\))*\))+(?=\s*\))/,lookbehind:!0,alias:"selector"},keyword:{pattern:/(^|[^\w-])(?:and|not|only|or)(?![\w-])/,lookbehind:!0}}},url:{pattern:RegExp("\\burl\\((?:"+r.source+"|"+/(?:[^\\\r\n()"']|\\[\s\S])*/.source+")\\)","i"),greedy:!0,inside:{function:/^url/i,punctuation:/^\(|\)$/,string:{pattern:RegExp("^"+r.source+"$"),alias:"url"}}},selector:{pattern:RegExp(`(^|[{}\\s])[^{}\\s](?:[^{};"'\\s]|\\s+(?![\\s{])|`+r.source+")*(?=\\s*\\{)"),lookbehind:!0},string:{pattern:r,greedy:!0},property:{pattern:/(^|[^-\w\xA0-\uFFFF])(?!\s)[-_a-z\xA0-\uFFFF](?:(?!\s)[-\w\xA0-\uFFFF])*(?=\s*:)/i,lookbehind:!0},important:/!important\b/i,function:{pattern:/(^|[^-a-z0-9])[-a-z0-9]+(?=\()/i,lookbehind:!0},punctuation:/[(){};:,]/},n.languages.css.atrule.inside.rest=n.languages.css;var i=n.languages.markup;i&&(i.tag.addInlined("style","css"),i.tag.addAttribute("style","css"))}(t),t.languages.clike={comment:[{pattern:/(^|[^\\])\/\*[\s\S]*?(?:\*\/|$)/,lookbehind:!0,greedy:!0},{pattern:/(^|[^\\:])\/\/.*/,lookbehind:!0,greedy:!0}],string:{pattern:/(["'])(?:\\(?:\r\n|[\s\S])|(?!\1)[^\\\r\n])*\1/,greedy:!0},"class-name":{pattern:/(\b(?:class|extends|implements|instanceof|interface|new|trait)\s+|\bcatch\s+\()[\w.\\]+/i,lookbehind:!0,inside:{punctuation:/[.\\]/}},keyword:/\b(?:break|catch|continue|do|else|finally|for|function|if|in|instanceof|new|null|return|throw|try|while)\b/,boolean:/\b(?:false|true)\b/,function:/\b\w+(?=\()/,number:/\b0x[\da-f]+\b|(?:\b\d+(?:\.\d*)?|\B\.\d+)(?:e[+-]?\d+)?/i,operator:/[<>]=?|[!=]=?=?|--?|\+\+?|&&?|\|\|?|[?*/~^%]/,punctuation:/[{}[\];(),.:]/},t.languages.javascript=t.languages.extend("clike",{"class-name":[t.languages.clike["class-name"],{pattern:/(^|[^$\w\xA0-\uFFFF])(?!\s)[_$A-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\.(?:constructor|prototype))/,lookbehind:!0}],keyword:[{pattern:/((?:^|\})\s*)catch\b/,lookbehind:!0},{pattern:/(^|[^.]|\.\.\.\s*)\b(?:as|assert(?=\s*\{)|async(?=\s*(?:function\b|\(|[$\w\xA0-\uFFFF]|$))|await|break|case|class|const|continue|debugger|default|delete|do|else|enum|export|extends|finally(?=\s*(?:\{|$))|for|from(?=\s*(?:['"]|$))|function|(?:get|set)(?=\s*(?:[#\[$\w\xA0-\uFFFF]|$))|if|implements|import|in|instanceof|interface|let|new|null|of|package|private|protected|public|return|static|super|switch|this|throw|try|typeof|undefined|var|void|while|with|yield)\b/,lookbehind:!0}],function:/#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*(?:\.\s*(?:apply|bind|call)\s*)?\()/,number:{pattern:RegExp(/(^|[^\w$])/.source+"(?:"+(/NaN|Infinity/.source+"|"+/0[bB][01]+(?:_[01]+)*n?/.source+"|"+/0[oO][0-7]+(?:_[0-7]+)*n?/.source+"|"+/0[xX][\dA-Fa-f]+(?:_[\dA-Fa-f]+)*n?/.source+"|"+/\d+(?:_\d+)*n/.source+"|"+/(?:\d+(?:_\d+)*(?:\.(?:\d+(?:_\d+)*)?)?|\.\d+(?:_\d+)*)(?:[Ee][+-]?\d+(?:_\d+)*)?/.source)+")"+/(?![\w$])/.source),lookbehind:!0},operator:/--|\+\+|\*\*=?|=>|&&=?|\|\|=?|[!=]==|<<=?|>>>?=?|[-+*/%&|^!=<>]=?|\.{3}|\?\?=?|\?\.?|[~:]/}),t.languages.javascript["class-name"][0].pattern=/(\b(?:class|extends|implements|instanceof|interface|new)\s+)[\w.\\]+/,t.languages.insertBefore("javascript","keyword",{regex:{pattern:RegExp(/((?:^|[^$\w\xA0-\uFFFF."'\])\s]|\b(?:return|yield))\s*)/.source+/\//.source+"(?:"+/(?:\[(?:[^\]\\\r\n]|\\.)*\]|\\.|[^/\\\[\r\n])+\/[dgimyus]{0,7}/.source+"|"+/(?:\[(?:[^[\]\\\r\n]|\\.|\[(?:[^[\]\\\r\n]|\\.|\[(?:[^[\]\\\r\n]|\\.)*\])*\])*\]|\\.|[^/\\\[\r\n])+\/[dgimyus]{0,7}v[dgimyus]{0,7}/.source+")"+/(?=(?:\s|\/\*(?:[^*]|\*(?!\/))*\*\/)*(?:$|[\r\n,.;:})\]]|\/\/))/.source),lookbehind:!0,greedy:!0,inside:{"regex-source":{pattern:/^(\/)[\s\S]+(?=\/[a-z]*$)/,lookbehind:!0,alias:"language-regex",inside:t.languages.regex},"regex-delimiter":/^\/|\/$/,"regex-flags":/^[a-z]+$/}},"function-variable":{pattern:/#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*[=:]\s*(?:async\s*)?(?:\bfunction\b|(?:\((?:[^()]|\([^()]*\))*\)|(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*)\s*=>))/,alias:"function"},parameter:[{pattern:/(function(?:\s+(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*)?\s*\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\))/,lookbehind:!0,inside:t.languages.javascript},{pattern:/(^|[^$\w\xA0-\uFFFF])(?!\s)[_$a-z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*=>)/i,lookbehind:!0,inside:t.languages.javascript},{pattern:/(\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\)\s*=>)/,lookbehind:!0,inside:t.languages.javascript},{pattern:/((?:\b|\s|^)(?!(?:as|async|await|break|case|catch|class|const|continue|debugger|default|delete|do|else|enum|export|extends|finally|for|from|function|get|if|implements|import|in|instanceof|interface|let|new|null|of|package|private|protected|public|return|set|static|super|switch|this|throw|try|typeof|undefined|var|void|while|with|yield)(?![$\w\xA0-\uFFFF]))(?:(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*\s*)\(\s*|\]\s*\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\)\s*\{)/,lookbehind:!0,inside:t.languages.javascript}],constant:/\b[A-Z](?:[A-Z_]|\dx?)*\b/}),t.languages.insertBefore("javascript","string",{hashbang:{pattern:/^#!.*/,greedy:!0,alias:"comment"},"template-string":{pattern:/`(?:\\[\s\S]|\$\{(?:[^{}]|\{(?:[^{}]|\{[^}]*\})*\})+\}|(?!\$\{)[^\\`])*`/,greedy:!0,inside:{"template-punctuation":{pattern:/^`|`$/,alias:"string"},interpolation:{pattern:/((?:^|[^\\])(?:\\{2})*)\$\{(?:[^{}]|\{(?:[^{}]|\{[^}]*\})*\})+\}/,lookbehind:!0,inside:{"interpolation-punctuation":{pattern:/^\$\{|\}$/,alias:"punctuation"},rest:t.languages.javascript}},string:/[\s\S]+/}},"string-property":{pattern:/((?:^|[,{])[ \t]*)(["'])(?:\\(?:\r\n|[\s\S])|(?!\2)[^\\\r\n])*\2(?=\s*:)/m,lookbehind:!0,greedy:!0,alias:"property"}}),t.languages.insertBefore("javascript","operator",{"literal-property":{pattern:/((?:^|[,{])[ \t]*)(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*:)/m,lookbehind:!0,alias:"property"}}),t.languages.markup&&(t.languages.markup.tag.addInlined("script","javascript"),t.languages.markup.tag.addAttribute(/on(?:abort|blur|change|click|composition(?:end|start|update)|dblclick|error|focus(?:in|out)?|key(?:down|up)|load|mouse(?:down|enter|leave|move|out|over|up)|reset|resize|scroll|select|slotchange|submit|unload|wheel)/.source,"javascript")),t.languages.js=t.languages.javascript,function(){if(typeof t>"u"||typeof document>"u")return;Element.prototype.matches||(Element.prototype.matches=Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector);var n="Loadingâ€¦",r=function(v,T){return"âœ– Error "+v+" while fetching file: "+T},i="âœ– Error: File does not exist or is empty",a={js:"javascript",py:"python",rb:"ruby",ps1:"powershell",psm1:"powershell",sh:"bash",bat:"batch",h:"c",tex:"latex"},l="data-src-status",o="loading",u="loaded",f="failed",p="pre[data-src]:not(["+l+'="'+u+'"]):not(['+l+'="'+o+'"])';function h(v,T,C){var E=new XMLHttpRequest;E.open("GET",v,!0),E.onreadystatechange=function(){E.readyState==4&&(E.status<400&&E.responseText?T(E.responseText):E.status>=400?C(r(E.status,E.statusText)):C(i))},E.send(null)}function g(v){var T=/^\s*(\d+)\s*(?:(,)\s*(?:(\d+)\s*)?)?$/.exec(v||"");if(T){var C=Number(T[1]),E=T[2],S=T[3];return E?S?[C,Number(S)]:[C,void 0]:[C,C]}}t.hooks.add("before-highlightall",function(v){v.selector+=", "+p}),t.hooks.add("before-sanity-check",function(v){var T=v.element;if(T.matches(p)){v.code="",T.setAttribute(l,o);var C=T.appendChild(document.createElement("CODE"));C.textContent=n;var E=T.getAttribute("data-src"),S=v.language;if(S==="none"){var b=(/\.(\w+)$/.exec(E)||[,"none"])[1];S=a[b]||b}t.util.setLanguage(C,S),t.util.setLanguage(T,S);var A=t.plugins.autoloader;A&&A.loadLanguages(S),h(E,function(I){T.setAttribute(l,u);var w=g(T.getAttribute("data-range"));if(w){var O=I.split(/\r\n?|\n/g),N=w[0],M=w[1]==null?O.length:w[1];N<0&&(N+=O.length),N=Math.max(0,Math.min(N-1,O.length)),M<0&&(M+=O.length),M=Math.max(0,Math.min(M,O.length)),I=O.slice(N,M).join(`
`),T.hasAttribute("data-start")||T.setAttribute("data-start",String(N+1))}C.textContent=I,t.highlightElement(C)},function(I){T.setAttribute(l,f),C.textContent=I})}}),t.plugins.fileHighlight={highlight:function(T){for(var C=(T||document).querySelectorAll(p),E=0,S;S=C[E++];)t.highlightElement(S)}};var m=!1;t.fileHighlight=function(){m||(console.warn("Prism.fileHighlight is deprecated. Use `Prism.plugins.fileHighlight.highlight` instead."),m=!0),t.plugins.fileHighlight.highlight.apply(this,arguments)}}()})(Ea);var Oc=Ea.exports;const Bn=Dc(Oc);/*! @license DOMPurify 3.3.0 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.3.0/LICENSE */const{entries:Ta,setPrototypeOf:Gr,isFrozen:Nc,getPrototypeOf:Rc,getOwnPropertyDescriptor:Pc}=Object;let{freeze:Ct,seal:qt,create:ir}=Object,{apply:lr,construct:ar}=typeof Reflect<"u"&&Reflect;Ct||(Ct=function(e){return e});qt||(qt=function(e){return e});lr||(lr=function(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];return e.apply(t,r)});ar||(ar=function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return new e(...n)});const fn=It(Array.prototype.forEach),Fc=It(Array.prototype.lastIndexOf),Wr=It(Array.prototype.pop),Ws=It(Array.prototype.push),Lc=It(Array.prototype.splice),yn=It(String.prototype.toLowerCase),Vn=It(String.prototype.toString),zn=It(String.prototype.match),Ys=It(String.prototype.replace),Mc=It(String.prototype.indexOf),xc=It(String.prototype.trim),Ht=It(Object.prototype.hasOwnProperty),Tt=It(RegExp.prototype.test),Xs=Uc(TypeError);function It(s){return function(e){e instanceof RegExp&&(e.lastIndex=0);for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return lr(s,e,n)}}function Uc(s){return function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return ar(s,t)}}function Oe(s,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:yn;Gr&&Gr(s,null);let n=e.length;for(;n--;){let r=e[n];if(typeof r=="string"){const i=t(r);i!==r&&(Nc(e)||(e[n]=i),r=i)}s[r]=!0}return s}function Bc(s){for(let e=0;e<s.length;e++)Ht(s,e)||(s[e]=null);return s}function cs(s){const e=ir(null);for(const[t,n]of Ta(s))Ht(s,t)&&(Array.isArray(n)?e[t]=Bc(n):n&&typeof n=="object"&&n.constructor===Object?e[t]=cs(n):e[t]=n);return e}function Zs(s,e){for(;s!==null;){const n=Pc(s,e);if(n){if(n.get)return It(n.get);if(typeof n.value=="function")return It(n.value)}s=Rc(s)}function t(){return null}return t}const Yr=Ct(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","search","section","select","shadow","slot","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),qn=Ct(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","enterkeyhint","exportparts","filter","font","g","glyph","glyphref","hkern","image","inputmode","line","lineargradient","marker","mask","metadata","mpath","part","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),jn=Ct(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),Vc=Ct(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),Hn=Ct(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),zc=Ct(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),Xr=Ct(["#text"]),Zr=Ct(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","exportparts","face","for","headers","height","hidden","high","href","hreflang","id","inert","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","part","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","slot","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),Gn=Ct(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","mask-type","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),Kr=Ct(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),dn=Ct(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),qc=qt(/\{\{[\w\W]*|[\w\W]*\}\}/gm),jc=qt(/<%[\w\W]*|[\w\W]*%>/gm),Hc=qt(/\$\{[\w\W]*/gm),Gc=qt(/^data-[\-\w.\u00B7-\uFFFF]+$/),Wc=qt(/^aria-[\-\w]+$/),Sa=qt(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp|matrix):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),Yc=qt(/^(?:\w+script|data):/i),Xc=qt(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),Aa=qt(/^html$/i),Zc=qt(/^[a-z][.\w]*(-[.\w]+)+$/i);var Qr=Object.freeze({__proto__:null,ARIA_ATTR:Wc,ATTR_WHITESPACE:Xc,CUSTOM_ELEMENT:Zc,DATA_ATTR:Gc,DOCTYPE_NAME:Aa,ERB_EXPR:jc,IS_ALLOWED_URI:Sa,IS_SCRIPT_OR_DATA:Yc,MUSTACHE_EXPR:qc,TMPLIT_EXPR:Hc});const Ks={element:1,text:3,progressingInstruction:7,comment:8,document:9},Kc=function(){return typeof window>"u"?null:window},Qc=function(e,t){if(typeof e!="object"||typeof e.createPolicy!="function")return null;let n=null;const r="data-tt-policy-suffix";t&&t.hasAttribute(r)&&(n=t.getAttribute(r));const i="dompurify"+(n?"#"+n:"");try{return e.createPolicy(i,{createHTML(a){return a},createScriptURL(a){return a}})}catch{return console.warn("TrustedTypes policy "+i+" could not be created."),null}},Jr=function(){return{afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}};function Ca(){let s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Kc();const e=ge=>Ca(ge);if(e.version="3.3.0",e.removed=[],!s||!s.document||s.document.nodeType!==Ks.document||!s.Element)return e.isSupported=!1,e;let{document:t}=s;const n=t,r=n.currentScript,{DocumentFragment:i,HTMLTemplateElement:a,Node:l,Element:o,NodeFilter:u,NamedNodeMap:f=s.NamedNodeMap||s.MozNamedAttrMap,HTMLFormElement:p,DOMParser:h,trustedTypes:g}=s,m=o.prototype,v=Zs(m,"cloneNode"),T=Zs(m,"remove"),C=Zs(m,"nextSibling"),E=Zs(m,"childNodes"),S=Zs(m,"parentNode");if(typeof a=="function"){const ge=t.createElement("template");ge.content&&ge.content.ownerDocument&&(t=ge.content.ownerDocument)}let b,A="";const{implementation:I,createNodeIterator:w,createDocumentFragment:O,getElementsByTagName:N}=t,{importNode:M}=n;let L=Jr();e.isSupported=typeof Ta=="function"&&typeof S=="function"&&I&&I.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:B,ERB_EXPR:H,TMPLIT_EXPR:z,DATA_ATTR:R,ARIA_ATTR:x,IS_SCRIPT_OR_DATA:W,ATTR_WHITESPACE:q,CUSTOM_ELEMENT:j}=Qr;let{IS_ALLOWED_URI:G}=Qr,Q=null;const Y=Oe({},[...Yr,...qn,...jn,...Hn,...Xr]);let te=null;const fe=Oe({},[...Zr,...Gn,...Kr,...dn]);let se=Object.seal(ir(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),ue=null,ce=null;const le=Object.seal(ir(null,{tagCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeCheck:{writable:!0,configurable:!1,enumerable:!0,value:null}}));let he=!0,Re=!0,ae=!1,Ve=!0,Te=!1,re=!0,J=!1,oe=!1,ye=!1,_e=!1,we=!1,xe=!1,et=!0,Ke=!1;const Pe="user-content-";let je=!0,pt=!1,ft={},nt=null;const yt=Oe({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let Ut=null;const rt=Oe({},["audio","video","img","source","image","track"]);let ve=null;const ee=Oe({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),be="http://www.w3.org/1998/Math/MathML",wt="http://www.w3.org/2000/svg",qe="http://www.w3.org/1999/xhtml";let Qe=qe,Bt=!1,Mt=null;const Dt=Oe({},[be,wt,qe],Vn);let xt=Oe({},["mi","mo","mn","ms","mtext"]),dt=Oe({},["annotation-xml"]);const is=Oe({},["title","style","font","a","script"]);let Xe=null;const Jt=["application/xhtml+xml","text/html"],_s="text/html";let Se=null,Je=null;const Rs=t.createElement("form"),bs=function(U){return U instanceof RegExp||U instanceof Function},bt=function(){let U=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(Je&&Je===U)){if((!U||typeof U!="object")&&(U={}),U=cs(U),Xe=Jt.indexOf(U.PARSER_MEDIA_TYPE)===-1?_s:U.PARSER_MEDIA_TYPE,Se=Xe==="application/xhtml+xml"?Vn:yn,Q=Ht(U,"ALLOWED_TAGS")?Oe({},U.ALLOWED_TAGS,Se):Y,te=Ht(U,"ALLOWED_ATTR")?Oe({},U.ALLOWED_ATTR,Se):fe,Mt=Ht(U,"ALLOWED_NAMESPACES")?Oe({},U.ALLOWED_NAMESPACES,Vn):Dt,ve=Ht(U,"ADD_URI_SAFE_ATTR")?Oe(cs(ee),U.ADD_URI_SAFE_ATTR,Se):ee,Ut=Ht(U,"ADD_DATA_URI_TAGS")?Oe(cs(rt),U.ADD_DATA_URI_TAGS,Se):rt,nt=Ht(U,"FORBID_CONTENTS")?Oe({},U.FORBID_CONTENTS,Se):yt,ue=Ht(U,"FORBID_TAGS")?Oe({},U.FORBID_TAGS,Se):cs({}),ce=Ht(U,"FORBID_ATTR")?Oe({},U.FORBID_ATTR,Se):cs({}),ft=Ht(U,"USE_PROFILES")?U.USE_PROFILES:!1,he=U.ALLOW_ARIA_ATTR!==!1,Re=U.ALLOW_DATA_ATTR!==!1,ae=U.ALLOW_UNKNOWN_PROTOCOLS||!1,Ve=U.ALLOW_SELF_CLOSE_IN_ATTR!==!1,Te=U.SAFE_FOR_TEMPLATES||!1,re=U.SAFE_FOR_XML!==!1,J=U.WHOLE_DOCUMENT||!1,_e=U.RETURN_DOM||!1,we=U.RETURN_DOM_FRAGMENT||!1,xe=U.RETURN_TRUSTED_TYPE||!1,ye=U.FORCE_BODY||!1,et=U.SANITIZE_DOM!==!1,Ke=U.SANITIZE_NAMED_PROPS||!1,je=U.KEEP_CONTENT!==!1,pt=U.IN_PLACE||!1,G=U.ALLOWED_URI_REGEXP||Sa,Qe=U.NAMESPACE||qe,xt=U.MATHML_TEXT_INTEGRATION_POINTS||xt,dt=U.HTML_INTEGRATION_POINTS||dt,se=U.CUSTOM_ELEMENT_HANDLING||{},U.CUSTOM_ELEMENT_HANDLING&&bs(U.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(se.tagNameCheck=U.CUSTOM_ELEMENT_HANDLING.tagNameCheck),U.CUSTOM_ELEMENT_HANDLING&&bs(U.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(se.attributeNameCheck=U.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),U.CUSTOM_ELEMENT_HANDLING&&typeof U.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(se.allowCustomizedBuiltInElements=U.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),Te&&(Re=!1),we&&(_e=!0),ft&&(Q=Oe({},Xr),te=[],ft.html===!0&&(Oe(Q,Yr),Oe(te,Zr)),ft.svg===!0&&(Oe(Q,qn),Oe(te,Gn),Oe(te,dn)),ft.svgFilters===!0&&(Oe(Q,jn),Oe(te,Gn),Oe(te,dn)),ft.mathMl===!0&&(Oe(Q,Hn),Oe(te,Kr),Oe(te,dn))),U.ADD_TAGS&&(typeof U.ADD_TAGS=="function"?le.tagCheck=U.ADD_TAGS:(Q===Y&&(Q=cs(Q)),Oe(Q,U.ADD_TAGS,Se))),U.ADD_ATTR&&(typeof U.ADD_ATTR=="function"?le.attributeCheck=U.ADD_ATTR:(te===fe&&(te=cs(te)),Oe(te,U.ADD_ATTR,Se))),U.ADD_URI_SAFE_ATTR&&Oe(ve,U.ADD_URI_SAFE_ATTR,Se),U.FORBID_CONTENTS&&(nt===yt&&(nt=cs(nt)),Oe(nt,U.FORBID_CONTENTS,Se)),je&&(Q["#text"]=!0),J&&Oe(Q,["html","head","body"]),Q.table&&(Oe(Q,["tbody"]),delete ue.tbody),U.TRUSTED_TYPES_POLICY){if(typeof U.TRUSTED_TYPES_POLICY.createHTML!="function")throw Xs('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof U.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw Xs('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');b=U.TRUSTED_TYPES_POLICY,A=b.createHTML("")}else b===void 0&&(b=Qc(g,r)),b!==null&&typeof A=="string"&&(A=b.createHTML(""));Ct&&Ct(U),Je=U}},jt=Oe({},[...qn,...jn,...Vc]),ks=Oe({},[...Hn,...zc]),an=function(U){let ie=S(U);(!ie||!ie.tagName)&&(ie={namespaceURI:Qe,tagName:"template"});const pe=yn(U.tagName),Ze=yn(ie.tagName);return Mt[U.namespaceURI]?U.namespaceURI===wt?ie.namespaceURI===qe?pe==="svg":ie.namespaceURI===be?pe==="svg"&&(Ze==="annotation-xml"||xt[Ze]):!!jt[pe]:U.namespaceURI===be?ie.namespaceURI===qe?pe==="math":ie.namespaceURI===wt?pe==="math"&&dt[Ze]:!!ks[pe]:U.namespaceURI===qe?ie.namespaceURI===wt&&!dt[Ze]||ie.namespaceURI===be&&!xt[Ze]?!1:!ks[pe]&&(is[pe]||!jt[pe]):!!(Xe==="application/xhtml+xml"&&Mt[U.namespaceURI]):!1},Et=function(U){Ws(e.removed,{element:U});try{S(U).removeChild(U)}catch{T(U)}},$t=function(U,ie){try{Ws(e.removed,{attribute:ie.getAttributeNode(U),from:ie})}catch{Ws(e.removed,{attribute:null,from:ie})}if(ie.removeAttribute(U),U==="is")if(_e||we)try{Et(ie)}catch{}else try{ie.setAttribute(U,"")}catch{}},ys=function(U){let ie=null,pe=null;if(ye)U="<remove></remove>"+U;else{const it=zn(U,/^[\r\n\t ]+/);pe=it&&it[0]}Xe==="application/xhtml+xml"&&Qe===qe&&(U='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+U+"</body></html>");const Ze=b?b.createHTML(U):U;if(Qe===qe)try{ie=new h().parseFromString(Ze,Xe)}catch{}if(!ie||!ie.documentElement){ie=I.createDocument(Qe,"template",null);try{ie.documentElement.innerHTML=Bt?A:Ze}catch{}}const kt=ie.body||ie.documentElement;return U&&pe&&kt.insertBefore(t.createTextNode(pe),kt.childNodes[0]||null),Qe===qe?N.call(ie,J?"html":"body")[0]:J?ie.documentElement:kt},zs=function(U){return w.call(U.ownerDocument||U,U,u.SHOW_ELEMENT|u.SHOW_COMMENT|u.SHOW_TEXT|u.SHOW_PROCESSING_INSTRUCTION|u.SHOW_CDATA_SECTION,null)},hs=function(U){return U instanceof p&&(typeof U.nodeName!="string"||typeof U.textContent!="string"||typeof U.removeChild!="function"||!(U.attributes instanceof f)||typeof U.removeAttribute!="function"||typeof U.setAttribute!="function"||typeof U.namespaceURI!="string"||typeof U.insertBefore!="function"||typeof U.hasChildNodes!="function")},ws=function(U){return typeof l=="function"&&U instanceof l};function Vt(ge,U,ie){fn(ge,pe=>{pe.call(e,U,ie,Je)})}const Es=function(U){let ie=null;if(Vt(L.beforeSanitizeElements,U,null),hs(U))return Et(U),!0;const pe=Se(U.nodeName);if(Vt(L.uponSanitizeElement,U,{tagName:pe,allowedTags:Q}),re&&U.hasChildNodes()&&!ws(U.firstElementChild)&&Tt(/<[/\w!]/g,U.innerHTML)&&Tt(/<[/\w!]/g,U.textContent)||U.nodeType===Ks.progressingInstruction||re&&U.nodeType===Ks.comment&&Tt(/<[/\w]/g,U.data))return Et(U),!0;if(!(le.tagCheck instanceof Function&&le.tagCheck(pe))&&(!Q[pe]||ue[pe])){if(!ue[pe]&&qs(pe)&&(se.tagNameCheck instanceof RegExp&&Tt(se.tagNameCheck,pe)||se.tagNameCheck instanceof Function&&se.tagNameCheck(pe)))return!1;if(je&&!nt[pe]){const Ze=S(U)||U.parentNode,kt=E(U)||U.childNodes;if(kt&&Ze){const it=kt.length;for(let Ot=it-1;Ot>=0;--Ot){const ls=v(kt[Ot],!0);ls.__removalCount=(U.__removalCount||0)+1,Ze.insertBefore(ls,C(U))}}}return Et(U),!0}return U instanceof o&&!an(U)||(pe==="noscript"||pe==="noembed"||pe==="noframes")&&Tt(/<\/no(script|embed|frames)/i,U.innerHTML)?(Et(U),!0):(Te&&U.nodeType===Ks.text&&(ie=U.textContent,fn([B,H,z],Ze=>{ie=Ys(ie,Ze," ")}),U.textContent!==ie&&(Ws(e.removed,{element:U.cloneNode()}),U.textContent=ie)),Vt(L.afterSanitizeElements,U,null),!1)},Ts=function(U,ie,pe){if(et&&(ie==="id"||ie==="name")&&(pe in t||pe in Rs))return!1;if(!(Re&&!ce[ie]&&Tt(R,ie))){if(!(he&&Tt(x,ie))){if(!(le.attributeCheck instanceof Function&&le.attributeCheck(ie,U))){if(!te[ie]||ce[ie]){if(!(qs(U)&&(se.tagNameCheck instanceof RegExp&&Tt(se.tagNameCheck,U)||se.tagNameCheck instanceof Function&&se.tagNameCheck(U))&&(se.attributeNameCheck instanceof RegExp&&Tt(se.attributeNameCheck,ie)||se.attributeNameCheck instanceof Function&&se.attributeNameCheck(ie,U))||ie==="is"&&se.allowCustomizedBuiltInElements&&(se.tagNameCheck instanceof RegExp&&Tt(se.tagNameCheck,pe)||se.tagNameCheck instanceof Function&&se.tagNameCheck(pe))))return!1}else if(!ve[ie]){if(!Tt(G,Ys(pe,q,""))){if(!((ie==="src"||ie==="xlink:href"||ie==="href")&&U!=="script"&&Mc(pe,"data:")===0&&Ut[U])){if(!(ae&&!Tt(W,Ys(pe,q,"")))){if(pe)return!1}}}}}}}return!0},qs=function(U){return U!=="annotation-xml"&&zn(U,j)},Ss=function(U){Vt(L.beforeSanitizeAttributes,U,null);const{attributes:ie}=U;if(!ie||hs(U))return;const pe={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:te,forceKeepAttr:void 0};let Ze=ie.length;for(;Ze--;){const kt=ie[Ze],{name:it,namespaceURI:Ot,value:ls}=kt,Fs=Se(it),Ln=ls;let gt=it==="value"?Ln:xc(Ln);if(pe.attrName=Fs,pe.attrValue=gt,pe.keepAttr=!0,pe.forceKeepAttr=void 0,Vt(L.uponSanitizeAttribute,U,pe),gt=pe.attrValue,Ke&&(Fs==="id"||Fs==="name")&&($t(it,U),gt=Pe+gt),re&&Tt(/((--!?|])>)|<\/(style|title|textarea)/i,gt)){$t(it,U);continue}if(Fs==="attributename"&&zn(gt,"href")){$t(it,U);continue}if(pe.forceKeepAttr)continue;if(!pe.keepAttr){$t(it,U);continue}if(!Ve&&Tt(/\/>/i,gt)){$t(it,U);continue}Te&&fn([B,H,z],Nr=>{gt=Ys(gt,Nr," ")});const Or=Se(U.nodeName);if(!Ts(Or,Fs,gt)){$t(it,U);continue}if(b&&typeof g=="object"&&typeof g.getAttributeType=="function"&&!Ot)switch(g.getAttributeType(Or,Fs)){case"TrustedHTML":{gt=b.createHTML(gt);break}case"TrustedScriptURL":{gt=b.createScriptURL(gt);break}}if(gt!==Ln)try{Ot?U.setAttributeNS(Ot,it,gt):U.setAttribute(it,gt),hs(U)?Et(U):Wr(e.removed)}catch{$t(it,U)}}Vt(L.afterSanitizeAttributes,U,null)},Ps=function ge(U){let ie=null;const pe=zs(U);for(Vt(L.beforeSanitizeShadowDOM,U,null);ie=pe.nextNode();)Vt(L.uponSanitizeShadowNode,ie,null),Es(ie),Ss(ie),ie.content instanceof i&&ge(ie.content);Vt(L.afterSanitizeShadowDOM,U,null)};return e.sanitize=function(ge){let U=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},ie=null,pe=null,Ze=null,kt=null;if(Bt=!ge,Bt&&(ge="<!-->"),typeof ge!="string"&&!ws(ge))if(typeof ge.toString=="function"){if(ge=ge.toString(),typeof ge!="string")throw Xs("dirty is not a string, aborting")}else throw Xs("toString is not a function");if(!e.isSupported)return ge;if(oe||bt(U),e.removed=[],typeof ge=="string"&&(pt=!1),pt){if(ge.nodeName){const ls=Se(ge.nodeName);if(!Q[ls]||ue[ls])throw Xs("root node is forbidden and cannot be sanitized in-place")}}else if(ge instanceof l)ie=ys("<!---->"),pe=ie.ownerDocument.importNode(ge,!0),pe.nodeType===Ks.element&&pe.nodeName==="BODY"||pe.nodeName==="HTML"?ie=pe:ie.appendChild(pe);else{if(!_e&&!Te&&!J&&ge.indexOf("<")===-1)return b&&xe?b.createHTML(ge):ge;if(ie=ys(ge),!ie)return _e?null:xe?A:""}ie&&ye&&Et(ie.firstChild);const it=zs(pt?ge:ie);for(;Ze=it.nextNode();)Es(Ze),Ss(Ze),Ze.content instanceof i&&Ps(Ze.content);if(pt)return ge;if(_e){if(we)for(kt=O.call(ie.ownerDocument);ie.firstChild;)kt.appendChild(ie.firstChild);else kt=ie;return(te.shadowroot||te.shadowrootmode)&&(kt=M.call(n,kt,!0)),kt}let Ot=J?ie.outerHTML:ie.innerHTML;return J&&Q["!doctype"]&&ie.ownerDocument&&ie.ownerDocument.doctype&&ie.ownerDocument.doctype.name&&Tt(Aa,ie.ownerDocument.doctype.name)&&(Ot="<!DOCTYPE "+ie.ownerDocument.doctype.name+`>
`+Ot),Te&&fn([B,H,z],ls=>{Ot=Ys(Ot,ls," ")}),b&&xe?b.createHTML(Ot):Ot},e.setConfig=function(){let ge=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};bt(ge),oe=!0},e.clearConfig=function(){Je=null,oe=!1},e.isValidAttribute=function(ge,U,ie){Je||bt({});const pe=Se(ge),Ze=Se(U);return Ts(pe,Ze,ie)},e.addHook=function(ge,U){typeof U=="function"&&Ws(L[ge],U)},e.removeHook=function(ge,U){if(U!==void 0){const ie=Fc(L[ge],U);return ie===-1?void 0:Lc(L[ge],ie,1)[0]}return Wr(L[ge])},e.removeHooks=function(ge){L[ge]=[]},e.removeAllHooks=function(){L=Jr()},e}var Jc=Ca();Prism.languages.javascript=Prism.languages.extend("clike",{"class-name":[Prism.languages.clike["class-name"],{pattern:/(^|[^$\w\xA0-\uFFFF])(?!\s)[_$A-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\.(?:constructor|prototype))/,lookbehind:!0}],keyword:[{pattern:/((?:^|\})\s*)catch\b/,lookbehind:!0},{pattern:/(^|[^.]|\.\.\.\s*)\b(?:as|assert(?=\s*\{)|async(?=\s*(?:function\b|\(|[$\w\xA0-\uFFFF]|$))|await|break|case|class|const|continue|debugger|default|delete|do|else|enum|export|extends|finally(?=\s*(?:\{|$))|for|from(?=\s*(?:['"]|$))|function|(?:get|set)(?=\s*(?:[#\[$\w\xA0-\uFFFF]|$))|if|implements|import|in|instanceof|interface|let|new|null|of|package|private|protected|public|return|static|super|switch|this|throw|try|typeof|undefined|var|void|while|with|yield)\b/,lookbehind:!0}],function:/#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*(?:\.\s*(?:apply|bind|call)\s*)?\()/,number:{pattern:RegExp(/(^|[^\w$])/.source+"(?:"+(/NaN|Infinity/.source+"|"+/0[bB][01]+(?:_[01]+)*n?/.source+"|"+/0[oO][0-7]+(?:_[0-7]+)*n?/.source+"|"+/0[xX][\dA-Fa-f]+(?:_[\dA-Fa-f]+)*n?/.source+"|"+/\d+(?:_\d+)*n/.source+"|"+/(?:\d+(?:_\d+)*(?:\.(?:\d+(?:_\d+)*)?)?|\.\d+(?:_\d+)*)(?:[Ee][+-]?\d+(?:_\d+)*)?/.source)+")"+/(?![\w$])/.source),lookbehind:!0},operator:/--|\+\+|\*\*=?|=>|&&=?|\|\|=?|[!=]==|<<=?|>>>?=?|[-+*/%&|^!=<>]=?|\.{3}|\?\?=?|\?\.?|[~:]/});Prism.languages.javascript["class-name"][0].pattern=/(\b(?:class|extends|implements|instanceof|interface|new)\s+)[\w.\\]+/;Prism.languages.insertBefore("javascript","keyword",{regex:{pattern:RegExp(/((?:^|[^$\w\xA0-\uFFFF."'\])\s]|\b(?:return|yield))\s*)/.source+/\//.source+"(?:"+/(?:\[(?:[^\]\\\r\n]|\\.)*\]|\\.|[^/\\\[\r\n])+\/[dgimyus]{0,7}/.source+"|"+/(?:\[(?:[^[\]\\\r\n]|\\.|\[(?:[^[\]\\\r\n]|\\.|\[(?:[^[\]\\\r\n]|\\.)*\])*\])*\]|\\.|[^/\\\[\r\n])+\/[dgimyus]{0,7}v[dgimyus]{0,7}/.source+")"+/(?=(?:\s|\/\*(?:[^*]|\*(?!\/))*\*\/)*(?:$|[\r\n,.;:})\]]|\/\/))/.source),lookbehind:!0,greedy:!0,inside:{"regex-source":{pattern:/^(\/)[\s\S]+(?=\/[a-z]*$)/,lookbehind:!0,alias:"language-regex",inside:Prism.languages.regex},"regex-delimiter":/^\/|\/$/,"regex-flags":/^[a-z]+$/}},"function-variable":{pattern:/#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*[=:]\s*(?:async\s*)?(?:\bfunction\b|(?:\((?:[^()]|\([^()]*\))*\)|(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*)\s*=>))/,alias:"function"},parameter:[{pattern:/(function(?:\s+(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*)?\s*\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\))/,lookbehind:!0,inside:Prism.languages.javascript},{pattern:/(^|[^$\w\xA0-\uFFFF])(?!\s)[_$a-z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*=>)/i,lookbehind:!0,inside:Prism.languages.javascript},{pattern:/(\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\)\s*=>)/,lookbehind:!0,inside:Prism.languages.javascript},{pattern:/((?:\b|\s|^)(?!(?:as|async|await|break|case|catch|class|const|continue|debugger|default|delete|do|else|enum|export|extends|finally|for|from|function|get|if|implements|import|in|instanceof|interface|let|new|null|of|package|private|protected|public|return|set|static|super|switch|this|throw|try|typeof|undefined|var|void|while|with|yield)(?![$\w\xA0-\uFFFF]))(?:(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*\s*)\(\s*|\]\s*\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\)\s*\{)/,lookbehind:!0,inside:Prism.languages.javascript}],constant:/\b[A-Z](?:[A-Z_]|\dx?)*\b/});Prism.languages.insertBefore("javascript","string",{hashbang:{pattern:/^#!.*/,greedy:!0,alias:"comment"},"template-string":{pattern:/`(?:\\[\s\S]|\$\{(?:[^{}]|\{(?:[^{}]|\{[^}]*\})*\})+\}|(?!\$\{)[^\\`])*`/,greedy:!0,inside:{"template-punctuation":{pattern:/^`|`$/,alias:"string"},interpolation:{pattern:/((?:^|[^\\])(?:\\{2})*)\$\{(?:[^{}]|\{(?:[^{}]|\{[^}]*\})*\})+\}/,lookbehind:!0,inside:{"interpolation-punctuation":{pattern:/^\$\{|\}$/,alias:"punctuation"},rest:Prism.languages.javascript}},string:/[\s\S]+/}},"string-property":{pattern:/((?:^|[,{])[ \t]*)(["'])(?:\\(?:\r\n|[\s\S])|(?!\2)[^\\\r\n])*\2(?=\s*:)/m,lookbehind:!0,greedy:!0,alias:"property"}});Prism.languages.insertBefore("javascript","operator",{"literal-property":{pattern:/((?:^|[,{])[ \t]*)(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*:)/m,lookbehind:!0,alias:"property"}});Prism.languages.markup&&(Prism.languages.markup.tag.addInlined("script","javascript"),Prism.languages.markup.tag.addAttribute(/on(?:abort|blur|change|click|composition(?:end|start|update)|dblclick|error|focus(?:in|out)?|key(?:down|up)|load|mouse(?:down|enter|leave|move|out|over|up)|reset|resize|scroll|select|slotchange|submit|unload|wheel)/.source,"javascript"));Prism.languages.js=Prism.languages.javascript;(function(s){s.languages.typescript=s.languages.extend("javascript",{"class-name":{pattern:/(\b(?:class|extends|implements|instanceof|interface|new|type)\s+)(?!keyof\b)(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?:\s*<(?:[^<>]|<(?:[^<>]|<[^<>]*>)*>)*>)?/,lookbehind:!0,greedy:!0,inside:null},builtin:/\b(?:Array|Function|Promise|any|boolean|console|never|number|string|symbol|unknown)\b/}),s.languages.typescript.keyword.push(/\b(?:abstract|declare|is|keyof|readonly|require)\b/,/\b(?:asserts|infer|interface|module|namespace|type)\b(?=\s*(?:[{_$a-zA-Z\xA0-\uFFFF]|$))/,/\btype\b(?=\s*(?:[\{*]|$))/),delete s.languages.typescript.parameter,delete s.languages.typescript["literal-property"];var e=s.languages.extend("typescript",{});delete e["class-name"],s.languages.typescript["class-name"].inside=e,s.languages.insertBefore("typescript","function",{decorator:{pattern:/@[$\w\xA0-\uFFFF]+/,inside:{at:{pattern:/^@/,alias:"operator"},function:/^[\s\S]+/}},"generic-function":{pattern:/#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*\s*<(?:[^<>]|<(?:[^<>]|<[^<>]*>)*>)*>(?=\s*\()/,greedy:!0,inside:{function:/^#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*/,generic:{pattern:/<[\s\S]+/,alias:"class-name",inside:e}}}}),s.languages.ts=s.languages.typescript})(Prism);Prism.languages.python={comment:{pattern:/(^|[^\\])#.*/,lookbehind:!0,greedy:!0},"string-interpolation":{pattern:/(?:f|fr|rf)(?:("""|''')[\s\S]*?\1|("|')(?:\\.|(?!\2)[^\\\r\n])*\2)/i,greedy:!0,inside:{interpolation:{pattern:/((?:^|[^{])(?:\{\{)*)\{(?!\{)(?:[^{}]|\{(?!\{)(?:[^{}]|\{(?!\{)(?:[^{}])+\})+\})+\}/,lookbehind:!0,inside:{"format-spec":{pattern:/(:)[^:(){}]+(?=\}$)/,lookbehind:!0},"conversion-option":{pattern:/![sra](?=[:}]$)/,alias:"punctuation"},rest:null}},string:/[\s\S]+/}},"triple-quoted-string":{pattern:/(?:[rub]|br|rb)?("""|''')[\s\S]*?\1/i,greedy:!0,alias:"string"},string:{pattern:/(?:[rub]|br|rb)?("|')(?:\\.|(?!\1)[^\\\r\n])*\1/i,greedy:!0},function:{pattern:/((?:^|\s)def[ \t]+)[a-zA-Z_]\w*(?=\s*\()/g,lookbehind:!0},"class-name":{pattern:/(\bclass\s+)\w+/i,lookbehind:!0},decorator:{pattern:/(^[\t ]*)@\w+(?:\.\w+)*/m,lookbehind:!0,alias:["annotation","punctuation"],inside:{punctuation:/\./}},keyword:/\b(?:_(?=\s*:)|and|as|assert|async|await|break|case|class|continue|def|del|elif|else|except|exec|finally|for|from|global|if|import|in|is|lambda|match|nonlocal|not|or|pass|print|raise|return|try|while|with|yield)\b/,builtin:/\b(?:__import__|abs|all|any|apply|ascii|basestring|bin|bool|buffer|bytearray|bytes|callable|chr|classmethod|cmp|coerce|compile|complex|delattr|dict|dir|divmod|enumerate|eval|execfile|file|filter|float|format|frozenset|getattr|globals|hasattr|hash|help|hex|id|input|int|intern|isinstance|issubclass|iter|len|list|locals|long|map|max|memoryview|min|next|object|oct|open|ord|pow|property|range|raw_input|reduce|reload|repr|reversed|round|set|setattr|slice|sorted|staticmethod|str|sum|super|tuple|type|unichr|unicode|vars|xrange|zip)\b/,boolean:/\b(?:False|None|True)\b/,number:/\b0(?:b(?:_?[01])+|o(?:_?[0-7])+|x(?:_?[a-f0-9])+)\b|(?:\b\d+(?:_\d+)*(?:\.(?:\d+(?:_\d+)*)?)?|\B\.\d+(?:_\d+)*)(?:e[+-]?\d+(?:_\d+)*)?j?(?!\w)/i,operator:/[-+%=]=?|!=|:=|\*\*?=?|\/\/?=?|<[<=>]?|>[=>]?|[&|^~]/,punctuation:/[{}[\];(),.:]/};Prism.languages.python["string-interpolation"].inside.interpolation.inside.rest=Prism.languages.python;Prism.languages.py=Prism.languages.python;(function(s){var e=/\b(?:abstract|assert|boolean|break|byte|case|catch|char|class|const|continue|default|do|double|else|enum|exports|extends|final|finally|float|for|goto|if|implements|import|instanceof|int|interface|long|module|native|new|non-sealed|null|open|opens|package|permits|private|protected|provides|public|record(?!\s*[(){}[\]<>=%~.:,;?+\-*/&|^])|requires|return|sealed|short|static|strictfp|super|switch|synchronized|this|throw|throws|to|transient|transitive|try|uses|var|void|volatile|while|with|yield)\b/,t=/(?:[a-z]\w*\s*\.\s*)*(?:[A-Z]\w*\s*\.\s*)*/.source,n={pattern:RegExp(/(^|[^\w.])/.source+t+/[A-Z](?:[\d_A-Z]*[a-z]\w*)?\b/.source),lookbehind:!0,inside:{namespace:{pattern:/^[a-z]\w*(?:\s*\.\s*[a-z]\w*)*(?:\s*\.)?/,inside:{punctuation:/\./}},punctuation:/\./}};s.languages.java=s.languages.extend("clike",{string:{pattern:/(^|[^\\])"(?:\\.|[^"\\\r\n])*"/,lookbehind:!0,greedy:!0},"class-name":[n,{pattern:RegExp(/(^|[^\w.])/.source+t+/[A-Z]\w*(?=\s+\w+\s*[;,=()]|\s*(?:\[[\s,]*\]\s*)?::\s*new\b)/.source),lookbehind:!0,inside:n.inside},{pattern:RegExp(/(\b(?:class|enum|extends|implements|instanceof|interface|new|record|throws)\s+)/.source+t+/[A-Z]\w*\b/.source),lookbehind:!0,inside:n.inside}],keyword:e,function:[s.languages.clike.function,{pattern:/(::\s*)[a-z_]\w*/,lookbehind:!0}],number:/\b0b[01][01_]*L?\b|\b0x(?:\.[\da-f_p+-]+|[\da-f_]+(?:\.[\da-f_p+-]+)?)\b|(?:\b\d[\d_]*(?:\.[\d_]*)?|\B\.\d[\d_]*)(?:e[+-]?\d[\d_]*)?[dfl]?/i,operator:{pattern:/(^|[^.])(?:<<=?|>>>?=?|->|--|\+\+|&&|\|\||::|[?:~]|[-+*/%&|^!=<>]=?)/m,lookbehind:!0},constant:/\b[A-Z][A-Z_\d]+\b/}),s.languages.insertBefore("java","string",{"triple-quoted-string":{pattern:/"""[ \t]*[\r\n](?:(?:"|"")?(?:\\.|[^"\\]))*"""/,greedy:!0,alias:"string"},char:{pattern:/'(?:\\.|[^'\\\r\n]){1,6}'/,greedy:!0}}),s.languages.insertBefore("java","class-name",{annotation:{pattern:/(^|[^.])@\w+(?:\s*\.\s*\w+)*/,lookbehind:!0,alias:"punctuation"},generics:{pattern:/<(?:[\w\s,.?]|&(?!&)|<(?:[\w\s,.?]|&(?!&)|<(?:[\w\s,.?]|&(?!&)|<(?:[\w\s,.?]|&(?!&))*>)*>)*>)*>/,inside:{"class-name":n,keyword:e,punctuation:/[<>(),.:]/,operator:/[?&|]/}},import:[{pattern:RegExp(/(\bimport\s+)/.source+t+/(?:[A-Z]\w*|\*)(?=\s*;)/.source),lookbehind:!0,inside:{namespace:n.inside.namespace,punctuation:/\./,operator:/\*/,"class-name":/\w+/}},{pattern:RegExp(/(\bimport\s+static\s+)/.source+t+/(?:\w+|\*)(?=\s*;)/.source),lookbehind:!0,alias:"static",inside:{namespace:n.inside.namespace,static:/\b\w+$/,punctuation:/\./,operator:/\*/,"class-name":/\w+/}}],namespace:{pattern:RegExp(/(\b(?:exports|import(?:\s+static)?|module|open|opens|package|provides|requires|to|transitive|uses|with)\s+)(?!<keyword>)[a-z]\w*(?:\.[a-z]\w*)*\.?/.source.replace(/<keyword>/g,function(){return e.source})),lookbehind:!0,inside:{punctuation:/\./}}})})(Prism);Prism.languages.c=Prism.languages.extend("clike",{comment:{pattern:/\/\/(?:[^\r\n\\]|\\(?:\r\n?|\n|(?![\r\n])))*|\/\*[\s\S]*?(?:\*\/|$)/,greedy:!0},string:{pattern:/"(?:\\(?:\r\n|[\s\S])|[^"\\\r\n])*"/,greedy:!0},"class-name":{pattern:/(\b(?:enum|struct)\s+(?:__attribute__\s*\(\([\s\S]*?\)\)\s*)?)\w+|\b[a-z]\w*_t\b/,lookbehind:!0},keyword:/\b(?:_Alignas|_Alignof|_Atomic|_Bool|_Complex|_Generic|_Imaginary|_Noreturn|_Static_assert|_Thread_local|__attribute__|asm|auto|break|case|char|const|continue|default|do|double|else|enum|extern|float|for|goto|if|inline|int|long|register|return|short|signed|sizeof|static|struct|switch|typedef|typeof|union|unsigned|void|volatile|while)\b/,function:/\b[a-z_]\w*(?=\s*\()/i,number:/(?:\b0x(?:[\da-f]+(?:\.[\da-f]*)?|\.[\da-f]+)(?:p[+-]?\d+)?|(?:\b\d+(?:\.\d*)?|\B\.\d+)(?:e[+-]?\d+)?)[ful]{0,4}/i,operator:/>>=?|<<=?|->|([-+&|:])\1|[?:~]|[-+*/%&|^!=<>]=?/});Prism.languages.insertBefore("c","string",{char:{pattern:/'(?:\\(?:\r\n|[\s\S])|[^'\\\r\n]){0,32}'/,greedy:!0}});Prism.languages.insertBefore("c","string",{macro:{pattern:/(^[\t ]*)#\s*[a-z](?:[^\r\n\\/]|\/(?!\*)|\/\*(?:[^*]|\*(?!\/))*\*\/|\\(?:\r\n|[\s\S]))*/im,lookbehind:!0,greedy:!0,alias:"property",inside:{string:[{pattern:/^(#\s*include\s*)<[^>]+>/,lookbehind:!0},Prism.languages.c.string],char:Prism.languages.c.char,comment:Prism.languages.c.comment,"macro-name":[{pattern:/(^#\s*define\s+)\w+\b(?!\()/i,lookbehind:!0},{pattern:/(^#\s*define\s+)\w+\b(?=\()/i,lookbehind:!0,alias:"function"}],directive:{pattern:/^(#\s*)[a-z]+/,lookbehind:!0,alias:"keyword"},"directive-hash":/^#/,punctuation:/##|\\(?=[\r\n])/,expression:{pattern:/\S[\s\S]*/,inside:Prism.languages.c}}}});Prism.languages.insertBefore("c","function",{constant:/\b(?:EOF|NULL|SEEK_CUR|SEEK_END|SEEK_SET|__DATE__|__FILE__|__LINE__|__TIMESTAMP__|__TIME__|__func__|stderr|stdin|stdout)\b/});delete Prism.languages.c.boolean;(function(s){var e=/\b(?:alignas|alignof|asm|auto|bool|break|case|catch|char|char16_t|char32_t|char8_t|class|co_await|co_return|co_yield|compl|concept|const|const_cast|consteval|constexpr|constinit|continue|decltype|default|delete|do|double|dynamic_cast|else|enum|explicit|export|extern|final|float|for|friend|goto|if|import|inline|int|int16_t|int32_t|int64_t|int8_t|long|module|mutable|namespace|new|noexcept|nullptr|operator|override|private|protected|public|register|reinterpret_cast|requires|return|short|signed|sizeof|static|static_assert|static_cast|struct|switch|template|this|thread_local|throw|try|typedef|typeid|typename|uint16_t|uint32_t|uint64_t|uint8_t|union|unsigned|using|virtual|void|volatile|wchar_t|while)\b/,t=/\b(?!<keyword>)\w+(?:\s*\.\s*\w+)*\b/.source.replace(/<keyword>/g,function(){return e.source});s.languages.cpp=s.languages.extend("c",{"class-name":[{pattern:RegExp(/(\b(?:class|concept|enum|struct|typename)\s+)(?!<keyword>)\w+/.source.replace(/<keyword>/g,function(){return e.source})),lookbehind:!0},/\b[A-Z]\w*(?=\s*::\s*\w+\s*\()/,/\b[A-Z_]\w*(?=\s*::\s*~\w+\s*\()/i,/\b\w+(?=\s*<(?:[^<>]|<(?:[^<>]|<[^<>]*>)*>)*>\s*::\s*\w+\s*\()/],keyword:e,number:{pattern:/(?:\b0b[01']+|\b0x(?:[\da-f']+(?:\.[\da-f']*)?|\.[\da-f']+)(?:p[+-]?[\d']+)?|(?:\b[\d']+(?:\.[\d']*)?|\B\.[\d']+)(?:e[+-]?[\d']+)?)[ful]{0,4}/i,greedy:!0},operator:/>>=?|<<=?|->|--|\+\+|&&|\|\||[?:~]|<=>|[-+*/%&|^!=<>]=?|\b(?:and|and_eq|bitand|bitor|not|not_eq|or|or_eq|xor|xor_eq)\b/,boolean:/\b(?:false|true)\b/}),s.languages.insertBefore("cpp","string",{module:{pattern:RegExp(/(\b(?:import|module)\s+)/.source+"(?:"+/"(?:\\(?:\r\n|[\s\S])|[^"\\\r\n])*"|<[^<>\r\n]*>/.source+"|"+/<mod-name>(?:\s*:\s*<mod-name>)?|:\s*<mod-name>/.source.replace(/<mod-name>/g,function(){return t})+")"),lookbehind:!0,greedy:!0,inside:{string:/^[<"][\s\S]+/,operator:/:/,punctuation:/\./}},"raw-string":{pattern:/R"([^()\\ ]{0,16})\([\s\S]*?\)\1"/,alias:"string",greedy:!0}}),s.languages.insertBefore("cpp","keyword",{"generic-function":{pattern:/\b(?!operator\b)[a-z_]\w*\s*<(?:[^<>]|<[^<>]*>)*>(?=\s*\()/i,inside:{function:/^\w+/,generic:{pattern:/<[\s\S]+/,alias:"class-name",inside:s.languages.cpp}}}}),s.languages.insertBefore("cpp","operator",{"double-colon":{pattern:/::/,alias:"punctuation"}}),s.languages.insertBefore("cpp","class-name",{"base-clause":{pattern:/(\b(?:class|struct)\s+\w+\s*:\s*)[^;{}"'\s]+(?:\s+[^;{}"'\s]+)*(?=\s*[;{])/,lookbehind:!0,greedy:!0,inside:s.languages.extend("cpp",{})}}),s.languages.insertBefore("inside","double-colon",{"class-name":/\b[a-z_]\w*\b(?!\s*::)/i},s.languages.cpp["base-clause"])})(Prism);(function(s){function e(j,G){return j.replace(/<<(\d+)>>/g,function(Q,Y){return"(?:"+G[+Y]+")"})}function t(j,G,Q){return RegExp(e(j,G),"")}function n(j,G){for(var Q=0;Q<G;Q++)j=j.replace(/<<self>>/g,function(){return"(?:"+j+")"});return j.replace(/<<self>>/g,"[^\\s\\S]")}var r={type:"bool byte char decimal double dynamic float int long object sbyte short string uint ulong ushort var void",typeDeclaration:"class enum interface record struct",contextual:"add alias and ascending async await by descending from(?=\\s*(?:\\w|$)) get global group into init(?=\\s*;) join let nameof not notnull on or orderby partial remove select set unmanaged value when where with(?=\\s*{)",other:"abstract as base break case catch checked const continue default delegate do else event explicit extern finally fixed for foreach goto if implicit in internal is lock namespace new null operator out override params private protected public readonly ref return sealed sizeof stackalloc static switch this throw try typeof unchecked unsafe using virtual volatile while yield"};function i(j){return"\\b(?:"+j.trim().replace(/ /g,"|")+")\\b"}var a=i(r.typeDeclaration),l=RegExp(i(r.type+" "+r.typeDeclaration+" "+r.contextual+" "+r.other)),o=i(r.typeDeclaration+" "+r.contextual+" "+r.other),u=i(r.type+" "+r.typeDeclaration+" "+r.other),f=n(/<(?:[^<>;=+\-*/%&|^]|<<self>>)*>/.source,2),p=n(/\((?:[^()]|<<self>>)*\)/.source,2),h=/@?\b[A-Za-z_]\w*\b/.source,g=e(/<<0>>(?:\s*<<1>>)?/.source,[h,f]),m=e(/(?!<<0>>)<<1>>(?:\s*\.\s*<<1>>)*/.source,[o,g]),v=/\[\s*(?:,\s*)*\]/.source,T=e(/<<0>>(?:\s*(?:\?\s*)?<<1>>)*(?:\s*\?)?/.source,[m,v]),C=e(/[^,()<>[\];=+\-*/%&|^]|<<0>>|<<1>>|<<2>>/.source,[f,p,v]),E=e(/\(<<0>>+(?:,<<0>>+)+\)/.source,[C]),S=e(/(?:<<0>>|<<1>>)(?:\s*(?:\?\s*)?<<2>>)*(?:\s*\?)?/.source,[E,m,v]),b={keyword:l,punctuation:/[<>()?,.:[\]]/},A=/'(?:[^\r\n'\\]|\\.|\\[Uux][\da-fA-F]{1,8})'/.source,I=/"(?:\\.|[^\\"\r\n])*"/.source,w=/@"(?:""|\\[\s\S]|[^\\"])*"(?!")/.source;s.languages.csharp=s.languages.extend("clike",{string:[{pattern:t(/(^|[^$\\])<<0>>/.source,[w]),lookbehind:!0,greedy:!0},{pattern:t(/(^|[^@$\\])<<0>>/.source,[I]),lookbehind:!0,greedy:!0}],"class-name":[{pattern:t(/(\busing\s+static\s+)<<0>>(?=\s*;)/.source,[m]),lookbehind:!0,inside:b},{pattern:t(/(\busing\s+<<0>>\s*=\s*)<<1>>(?=\s*;)/.source,[h,S]),lookbehind:!0,inside:b},{pattern:t(/(\busing\s+)<<0>>(?=\s*=)/.source,[h]),lookbehind:!0},{pattern:t(/(\b<<0>>\s+)<<1>>/.source,[a,g]),lookbehind:!0,inside:b},{pattern:t(/(\bcatch\s*\(\s*)<<0>>/.source,[m]),lookbehind:!0,inside:b},{pattern:t(/(\bwhere\s+)<<0>>/.source,[h]),lookbehind:!0},{pattern:t(/(\b(?:is(?:\s+not)?|as)\s+)<<0>>/.source,[T]),lookbehind:!0,inside:b},{pattern:t(/\b<<0>>(?=\s+(?!<<1>>|with\s*\{)<<2>>(?:\s*[=,;:{)\]]|\s+(?:in|when)\b))/.source,[S,u,h]),inside:b}],keyword:l,number:/(?:\b0(?:x[\da-f_]*[\da-f]|b[01_]*[01])|(?:\B\.\d+(?:_+\d+)*|\b\d+(?:_+\d+)*(?:\.\d+(?:_+\d+)*)?)(?:e[-+]?\d+(?:_+\d+)*)?)(?:[dflmu]|lu|ul)?\b/i,operator:/>>=?|<<=?|[-=]>|([-+&|])\1|~|\?\?=?|[-+*/%&|^!=<>]=?/,punctuation:/\?\.?|::|[{}[\];(),.:]/}),s.languages.insertBefore("csharp","number",{range:{pattern:/\.\./,alias:"operator"}}),s.languages.insertBefore("csharp","punctuation",{"named-parameter":{pattern:t(/([(,]\s*)<<0>>(?=\s*:)/.source,[h]),lookbehind:!0,alias:"punctuation"}}),s.languages.insertBefore("csharp","class-name",{namespace:{pattern:t(/(\b(?:namespace|using)\s+)<<0>>(?:\s*\.\s*<<0>>)*(?=\s*[;{])/.source,[h]),lookbehind:!0,inside:{punctuation:/\./}},"type-expression":{pattern:t(/(\b(?:default|sizeof|typeof)\s*\(\s*(?!\s))(?:[^()\s]|\s(?!\s)|<<0>>)*(?=\s*\))/.source,[p]),lookbehind:!0,alias:"class-name",inside:b},"return-type":{pattern:t(/<<0>>(?=\s+(?:<<1>>\s*(?:=>|[({]|\.\s*this\s*\[)|this\s*\[))/.source,[S,m]),inside:b,alias:"class-name"},"constructor-invocation":{pattern:t(/(\bnew\s+)<<0>>(?=\s*[[({])/.source,[S]),lookbehind:!0,inside:b,alias:"class-name"},"generic-method":{pattern:t(/<<0>>\s*<<1>>(?=\s*\()/.source,[h,f]),inside:{function:t(/^<<0>>/.source,[h]),generic:{pattern:RegExp(f),alias:"class-name",inside:b}}},"type-list":{pattern:t(/\b((?:<<0>>\s+<<1>>|record\s+<<1>>\s*<<5>>|where\s+<<2>>)\s*:\s*)(?:<<3>>|<<4>>|<<1>>\s*<<5>>|<<6>>)(?:\s*,\s*(?:<<3>>|<<4>>|<<6>>))*(?=\s*(?:where|[{;]|=>|$))/.source,[a,g,h,S,l.source,p,/\bnew\s*\(\s*\)/.source]),lookbehind:!0,inside:{"record-arguments":{pattern:t(/(^(?!new\s*\()<<0>>\s*)<<1>>/.source,[g,p]),lookbehind:!0,greedy:!0,inside:s.languages.csharp},keyword:l,"class-name":{pattern:RegExp(S),greedy:!0,inside:b},punctuation:/[,()]/}},preprocessor:{pattern:/(^[\t ]*)#.*/m,lookbehind:!0,alias:"property",inside:{directive:{pattern:/(#)\b(?:define|elif|else|endif|endregion|error|if|line|nullable|pragma|region|undef|warning)\b/,lookbehind:!0,alias:"keyword"}}}});var O=I+"|"+A,N=e(/\/(?![*/])|\/\/[^\r\n]*[\r\n]|\/\*(?:[^*]|\*(?!\/))*\*\/|<<0>>/.source,[O]),M=n(e(/[^"'/()]|<<0>>|\(<<self>>*\)/.source,[N]),2),L=/\b(?:assembly|event|field|method|module|param|property|return|type)\b/.source,B=e(/<<0>>(?:\s*\(<<1>>*\))?/.source,[m,M]);s.languages.insertBefore("csharp","class-name",{attribute:{pattern:t(/((?:^|[^\s\w>)?])\s*\[\s*)(?:<<0>>\s*:\s*)?<<1>>(?:\s*,\s*<<1>>)*(?=\s*\])/.source,[L,B]),lookbehind:!0,greedy:!0,inside:{target:{pattern:t(/^<<0>>(?=\s*:)/.source,[L]),alias:"keyword"},"attribute-arguments":{pattern:t(/\(<<0>>*\)/.source,[M]),inside:s.languages.csharp},"class-name":{pattern:RegExp(m),inside:{punctuation:/\./}},punctuation:/[:,]/}}});var H=/:[^}\r\n]+/.source,z=n(e(/[^"'/()]|<<0>>|\(<<self>>*\)/.source,[N]),2),R=e(/\{(?!\{)(?:(?![}:])<<0>>)*<<1>>?\}/.source,[z,H]),x=n(e(/[^"'/()]|\/(?!\*)|\/\*(?:[^*]|\*(?!\/))*\*\/|<<0>>|\(<<self>>*\)/.source,[O]),2),W=e(/\{(?!\{)(?:(?![}:])<<0>>)*<<1>>?\}/.source,[x,H]);function q(j,G){return{interpolation:{pattern:t(/((?:^|[^{])(?:\{\{)*)<<0>>/.source,[j]),lookbehind:!0,inside:{"format-string":{pattern:t(/(^\{(?:(?![}:])<<0>>)*)<<1>>(?=\}$)/.source,[G,H]),lookbehind:!0,inside:{punctuation:/^:/}},punctuation:/^\{|\}$/,expression:{pattern:/[\s\S]+/,alias:"language-csharp",inside:s.languages.csharp}}},string:/[\s\S]+/}}s.languages.insertBefore("csharp","string",{"interpolation-string":[{pattern:t(/(^|[^\\])(?:\$@|@\$)"(?:""|\\[\s\S]|\{\{|<<0>>|[^\\{"])*"/.source,[R]),lookbehind:!0,greedy:!0,inside:q(R,z)},{pattern:t(/(^|[^@\\])\$"(?:\\.|\{\{|<<0>>|[^\\"{])*"/.source,[W]),lookbehind:!0,greedy:!0,inside:q(W,x)}],char:{pattern:RegExp(A),greedy:!0}}),s.languages.dotnet=s.languages.cs=s.languages.csharp})(Prism);Prism.languages.go=Prism.languages.extend("clike",{string:{pattern:/(^|[^\\])"(?:\\.|[^"\\\r\n])*"|`[^`]*`/,lookbehind:!0,greedy:!0},keyword:/\b(?:break|case|chan|const|continue|default|defer|else|fallthrough|for|func|go(?:to)?|if|import|interface|map|package|range|return|select|struct|switch|type|var)\b/,boolean:/\b(?:_|false|iota|nil|true)\b/,number:[/\b0(?:b[01_]+|o[0-7_]+)i?\b/i,/\b0x(?:[a-f\d_]+(?:\.[a-f\d_]*)?|\.[a-f\d_]+)(?:p[+-]?\d+(?:_\d+)*)?i?(?!\w)/i,/(?:\b\d[\d_]*(?:\.[\d_]*)?|\B\.\d[\d_]*)(?:e[+-]?[\d_]+)?i?(?!\w)/i],operator:/[*\/%^!=]=?|\+[=+]?|-[=-]?|\|[=|]?|&(?:=|&|\^=?)?|>(?:>=?|=)?|<(?:<=?|=|-)?|:=|\.\.\./,builtin:/\b(?:append|bool|byte|cap|close|complex|complex(?:64|128)|copy|delete|error|float(?:32|64)|u?int(?:8|16|32|64)?|imag|len|make|new|panic|print(?:ln)?|real|recover|rune|string|uintptr)\b/});Prism.languages.insertBefore("go","string",{char:{pattern:/'(?:\\.|[^'\\\r\n]){0,10}'/,greedy:!0}});delete Prism.languages.go["class-name"];(function(s){for(var e=/\/\*(?:[^*/]|\*(?!\/)|\/(?!\*)|<self>)*\*\//.source,t=0;t<2;t++)e=e.replace(/<self>/g,function(){return e});e=e.replace(/<self>/g,function(){return/[^\s\S]/.source}),s.languages.rust={comment:[{pattern:RegExp(/(^|[^\\])/.source+e),lookbehind:!0,greedy:!0},{pattern:/(^|[^\\:])\/\/.*/,lookbehind:!0,greedy:!0}],string:{pattern:/b?"(?:\\[\s\S]|[^\\"])*"|b?r(#*)"(?:[^"]|"(?!\1))*"\1/,greedy:!0},char:{pattern:/b?'(?:\\(?:x[0-7][\da-fA-F]|u\{(?:[\da-fA-F]_*){1,6}\}|.)|[^\\\r\n\t'])'/,greedy:!0},attribute:{pattern:/#!?\[(?:[^\[\]"]|"(?:\\[\s\S]|[^\\"])*")*\]/,greedy:!0,alias:"attr-name",inside:{string:null}},"closure-params":{pattern:/([=(,:]\s*|\bmove\s*)\|[^|]*\||\|[^|]*\|(?=\s*(?:\{|->))/,lookbehind:!0,greedy:!0,inside:{"closure-punctuation":{pattern:/^\||\|$/,alias:"punctuation"},rest:null}},"lifetime-annotation":{pattern:/'\w+/,alias:"symbol"},"fragment-specifier":{pattern:/(\$\w+:)[a-z]+/,lookbehind:!0,alias:"punctuation"},variable:/\$\w+/,"function-definition":{pattern:/(\bfn\s+)\w+/,lookbehind:!0,alias:"function"},"type-definition":{pattern:/(\b(?:enum|struct|trait|type|union)\s+)\w+/,lookbehind:!0,alias:"class-name"},"module-declaration":[{pattern:/(\b(?:crate|mod)\s+)[a-z][a-z_\d]*/,lookbehind:!0,alias:"namespace"},{pattern:/(\b(?:crate|self|super)\s*)::\s*[a-z][a-z_\d]*\b(?:\s*::(?:\s*[a-z][a-z_\d]*\s*::)*)?/,lookbehind:!0,alias:"namespace",inside:{punctuation:/::/}}],keyword:[/\b(?:Self|abstract|as|async|await|become|box|break|const|continue|crate|do|dyn|else|enum|extern|final|fn|for|if|impl|in|let|loop|macro|match|mod|move|mut|override|priv|pub|ref|return|self|static|struct|super|trait|try|type|typeof|union|unsafe|unsized|use|virtual|where|while|yield)\b/,/\b(?:bool|char|f(?:32|64)|[ui](?:8|16|32|64|128|size)|str)\b/],function:/\b[a-z_]\w*(?=\s*(?:::\s*<|\())/,macro:{pattern:/\b\w+!/,alias:"property"},constant:/\b[A-Z_][A-Z_\d]+\b/,"class-name":/\b[A-Z]\w*\b/,namespace:{pattern:/(?:\b[a-z][a-z_\d]*\s*::\s*)*\b[a-z][a-z_\d]*\s*::(?!\s*<)/,inside:{punctuation:/::/}},number:/\b(?:0x[\dA-Fa-f](?:_?[\dA-Fa-f])*|0o[0-7](?:_?[0-7])*|0b[01](?:_?[01])*|(?:(?:\d(?:_?\d)*)?\.)?\d(?:_?\d)*(?:[Ee][+-]?\d+)?)(?:_?(?:f32|f64|[iu](?:8|16|32|64|size)?))?\b/,boolean:/\b(?:false|true)\b/,punctuation:/->|\.\.=|\.{1,3}|::|[{}[\];(),:]/,operator:/[-+*\/%!^]=?|=[=>]?|&[&=]?|\|[|=]?|<<?=?|>>?=?|[@?]/},s.languages.rust["closure-params"].inside.rest=s.languages.rust,s.languages.rust.attribute.inside.string=s.languages.rust.string})(Prism);(function(s){s.languages.ruby=s.languages.extend("clike",{comment:{pattern:/#.*|^=begin\s[\s\S]*?^=end/m,greedy:!0},"class-name":{pattern:/(\b(?:class|module)\s+|\bcatch\s+\()[\w.\\]+|\b[A-Z_]\w*(?=\s*\.\s*new\b)/,lookbehind:!0,inside:{punctuation:/[.\\]/}},keyword:/\b(?:BEGIN|END|alias|and|begin|break|case|class|def|define_method|defined|do|each|else|elsif|end|ensure|extend|for|if|in|include|module|new|next|nil|not|or|prepend|private|protected|public|raise|redo|require|rescue|retry|return|self|super|then|throw|undef|unless|until|when|while|yield)\b/,operator:/\.{2,3}|&\.|===|<?=>|[!=]?~|(?:&&|\|\||<<|>>|\*\*|[+\-*/%<>!^&|=])=?|[?:]/,punctuation:/[(){}[\].,;]/}),s.languages.insertBefore("ruby","operator",{"double-colon":{pattern:/::/,alias:"punctuation"}});var e={pattern:/((?:^|[^\\])(?:\\{2})*)#\{(?:[^{}]|\{[^{}]*\})*\}/,lookbehind:!0,inside:{content:{pattern:/^(#\{)[\s\S]+(?=\}$)/,lookbehind:!0,inside:s.languages.ruby},delimiter:{pattern:/^#\{|\}$/,alias:"punctuation"}}};delete s.languages.ruby.function;var t="(?:"+[/([^a-zA-Z0-9\s{(\[<=])(?:(?!\1)[^\\]|\\[\s\S])*\1/.source,/\((?:[^()\\]|\\[\s\S]|\((?:[^()\\]|\\[\s\S])*\))*\)/.source,/\{(?:[^{}\\]|\\[\s\S]|\{(?:[^{}\\]|\\[\s\S])*\})*\}/.source,/\[(?:[^\[\]\\]|\\[\s\S]|\[(?:[^\[\]\\]|\\[\s\S])*\])*\]/.source,/<(?:[^<>\\]|\\[\s\S]|<(?:[^<>\\]|\\[\s\S])*>)*>/.source].join("|")+")",n=/(?:"(?:\\.|[^"\\\r\n])*"|(?:\b[a-zA-Z_]\w*|[^\s\0-\x7F]+)[?!]?|\$.)/.source;s.languages.insertBefore("ruby","keyword",{"regex-literal":[{pattern:RegExp(/%r/.source+t+/[egimnosux]{0,6}/.source),greedy:!0,inside:{interpolation:e,regex:/[\s\S]+/}},{pattern:/(^|[^/])\/(?!\/)(?:\[[^\r\n\]]+\]|\\.|[^[/\\\r\n])+\/[egimnosux]{0,6}(?=\s*(?:$|[\r\n,.;})#]))/,lookbehind:!0,greedy:!0,inside:{interpolation:e,regex:/[\s\S]+/}}],variable:/[@$]+[a-zA-Z_]\w*(?:[?!]|\b)/,symbol:[{pattern:RegExp(/(^|[^:]):/.source+n),lookbehind:!0,greedy:!0},{pattern:RegExp(/([\r\n{(,][ \t]*)/.source+n+/(?=:(?!:))/.source),lookbehind:!0,greedy:!0}],"method-definition":{pattern:/(\bdef\s+)\w+(?:\s*\.\s*\w+)?/,lookbehind:!0,inside:{function:/\b\w+$/,keyword:/^self\b/,"class-name":/^\w+/,punctuation:/\./}}}),s.languages.insertBefore("ruby","string",{"string-literal":[{pattern:RegExp(/%[qQiIwWs]?/.source+t),greedy:!0,inside:{interpolation:e,string:/[\s\S]+/}},{pattern:/("|')(?:#\{[^}]+\}|#(?!\{)|\\(?:\r\n|[\s\S])|(?!\1)[^\\#\r\n])*\1/,greedy:!0,inside:{interpolation:e,string:/[\s\S]+/}},{pattern:/<<[-~]?([a-z_]\w*)[\r\n](?:.*[\r\n])*?[\t ]*\1/i,alias:"heredoc-string",greedy:!0,inside:{delimiter:{pattern:/^<<[-~]?[a-z_]\w*|\b[a-z_]\w*$/i,inside:{symbol:/\b\w+/,punctuation:/^<<[-~]?/}},interpolation:e,string:/[\s\S]+/}},{pattern:/<<[-~]?'([a-z_]\w*)'[\r\n](?:.*[\r\n])*?[\t ]*\1/i,alias:"heredoc-string",greedy:!0,inside:{delimiter:{pattern:/^<<[-~]?'[a-z_]\w*'|\b[a-z_]\w*$/i,inside:{symbol:/\b\w+/,punctuation:/^<<[-~]?'|'$/}},string:/[\s\S]+/}}],"command-literal":[{pattern:RegExp(/%x/.source+t),greedy:!0,inside:{interpolation:e,command:{pattern:/[\s\S]+/,alias:"string"}}},{pattern:/`(?:#\{[^}]+\}|#(?!\{)|\\(?:\r\n|[\s\S])|[^\\`#\r\n])*`/,greedy:!0,inside:{interpolation:e,command:{pattern:/[\s\S]+/,alias:"string"}}}]}),delete s.languages.ruby.string,s.languages.insertBefore("ruby","number",{builtin:/\b(?:Array|Bignum|Binding|Class|Continuation|Dir|Exception|FalseClass|File|Fixnum|Float|Hash|IO|Integer|MatchData|Method|Module|NilClass|Numeric|Object|Proc|Range|Regexp|Stat|String|Struct|Symbol|TMS|Thread|ThreadGroup|Time|TrueClass)\b/,constant:/\b[A-Z][A-Z0-9_]*(?:[?!]|\b)/}),s.languages.rb=s.languages.ruby})(Prism);(function(s){var e="\\b(?:BASH|BASHOPTS|BASH_ALIASES|BASH_ARGC|BASH_ARGV|BASH_CMDS|BASH_COMPLETION_COMPAT_DIR|BASH_LINENO|BASH_REMATCH|BASH_SOURCE|BASH_VERSINFO|BASH_VERSION|COLORTERM|COLUMNS|COMP_WORDBREAKS|DBUS_SESSION_BUS_ADDRESS|DEFAULTS_PATH|DESKTOP_SESSION|DIRSTACK|DISPLAY|EUID|GDMSESSION|GDM_LANG|GNOME_KEYRING_CONTROL|GNOME_KEYRING_PID|GPG_AGENT_INFO|GROUPS|HISTCONTROL|HISTFILE|HISTFILESIZE|HISTSIZE|HOME|HOSTNAME|HOSTTYPE|IFS|INSTANCE|JOB|LANG|LANGUAGE|LC_ADDRESS|LC_ALL|LC_IDENTIFICATION|LC_MEASUREMENT|LC_MONETARY|LC_NAME|LC_NUMERIC|LC_PAPER|LC_TELEPHONE|LC_TIME|LESSCLOSE|LESSOPEN|LINES|LOGNAME|LS_COLORS|MACHTYPE|MAILCHECK|MANDATORY_PATH|NO_AT_BRIDGE|OLDPWD|OPTERR|OPTIND|ORBIT_SOCKETDIR|OSTYPE|PAPERSIZE|PATH|PIPESTATUS|PPID|PS1|PS2|PS3|PS4|PWD|RANDOM|REPLY|SECONDS|SELINUX_INIT|SESSION|SESSIONTYPE|SESSION_MANAGER|SHELL|SHELLOPTS|SHLVL|SSH_AUTH_SOCK|TERM|UID|UPSTART_EVENTS|UPSTART_INSTANCE|UPSTART_JOB|UPSTART_SESSION|USER|WINDOWID|XAUTHORITY|XDG_CONFIG_DIRS|XDG_CURRENT_DESKTOP|XDG_DATA_DIRS|XDG_GREETER_DATA_DIR|XDG_MENU_PREFIX|XDG_RUNTIME_DIR|XDG_SEAT|XDG_SEAT_PATH|XDG_SESSION_DESKTOP|XDG_SESSION_ID|XDG_SESSION_PATH|XDG_SESSION_TYPE|XDG_VTNR|XMODIFIERS)\\b",t={pattern:/(^(["']?)\w+\2)[ \t]+\S.*/,lookbehind:!0,alias:"punctuation",inside:null},n={bash:t,environment:{pattern:RegExp("\\$"+e),alias:"constant"},variable:[{pattern:/\$?\(\([\s\S]+?\)\)/,greedy:!0,inside:{variable:[{pattern:/(^\$\(\([\s\S]+)\)\)/,lookbehind:!0},/^\$\(\(/],number:/\b0x[\dA-Fa-f]+\b|(?:\b\d+(?:\.\d*)?|\B\.\d+)(?:[Ee]-?\d+)?/,operator:/--|\+\+|\*\*=?|<<=?|>>=?|&&|\|\||[=!+\-*/%<>^&|]=?|[?~:]/,punctuation:/\(\(?|\)\)?|,|;/}},{pattern:/\$\((?:\([^)]+\)|[^()])+\)|`[^`]+`/,greedy:!0,inside:{variable:/^\$\(|^`|\)$|`$/}},{pattern:/\$\{[^}]+\}/,greedy:!0,inside:{operator:/:[-=?+]?|[!\/]|##?|%%?|\^\^?|,,?/,punctuation:/[\[\]]/,environment:{pattern:RegExp("(\\{)"+e),lookbehind:!0,alias:"constant"}}},/\$(?:\w+|[#?*!@$])/],entity:/\\(?:[abceEfnrtv\\"]|O?[0-7]{1,3}|U[0-9a-fA-F]{8}|u[0-9a-fA-F]{4}|x[0-9a-fA-F]{1,2})/};s.languages.bash={shebang:{pattern:/^#!\s*\/.*/,alias:"important"},comment:{pattern:/(^|[^"{\\$])#.*/,lookbehind:!0},"function-name":[{pattern:/(\bfunction\s+)[\w-]+(?=(?:\s*\(?:\s*\))?\s*\{)/,lookbehind:!0,alias:"function"},{pattern:/\b[\w-]+(?=\s*\(\s*\)\s*\{)/,alias:"function"}],"for-or-select":{pattern:/(\b(?:for|select)\s+)\w+(?=\s+in\s)/,alias:"variable",lookbehind:!0},"assign-left":{pattern:/(^|[\s;|&]|[<>]\()\w+(?:\.\w+)*(?=\+?=)/,inside:{environment:{pattern:RegExp("(^|[\\s;|&]|[<>]\\()"+e),lookbehind:!0,alias:"constant"}},alias:"variable",lookbehind:!0},parameter:{pattern:/(^|\s)-{1,2}(?:\w+:[+-]?)?\w+(?:\.\w+)*(?=[=\s]|$)/,alias:"variable",lookbehind:!0},string:[{pattern:/((?:^|[^<])<<-?\s*)(\w+)\s[\s\S]*?(?:\r?\n|\r)\2/,lookbehind:!0,greedy:!0,inside:n},{pattern:/((?:^|[^<])<<-?\s*)(["'])(\w+)\2\s[\s\S]*?(?:\r?\n|\r)\3/,lookbehind:!0,greedy:!0,inside:{bash:t}},{pattern:/(^|[^\\](?:\\\\)*)"(?:\\[\s\S]|\$\([^)]+\)|\$(?!\()|`[^`]+`|[^"\\`$])*"/,lookbehind:!0,greedy:!0,inside:n},{pattern:/(^|[^$\\])'[^']*'/,lookbehind:!0,greedy:!0},{pattern:/\$'(?:[^'\\]|\\[\s\S])*'/,greedy:!0,inside:{entity:n.entity}}],environment:{pattern:RegExp("\\$?"+e),alias:"constant"},variable:n.variable,function:{pattern:/(^|[\s;|&]|[<>]\()(?:add|apropos|apt|apt-cache|apt-get|aptitude|aspell|automysqlbackup|awk|basename|bash|bc|bconsole|bg|bzip2|cal|cargo|cat|cfdisk|chgrp|chkconfig|chmod|chown|chroot|cksum|clear|cmp|column|comm|composer|cp|cron|crontab|csplit|curl|cut|date|dc|dd|ddrescue|debootstrap|df|diff|diff3|dig|dir|dircolors|dirname|dirs|dmesg|docker|docker-compose|du|egrep|eject|env|ethtool|expand|expect|expr|fdformat|fdisk|fg|fgrep|file|find|fmt|fold|format|free|fsck|ftp|fuser|gawk|git|gparted|grep|groupadd|groupdel|groupmod|groups|grub-mkconfig|gzip|halt|head|hg|history|host|hostname|htop|iconv|id|ifconfig|ifdown|ifup|import|install|ip|java|jobs|join|kill|killall|less|link|ln|locate|logname|logrotate|look|lpc|lpr|lprint|lprintd|lprintq|lprm|ls|lsof|lynx|make|man|mc|mdadm|mkconfig|mkdir|mke2fs|mkfifo|mkfs|mkisofs|mknod|mkswap|mmv|more|most|mount|mtools|mtr|mutt|mv|nano|nc|netstat|nice|nl|node|nohup|notify-send|npm|nslookup|op|open|parted|passwd|paste|pathchk|ping|pkill|pnpm|podman|podman-compose|popd|pr|printcap|printenv|ps|pushd|pv|quota|quotacheck|quotactl|ram|rar|rcp|reboot|remsync|rename|renice|rev|rm|rmdir|rpm|rsync|scp|screen|sdiff|sed|sendmail|seq|service|sftp|sh|shellcheck|shuf|shutdown|sleep|slocate|sort|split|ssh|stat|strace|su|sudo|sum|suspend|swapon|sync|sysctl|tac|tail|tar|tee|time|timeout|top|touch|tr|traceroute|tsort|tty|umount|uname|unexpand|uniq|units|unrar|unshar|unzip|update-grub|uptime|useradd|userdel|usermod|users|uudecode|uuencode|v|vcpkg|vdir|vi|vim|virsh|vmstat|wait|watch|wc|wget|whereis|which|who|whoami|write|xargs|xdg-open|yarn|yes|zenity|zip|zsh|zypper)(?=$|[)\s;|&])/,lookbehind:!0},keyword:{pattern:/(^|[\s;|&]|[<>]\()(?:case|do|done|elif|else|esac|fi|for|function|if|in|select|then|until|while)(?=$|[)\s;|&])/,lookbehind:!0},builtin:{pattern:/(^|[\s;|&]|[<>]\()(?:\.|:|alias|bind|break|builtin|caller|cd|command|continue|declare|echo|enable|eval|exec|exit|export|getopts|hash|help|let|local|logout|mapfile|printf|pwd|read|readarray|readonly|return|set|shift|shopt|source|test|times|trap|type|typeset|ulimit|umask|unalias|unset)(?=$|[)\s;|&])/,lookbehind:!0,alias:"class-name"},boolean:{pattern:/(^|[\s;|&]|[<>]\()(?:false|true)(?=$|[)\s;|&])/,lookbehind:!0},"file-descriptor":{pattern:/\B&\d\b/,alias:"important"},operator:{pattern:/\d?<>|>\||\+=|=[=~]?|!=?|<<[<-]?|[&\d]?>>|\d[<>]&?|[<>][&=]?|&[>&]?|\|[&|]?/,inside:{"file-descriptor":{pattern:/^\d/,alias:"important"}}},punctuation:/\$?\(\(?|\)\)?|\.\.|[{}[\];\\]/,number:{pattern:/(^|\s)(?:[1-9]\d*|0)(?:[.,]\d+)?\b/,lookbehind:!0}},t.inside=s.languages.bash;for(var r=["comment","function-name","for-or-select","assign-left","parameter","string","environment","function","keyword","builtin","boolean","file-descriptor","operator","punctuation","number"],i=n.variable[1].inside,a=0;a<r.length;a++)i[r[a]]=s.languages.bash[r[a]];s.languages.sh=s.languages.bash,s.languages.shell=s.languages.bash})(Prism);Prism.languages.json={property:{pattern:/(^|[^\\])"(?:\\.|[^\\"\r\n])*"(?=\s*:)/,lookbehind:!0,greedy:!0},string:{pattern:/(^|[^\\])"(?:\\.|[^\\"\r\n])*"(?!\s*:)/,lookbehind:!0,greedy:!0},comment:{pattern:/\/\/.*|\/\*[\s\S]*?(?:\*\/|$)/,greedy:!0},number:/-?\b\d+(?:\.\d+)?(?:e[+-]?\d+)?\b/i,punctuation:/[{}[\],]/,operator:/:/,boolean:/\b(?:false|true)\b/,null:{pattern:/\bnull\b/,alias:"keyword"}};Prism.languages.webmanifest=Prism.languages.json;(function(s){var e=/(?:"(?:\\(?:\r\n|[\s\S])|[^"\\\r\n])*"|'(?:\\(?:\r\n|[\s\S])|[^'\\\r\n])*')/;s.languages.css={comment:/\/\*[\s\S]*?\*\//,atrule:{pattern:RegExp("@[\\w-](?:"+/[^;{\s"']|\s+(?!\s)/.source+"|"+e.source+")*?"+/(?:;|(?=\s*\{))/.source),inside:{rule:/^@[\w-]+/,"selector-function-argument":{pattern:/(\bselector\s*\(\s*(?![\s)]))(?:[^()\s]|\s+(?![\s)])|\((?:[^()]|\([^()]*\))*\))+(?=\s*\))/,lookbehind:!0,alias:"selector"},keyword:{pattern:/(^|[^\w-])(?:and|not|only|or)(?![\w-])/,lookbehind:!0}}},url:{pattern:RegExp("\\burl\\((?:"+e.source+"|"+/(?:[^\\\r\n()"']|\\[\s\S])*/.source+")\\)","i"),greedy:!0,inside:{function:/^url/i,punctuation:/^\(|\)$/,string:{pattern:RegExp("^"+e.source+"$"),alias:"url"}}},selector:{pattern:RegExp(`(^|[{}\\s])[^{}\\s](?:[^{};"'\\s]|\\s+(?![\\s{])|`+e.source+")*(?=\\s*\\{)"),lookbehind:!0},string:{pattern:e,greedy:!0},property:{pattern:/(^|[^-\w\xA0-\uFFFF])(?!\s)[-_a-z\xA0-\uFFFF](?:(?!\s)[-\w\xA0-\uFFFF])*(?=\s*:)/i,lookbehind:!0},important:/!important\b/i,function:{pattern:/(^|[^-a-z0-9])[-a-z0-9]+(?=\()/i,lookbehind:!0},punctuation:/[(){};:,]/},s.languages.css.atrule.inside.rest=s.languages.css;var t=s.languages.markup;t&&(t.tag.addInlined("style","css"),t.tag.addAttribute("style","css"))})(Prism);const sn=new Map;Ue.setOptions({breaks:!0,gfm:!0});const $r={js:"javascript",ts:"typescript",py:"python",rb:"ruby",sh:"bash",yml:"yaml",md:"markdown","c++":"cpp",csharp:"csharp","c#":"csharp",golang:"go",rs:"rust"},$c={code(s){const e=s.text;let t=s.lang;if(t&&$r[t.toLowerCase()]&&(t=$r[t.toLowerCase()]),t&&Bn.languages[t])try{const r=Bn.highlight(e,Bn.languages[t],t);return`<pre class="language-${t}"><code class="language-${t}">${r}</code></pre>`}catch(r){console.error("Prism highlighting failed for",t,":",r);const i=e.replace(/</g,"&lt;").replace(/>/g,"&gt;");return`<pre class="language-${t}"><code class="language-${t}">${i}</code></pre>`}return`<pre><code>${e.replace(/</g,"&lt;").replace(/>/g,"&gt;")}</code></pre>`}};Ue.use({renderer:$c});function Sn(s){s=s.replace(/\|\|(.+?)\|\|/g,'<span class="spoiler" data-spoiler="true">$1</span>'),s=s.replace(/```(\w+)\n([\s\S]*?)```/g,(n,r,i)=>i.endsWith(`
`)?n:"```"+r+`
`+i+"\n```");let e;try{const n=Ue.parse(s,{async:!1});e=typeof n=="string"?n:String(n)}catch(n){console.error("Markdown parse error:",n),e=s}return e=e.replace(/:([a-zA-Z0-9_]+):/g,(n,r)=>{const i=sn.get(r);return i?`<img src="${i.url}" alt=":${r}:" class="emote ${i.type==="animated"?"emote-animated":""}" title=":${r}:">`:n}),Jc.sanitize(e,{ALLOWED_TAGS:["p","br","strong","em","u","s","del","code","pre","a","img","blockquote","ul","ol","li","h1","h2","h3","h4","h5","h6","hr","span"],ALLOWED_ATTR:["href","src","alt","class","title","target","rel","data-spoiler"],FORBID_TAGS:["style","script"],FORBID_ATTR:["style","onerror","onload"]})}function eu(s){sn.set(s.name,s)}function tu(s){sn.delete(s)}function su(s){sn.clear(),s.forEach(e=>{sn.set(e.name,e)})}const nu="wabi-chat-db",ru=1,Nt="messages",Ls="settings";class iu{constructor(){Le(this,"db",null);Le(this,"initPromise",null)}async init(){if(!this.db)return this.initPromise?this.initPromise:(this.initPromise=new Promise((e,t)=>{const n=indexedDB.open(nu,ru);n.onerror=()=>t(n.error),n.onsuccess=()=>{this.db=n.result,e()},n.onupgradeneeded=r=>{const i=r.target.result;i.objectStoreNames.contains(Nt)||i.createObjectStore(Nt,{keyPath:"period"}),i.objectStoreNames.contains(Ls)||i.createObjectStore(Ls,{keyPath:"key"})}}),this.initPromise)}async getSetting(e){return this.db?new Promise((t,n)=>{const a=this.db.transaction([Ls],"readonly").objectStore(Ls).get(e);a.onsuccess=()=>{var l;return t((l=a.result)==null?void 0:l.value)},a.onerror=()=>n(a.error)}):null}async setSetting(e,t){if(this.db)return new Promise((n,r)=>{const l=this.db.transaction([Ls],"readwrite").objectStore(Ls).put({key:e,value:t});l.onsuccess=()=>n(),l.onerror=()=>r(l.error)})}async getArchive(e){return this.db?new Promise((t,n)=>{const a=this.db.transaction([Nt],"readonly").objectStore(Nt).get(e);a.onsuccess=()=>{var l;return t((l=a.result)==null?void 0:l.data)},a.onerror=()=>n(a.error)}):null}async setArchive(e,t){if(this.db)return new Promise((n,r)=>{const l=this.db.transaction([Nt],"readwrite").objectStore(Nt).put({period:e,data:t});l.onsuccess=()=>n(),l.onerror=()=>r(l.error)})}async deleteArchive(e){if(this.db)return new Promise((t,n)=>{const a=this.db.transaction([Nt],"readwrite").objectStore(Nt).delete(e);a.onsuccess=()=>t(),a.onerror=()=>n(a.error)})}async getAllArchiveKeys(){return this.db?new Promise((e,t)=>{const i=this.db.transaction([Nt],"readonly").objectStore(Nt).getAllKeys();i.onsuccess=()=>e(i.result),i.onerror=()=>t(i.error)}):[]}async getAllArchives(){return this.db?new Promise((e,t)=>{const i=this.db.transaction([Nt],"readonly").objectStore(Nt).getAll();i.onsuccess=()=>e(i.result),i.onerror=()=>t(i.error)}):[]}async clearAllArchives(){if(this.db)return new Promise((e,t)=>{const i=this.db.transaction([Nt],"readwrite").objectStore(Nt).clear();i.onsuccess=()=>e(),i.onerror=()=>t(i.error)})}}class lu{constructor(){Le(this,"rotationPeriod","month");Le(this,"maxArchives",4);Le(this,"db");Le(this,"initPromise",null);this.db=new iu,this.initPromise=this.init()}async init(){await this.db.init(),await this.loadSettings()}async ensureInit(){this.initPromise&&await this.initPromise}async loadSettings(){const e=await this.db.getSetting("rotationPeriod");e&&(this.rotationPeriod=e);const t=await this.db.getSetting("maxArchives");t&&(this.maxArchives=parseInt(t))}async setRotationPeriod(e){await this.ensureInit(),this.rotationPeriod=e,await this.db.setSetting("rotationPeriod",e)}async setMaxArchives(e){await this.ensureInit(),this.maxArchives=e,await this.db.setSetting("maxArchives",e.toString()),await this.rotateArchives()}getRotationPeriod(){return this.rotationPeriod}getMaxArchives(){return this.maxArchives}getPeriodKey(){const e=new Date,t=e.getFullYear();switch(this.rotationPeriod){case"week":{const n=this.getWeekNumber(e);return`${t}-W${String(n).padStart(2,"0")}`}case"month":{const n=e.getMonth()+1;return`${t}-${String(n).padStart(2,"0")}`}case"half-year":{const n=e.getMonth()<6?"H1":"H2";return`${t}-${n}`}case"year":return`${t}`}}getWeekNumber(e){const t=new Date(e.getFullYear(),0,1),n=Math.floor((e.getTime()-t.getTime())/(24*60*60*1e3));return Math.ceil((n+t.getDay()+1)/7)}async isEnabled(){await this.ensureInit();const e=await this.db.getSetting("saveHistory");return e==="true"||e===!0}async setEnabled(e){await this.ensureInit(),await this.db.setSetting("saveHistory",e.toString())}async saveMessage(e,t){if(await this.ensureInit(),!await this.isEnabled())return;const r=this.getPeriodKey(),i=await this.db.getArchive(r)||{};i[e]||(i[e]=[]),i[e].push(t);try{await this.db.setArchive(r,i),await this.rotateArchives()}catch(a){console.error("Failed to save message to IndexedDB:",a),await this.rotateArchives()}}async rotateArchives(){await this.ensureInit();const e=(await this.db.getAllArchiveKeys()).sort().reverse();if(e.length>this.maxArchives){const t=e.slice(this.maxArchives);for(const n of t)console.log(`ðŸ—‘ï¸ Auto-deleting old archive: ${n}`),await this.db.deleteArchive(n)}}async loadAllMessages(){if(await this.ensureInit(),!await this.isEnabled())return{};const t={},n=await this.db.getAllArchives();for(const r of n){const i=r.data||{};Object.entries(i).forEach(([a,l])=>{t[a]||(t[a]=[]),t[a].push(...l)})}return Object.keys(t).forEach(r=>{t[r].sort((i,a)=>i.timestamp-a.timestamp)}),t}async deleteArchive(e){await this.ensureInit(),await this.db.deleteArchive(e),console.log(`ðŸ—‘ï¸ Deleted archive: ${e}`)}async clearAllHistory(){await this.ensureInit(),await this.db.clearAllArchives(),console.log("ðŸ—‘ï¸ Cleared all chat history")}async exportArchives(){await this.ensureInit();const e=await this.db.getAllArchives();if(e.length===0){alert("No archives to export");return}e.forEach(t=>{const n=JSON.stringify(t.data),r=new Blob([n],{type:"application/json"}),i=URL.createObjectURL(r),a=document.createElement("a");a.href=i,a.download=`wabi-chat-${t.period}.json`,a.click(),URL.revokeObjectURL(i)})}async exportArchive(e){await this.ensureInit();const t=await this.db.getArchive(e);if(!t){alert("Archive not found");return}const n=new Blob([JSON.stringify(t)],{type:"application/json"}),r=URL.createObjectURL(n),i=document.createElement("a");i.href=r,i.download=`wabi-chat-${e}.json`,i.click(),URL.revokeObjectURL(r)}async getStats(){await this.ensureInit();const t=(await this.db.getAllArchives()).map(i=>{const a=JSON.stringify(i.data),l=new Blob([a]).size,o=i.data,u=Object.values(o).reduce((f,p)=>f+p.length,0);return{period:i.period,size:l,messageCount:u}}).sort((i,a)=>a.period.localeCompare(i.period)),n=t.reduce((i,a)=>i+a.size,0),r=t.reduce((i,a)=>i+a.messageCount,0);return{archives:t,totalSize:n,totalMessages:r}}}const Pt=new lu,Vs=_t(null),us=_t([]),Os=_t("general"),St=_t({general:[]}),Zt=_t([]),Ia=_t([]),ns=_t(null),ei=_t(!1),Da=_t(0),Er=_t(null);let de=null;function au(s){let e="http://localhost:3000";return e="http://localhost:3000",de=kn(e),Vs.set(de),Pt.loadAllMessages().then(t=>{if(Object.keys(t).length>0){const n={};for(const[r,i]of Object.entries(t)){const a=new Set;n[r]=i.filter(l=>a.has(l.id)?!1:(a.add(l.id),!0))}St.set(n)}}),de.on("connect",()=>{console.log("Connected to server"),ei.set(!0),de==null||de.emit("join",s)}),de.on("disconnect",()=>{console.log("Disconnected from server"),ei.set(!1)}),de.on("init",t=>{us.set(t.channels),Zt.set(t.users),t.emotes&&su(t.emotes);const n=t.users.find(r=>r.id===(de==null?void 0:de.id));n&&ns.set(n),de==null||de.emit("join-channel","general")}),de.on("channel-messages",t=>{St.update(n=>{const r=n[t.channelId]||[],i=new Set(r.map(l=>l.id)),a=t.messages.filter(l=>!i.has(l.id));return{...n,[t.channelId]:[...r,...a]}})}),de.on("message",t=>{St.update(i=>{const a=i[t.channelId]||[];return a.some(l=>l.id===t.message.id)?i:{...i,[t.channelId]:[...a,t.message]}}),Pt.saveMessage(t.channelId,t.message);const n=t.message.userId===(de==null?void 0:de.id);let r;us.subscribe(i=>{const a=i.find(l=>l.id===t.channelId);r=a==null?void 0:a.name})(),jo(t.message,n,r),!n&&document.hidden&&Da.update(i=>(i===0&&Er.set(t.message.id),i+1))}),de.on("user-joined",t=>{Zt.update(n=>[...n,t])}),de.on("user-left",t=>{Zt.update(n=>n.filter(r=>r.id!==t.id))}),de.on("typing",t=>{Ia.set(t)}),de.on("profile-updated",t=>{Zt.update(n=>n.map(r=>r.id===t.id?t:r)),ns.update(n=>n&&n.id===t.id?t:n)}),de.on("message-edited",t=>{St.update(n=>({...n,[t.channelId]:(n[t.channelId]||[]).map(r=>r.id===t.messageId?{...r,text:t.newText,isEdited:!0}:r)}))}),de.on("message-deleted",t=>{St.update(n=>({...n,[t.channelId]:(n[t.channelId]||[]).filter(r=>r.id!==t.messageId)}))}),de.on("message-pin-toggled",t=>{St.update(n=>({...n,[t.channelId]:(n[t.channelId]||[]).map(r=>r.id===t.messageId?{...r,isPinned:t.isPinned}:r)}))}),de.on("channel-created",t=>{us.update(n=>[...n,t]),St.update(n=>({...n,[t.id]:[]}))}),de.on("channel-deleted",t=>{us.update(n=>n.filter(r=>r.id!==t)),St.update(n=>{const r={...n};return delete r[t],r}),Os.update(n=>n===t?"general":n)}),de.on("channel-error",t=>{console.error("Channel error:",t),alert(t)}),de.on("dm-created",t=>{const n={id:t.channelId,name:t.otherUser.username,createdAt:Date.now(),type:"dm",otherUser:t.otherUser};us.update(r=>r.some(i=>i.id===t.channelId)?r:[...r,n]),St.update(r=>({...r,[t.channelId]:r[t.channelId]||[]})),Os.set(t.channelId)}),de.on("group-created",t=>{us.update(n=>n.some(r=>r.id===t.id)?n:[...n,t]),St.update(n=>({...n,[t.id]:n[t.id]||[]}))}),de.on("emote-added",t=>{eu(t)}),de.on("emote-deleted",t=>{tu(t)}),de.on("emote-error",t=>{console.error("Emote error:",t),alert(t)}),de}function ou(s){de==null||de.emit("join-channel",s),Os.set(s)}function cu(s){de==null||de.emit("create-channel",s)}function uu(s){de==null||de.emit("delete-channel",s)}function hn(s,e,t="text",n){de==null||de.emit("message",{channelId:s,text:e,type:t,...n})}function Oa(s,e,t){de==null||de.emit("edit-message",{channelId:s,messageId:e,newText:t})}function fu(s,e){de==null||de.emit("delete-message",{channelId:s,messageId:e})}function Tr(s,e){de==null||de.emit("toggle-pin-message",{channelId:s,messageId:e})}function Wn(s){de==null||de.emit("typing",s)}function ti(s,e){de==null||de.emit("update-profile",{status:s,profilePicture:e})}function du(){de==null||de.disconnect(),Vs.set(null),de=null}function hu(){Da.set(0),Er.set(null)}function Na(s){de==null||de.emit("create-dm",{targetUserId:s})}let pn;const pu=new Uint8Array(16);function gu(){if(!pn&&(pn=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!pn))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return pn(pu)}const mt=[];for(let s=0;s<256;++s)mt.push((s+256).toString(16).slice(1));function mu(s,e=0){return mt[s[e+0]]+mt[s[e+1]]+mt[s[e+2]]+mt[s[e+3]]+"-"+mt[s[e+4]]+mt[s[e+5]]+"-"+mt[s[e+6]]+mt[s[e+7]]+"-"+mt[s[e+8]]+mt[s[e+9]]+"-"+mt[s[e+10]]+mt[s[e+11]]+mt[s[e+12]]+mt[s[e+13]]+mt[s[e+14]]+mt[s[e+15]]}const vu=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),si={randomUUID:vu};function _u(s,e,t){if(si.randomUUID&&!s)return si.randomUUID();s=s||{};const n=s.random||(s.rng||gu)();return n[6]=n[6]&15|64,n[8]=n[8]&63|128,mu(n)}typeof window<"u"&&typeof location<"u"&&location.search.indexOf("giphy-debug");var As="",Ra=16,bu=()=>{let s="";const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=e.length;for(let n=0;n<Ra;n++)s+=e.charAt(Math.floor(Math.random()*t));return s},ku=()=>{if(!As){try{As=sessionStorage.getItem("giphyPingbackId")}catch{}if(!As){const s=new Date().getTime().toString(16);try{As=`${s}${_u().replace(/-/g,"")}`.substring(0,Ra)}catch{As=bu()}try{sessionStorage.setItem("giphyPingbackId",As)}catch{}}}return As},yu=ku,gn=null;new Promise(s=>{typeof Image>"u"&&s(!1);const e=new Image;e.onload=()=>{gn=!0,s(gn)},e.onerror=()=>{gn=!1,s(gn)},e.src="data:image/webp;base64,UklGRjoAAABXRUJQVlA4IC4AAACyAgCdASoCAAIALmk0mk0iIiIiIgBoSygABc6WWgAA/veff/0PP8bA//LwYAAA"});var $s=(typeof window<"u"?window:global)||{};$s._GIPHY_SDK_HEADERS_=$s._GIPHY_SDK_HEADERS_||($s.Headers?new $s.Headers({"X-GIPHY-SDK-PLATFORM":"web"}):void 0);var Pa=()=>$s._GIPHY_SDK_HEADERS_,ni=(s,e)=>{var t;return(t=Pa())==null?void 0:t.set(s,e)},wu=Object.defineProperty,Eu=Object.defineProperties,Tu=Object.getOwnPropertyDescriptors,Su=Object.getOwnPropertyNames,ri=Object.getOwnPropertySymbols,Au=Object.prototype.hasOwnProperty,Cu=Object.prototype.propertyIsEnumerable,ii=(s,e,t)=>e in s?wu(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t,es=(s,e)=>{for(var t in e||(e={}))Au.call(e,t)&&ii(s,t,e[t]);if(ri)for(var t of ri(e))Cu.call(e,t)&&ii(s,t,e[t]);return s},Yn=(s,e)=>Eu(s,Tu(e)),Iu=(s=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(s,{get:(e,t)=>(typeof require<"u"?require:e)[t]}):s)(function(s){if(typeof require<"u")return require.apply(this,arguments);throw Error('Dynamic require of "'+s+'" is not supported')}),Du=(s,e)=>function(){return e||(0,s[Su(s)[0]])((e={exports:{}}).exports,e),e.exports},Ou=(s,e,t)=>new Promise((n,r)=>{var i=o=>{try{l(t.next(o))}catch(u){r(u)}},a=o=>{try{l(t.throw(o))}catch(u){r(u)}},l=o=>o.done?n(o.value):Promise.resolve(o.value).then(i,a);l((t=t.apply(s,e)).next())}),Nu=Du({"package.json"(s,e){e.exports={scripts:{lint:"run -T eslint . --ext .ts,.tsx",clean:"rm -rf ./dist",dev:"parcel public/test.html",docs:"typedoc src/index.ts",build:"run -T tsup src/index.ts --format cjs,esm --dts && run -T publint",prepublish:"npm run clean && npm run build",test:"run -T jest --config ./jestconfig.js","test:watch":"run -T jest --config ./jestconfig.js --watchAll"},name:"@giphy/js-fetch-api",version:"5.7.0",description:"Javascript API to fetch gifs and stickers from the GIPHY API.",homepage:"https://github.com/Giphy/giphy-js/tree/master/packages/fetch-api",main:"dist/index.cjs",types:"dist/index.d.ts",module:"dist/index.js",type:"module",sideEffects:!1,exports:{".":{types:"./dist/index.d.ts",import:"./dist/index.js",require:"./dist/index.cjs"},"./package.json":"./package.json"},files:["dist/","src/**/*"],license:"MIT",publishConfig:{access:"public"},dependencies:{"@giphy/js-types":"*","@giphy/js-util":"*"},devDependencies:{"jest-fetch-mock":"^3.0.3","parcel-bundler":"latest",typedoc:"^0.20.37","typedoc-thunder-theme":"^0.0.3",typescript:"^5.0.4"}}}}),Ru=["is_anonymous","is_community","is_featured","is_hidden","is_indexable","is_preserve_size","is_realtime","is_removed","is_sticker","is_dynamic"],Pu=["suppress_chrome","is_public","is_verified"],li=s=>e=>s[e]=!!s[e],Fu=s=>typeof s=="string"?s:s.text,Fa=(s,e="")=>{const t=es({},s);t.id=String(t.id),t.tags=(t.tags||[]).map(Fu),t.bottle_data||(t.bottle_data={}),t.response_id=e,Ru.forEach(li(t)),Object.keys(t.images||{}).forEach(r=>{const i=t.images[r];i.width=parseInt(i.width),i.height=parseInt(i.height)});const{user:n}=t;if(n){const r=es({},n);Pu.forEach(li(r)),t.user=r}return t},ai=s=>{const{response_id:e}=s.meta;return s.data=Fa(s.data,e),s},as=s=>{const{response_id:e}=s.meta;return s.data=s.data.map(t=>Fa(t,e)),s},Lu=(typeof window<"u"?window:global)||{},Mu=Lu.GIPHY_API_URL||"https://api.giphy.com/v1/",La=class extends Error{constructor(s,e,t=0,n=""){super(s),this.url=e,this.status=t,this.statusText=n}},xu=class extends La{},oi=La,Uu="@giphy/js-fetch-api: ",Bu="Error fetching",Vu=s=>s,Wt={},zu=6e4,qu=6e3,ju=()=>{const s=Date.now();Object.keys(Wt).forEach(e=>{const t=Wt[e].isError?qu:zu;s-Wt[e].ts>=t&&delete Wt[e]})};function Hu(s,e={}){const{apiVersion:t=1,noCache:n=!1,normalizer:r=Vu}=e,i=Mu.replace(/\/v\d+\/$/,`/v${t}/`);if(ju(),!Wt[s]||n){const a=`${i}${s}`,l=()=>Ou(this,null,function*(){var o,u;let f;try{const p=yield fetch(a,{method:"get"});if(p.ok){const h=yield p.json();if((o=h.meta)!=null&&o.response_id)return r(h);throw{message:"synthetic response"}}else{let h=Bu;try{const m=yield p.json();m.message&&(h=m.message),(u=m.meta)!=null&&u.msg&&(h=m.meta.msg)}catch{}Wt[s]&&(Wt[s].isError=!0);let g=oi;h==="This content is not available in your location"&&(g=xu),f=new g(`${Uu}${h}`,a,p.status,p.statusText)}}catch(p){f=new oi(p.message,a),Wt[s]&&(Wt[s].isError=!0)}throw f});Wt[s]={request:l(),ts:Date.now()}}return Wt[s].request}var Rt=Hu,Xn=s=>s&&s.type?s.type:"gifs",Gu=class{constructor(s,e={}){this.getQS=(t={})=>new URLSearchParams(es(Yn(es({},t),{api_key:this.apiKey,pingback_id:yu()}),this.qsParams)).toString(),this.apiKey=s,this.qsParams=e}categories(s){return Rt(`gifs/categories?${this.getQS(s)}`)}gif(s,e){const t=e!=null&&e.internal?"internal/":"";return Rt(`${t}gifs/${s}?${this.getQS()}`,{normalizer:ai})}gifs(s,e){return Array.isArray(s)?Rt(`gifs?${this.getQS({ids:s.join(",")})}`,{normalizer:as}):Rt(`gifs/categories/${s}/${e}?${this.getQS()}`,{normalizer:as})}emoji(s){return Rt(`emoji?${this.getQS(s)}`,{normalizer:as})}emojiDefaultVariations(s){return Rt(`emoji?${this.getQS(s)}`,{apiVersion:2,normalizer:as})}emojiVariations(s){return Rt(`emoji/${s}/variations?${this.getQS()}`,{apiVersion:2,normalizer:as})}animate(s,e={}){const t=this.getQS(Yn(es({},e),{m:s}));return Rt(`text/animate?${t}`,{normalizer:as})}search(s,e={}){const t=e.channel?`@${e.channel} ${s}`:s;let n;e.type==="text"&&(n=!0);const r=this.getQS(Yn(es({rating:"pg-13"},e),{q:t,excludeDynamicResults:n}));return Rt(`${Xn(e)}/search?${r}`,{normalizer:as})}subcategories(s,e){return Rt(`gifs/categories/${s}?${this.getQS(e)}`)}trending(s={}){return Rt(`${Xn(s)}/trending?${this.getQS(es({rating:"pg-13"},s))}`,{normalizer:as})}random(s){return Rt(`${Xn(s)}/random?${this.getQS(es({rating:"pg-13"},s))}`,{noCache:!0,normalizer:ai})}related(s,e={}){const{type:t="gifs"}=e;return Rt(`${t}/related?${this.getQS(es({gif_id:s,rating:"pg-13"},e))}`,{normalizer:as})}channels(s,e={}){return Rt(`channels/search?${this.getQS(es({q:s,rating:"pg-13"},e))}`)}},Wu=Gu,ci;if(typeof Iu<"u"){const{version:s}=Nu();(ci=Pa())!=null&&ci.get("X-GIPHY-SDK-NAME")||(ni("X-GIPHY-SDK-NAME","FetchAPI"),ni("X-GIPHY-SDK-VERSION",s))}function ui(s,e,t){const n=s.slice();return n[11]=e[t],n}function Yu(s){let e=[],t=new Map,n,r=ze(s[1]);const i=a=>a[11].id;for(let a=0;a<r.length;a+=1){let l=ui(s,r,a),o=i(l);t.set(o,e[a]=fi(o,l))}return{c(){for(let a=0;a<e.length;a+=1)e[a].c();n=Ie()},l(a){for(let l=0;l<e.length;l+=1)e[l].l(a);n=Ie()},m(a,l){for(let o=0;o<e.length;o+=1)e[o]&&e[o].m(a,l);V(a,n,l)},p(a,l){l&34&&(r=ze(a[1]),e=Qt(e,l,i,1,a,r,t,n.parentNode,Kt,fi,n,ui))},d(a){a&&_(n);for(let l=0;l<e.length;l+=1)e[l].d(a)}}}function Xu(s){let e,t="No GIFs found";return{c(){e=y("div"),e.textContent=t,this.h()},l(n){e=k(n,"DIV",{class:!0,"data-svelte-h":!0}),$(e)!=="svelte-1db6zr7"&&(e.textContent=t),this.h()},h(){d(e,"class","no-results svelte-x54k5n")},m(n,r){V(n,e,r)},p:Ce,d(n){n&&_(e)}}}function Zu(s){let e,t="Loading...";return{c(){e=y("div"),e.textContent=t,this.h()},l(n){e=k(n,"DIV",{class:!0,"data-svelte-h":!0}),$(e)!=="svelte-1f5y80z"&&(e.textContent=t),this.h()},h(){d(e,"class","loading svelte-x54k5n")},m(n,r){V(n,e,r)},p:Ce,d(n){n&&_(e)}}}function fi(s,e){let t,n,r,i,a,l,o;function u(){return e[8](e[11])}return{key:s,first:null,c(){t=y("button"),n=y("img"),a=F(),this.h()},l(f){t=k(f,"BUTTON",{class:!0});var p=D(t);n=k(p,"IMG",{src:!0,alt:!0,class:!0}),a=P(p),p.forEach(_),this.h()},h(){Be(n.src,r=e[11].images.fixed_height_small.url)||d(n,"src",r),d(n,"alt",i=e[11].title),d(n,"class","svelte-x54k5n"),d(t,"class","gif-item svelte-x54k5n"),this.first=t},m(f,p){V(f,t,p),c(t,n),c(t,a),l||(o=X(t,"click",u),l=!0)},p(f,p){e=f,p&2&&!Be(n.src,r=e[11].images.fixed_height_small.url)&&d(n,"src",r),p&2&&i!==(i=e[11].title)&&d(n,"alt",i)},d(f){f&&_(t),l=!1,o()}}}function Ku(s){let e,t,n,r,i,a="âœ•",l,o,u,f;function p(m,v){return m[2]?Zu:m[1].length===0?Xu:Yu}let h=p(s),g=h(s);return{c(){e=y("div"),t=y("div"),n=y("input"),r=F(),i=y("button"),i.textContent=a,l=F(),o=y("div"),g.c(),this.h()},l(m){e=k(m,"DIV",{class:!0});var v=D(e);t=k(v,"DIV",{class:!0});var T=D(t);n=k(T,"INPUT",{type:!0,placeholder:!0,class:!0}),r=P(T),i=k(T,"BUTTON",{class:!0,"data-svelte-h":!0}),$(i)!=="svelte-xkwxcu"&&(i.textContent=a),T.forEach(_),l=P(v),o=k(v,"DIV",{class:!0});var C=D(o);g.l(C),C.forEach(_),v.forEach(_),this.h()},h(){d(n,"type","text"),d(n,"placeholder","Search GIFs..."),d(n,"class","svelte-x54k5n"),d(i,"class","close-btn svelte-x54k5n"),d(t,"class","giphy-header svelte-x54k5n"),d(o,"class","gif-grid svelte-x54k5n"),d(e,"class","giphy-picker svelte-x54k5n")},m(m,v){V(m,e,v),c(e,t),c(t,n),lt(n,s[0]),c(t,r),c(t,i),c(e,l),c(e,o),g.m(o,null),u||(f=[X(n,"input",s[6]),X(n,"input",s[4]),X(i,"click",s[7])],u=!0)},p(m,[v]){v&1&&n.value!==m[0]&&lt(n,m[0]),h===(h=p(m))&&g?g.p(m,v):(g.d(1),g=h(m),g&&(g.c(),g.m(o,null)))},i:Ce,o:Ce,d(m){m&&_(e),g.d(),u=!1,De(f)}}}function Qu(s,e,t){const n=or();let r="",i=[],a=!1;const l=new Wu("sXpGFDGZs0Dv1mmNFvYaGUvYwKX0PWIh");async function o(){if(!r.trim()){u();return}t(2,a=!0);try{const{data:m}=await l.search(r,{limit:20});t(1,i=m)}catch(m){console.error("Error fetching GIFs:",m)}t(2,a=!1)}async function u(){t(2,a=!0);try{const{data:m}=await l.trending({limit:20});t(1,i=m),console.log("Loaded GIFs:",i.length,i)}catch(m){console.error("Error fetching trending GIFs:",m),t(1,i=[])}t(2,a=!1)}function f(m){n("select",m.images.fixed_height.url)}rs(()=>{u()});function p(){r=this.value,t(0,r)}return[r,i,a,n,o,f,p,()=>n("close"),m=>f(m)]}class Ju extends ct{constructor(e){super(),ut(this,e,Qu,Ku,ot,{})}}function di(s){let e,t,n,r,i=(s[2]?"Your Profile":s[1].username)+"",a,l,o,u="Ã—",f,p,h,g,m,v,T,C,E,S="Username:",b,A,I=s[1].username+"",w,O,N,M,L,B;function H(Y,te){return Y[4]||Y[1].profilePicture?ef:$u}let z=H(s),R=z(s),x=s[2]&&hi(s),W=!s[2]&&pi(s);function q(Y,te){return Y[2]?lf:rf}let j=q(s),G=j(s),Q=s[2]&&mi(s);return{c(){e=y("div"),t=y("div"),n=y("div"),r=y("h2"),a=K(i),l=F(),o=y("button"),o.textContent=u,f=F(),p=y("div"),h=y("div"),g=y("div"),R.c(),m=F(),x&&x.c(),v=F(),T=y("div"),C=y("div"),E=y("span"),E.textContent=S,b=F(),A=y("span"),w=K(I),O=F(),W&&W.c(),N=F(),G.c(),M=F(),Q&&Q.c(),this.h()},l(Y){e=k(Y,"DIV",{class:!0});var te=D(e);t=k(te,"DIV",{class:!0});var fe=D(t);n=k(fe,"DIV",{class:!0});var se=D(n);r=k(se,"H2",{class:!0});var ue=D(r);a=Z(ue,i),ue.forEach(_),l=P(se),o=k(se,"BUTTON",{class:!0,"data-svelte-h":!0}),$(o)!=="svelte-12zniqk"&&(o.textContent=u),se.forEach(_),f=P(fe),p=k(fe,"DIV",{class:!0});var ce=D(p);h=k(ce,"DIV",{class:!0});var le=D(h);g=k(le,"DIV",{class:!0});var he=D(g);R.l(he),he.forEach(_),m=P(le),x&&x.l(le),le.forEach(_),v=P(ce),T=k(ce,"DIV",{class:!0});var Re=D(T);C=k(Re,"DIV",{class:!0});var ae=D(C);E=k(ae,"SPAN",{class:!0,"data-svelte-h":!0}),$(E)!=="svelte-1fffgfa"&&(E.textContent=S),b=P(ae),A=k(ae,"SPAN",{class:!0});var Ve=D(A);w=Z(Ve,I),Ve.forEach(_),ae.forEach(_),Re.forEach(_),O=P(ce),W&&W.l(ce),N=P(ce),G.l(ce),ce.forEach(_),M=P(fe),Q&&Q.l(fe),fe.forEach(_),te.forEach(_),this.h()},h(){d(r,"class","svelte-mn2c16"),d(o,"class","close-btn svelte-mn2c16"),d(n,"class","modal-header svelte-mn2c16"),d(g,"class","profile-picture-container svelte-mn2c16"),d(h,"class","profile-picture-section svelte-mn2c16"),d(E,"class","info-label svelte-mn2c16"),d(A,"class","info-value svelte-mn2c16"),d(C,"class","info-row svelte-mn2c16"),d(T,"class","user-info svelte-mn2c16"),d(p,"class","modal-body svelte-mn2c16"),d(t,"class","modal-content svelte-mn2c16"),d(e,"class","modal-overlay svelte-mn2c16")},m(Y,te){V(Y,e,te),c(e,t),c(t,n),c(n,r),c(r,a),c(n,l),c(n,o),c(t,f),c(t,p),c(p,h),c(h,g),R.m(g,null),c(h,m),x&&x.m(h,null),c(p,v),c(p,T),c(T,C),c(C,E),c(C,b),c(C,A),c(A,w),c(p,O),W&&W.m(p,null),c(p,N),G.m(p,null),c(t,M),Q&&Q.m(t,null),L||(B=[X(o,"click",s[9]),X(t,"click",vt(s[12])),X(e,"click",s[9])],L=!0)},p(Y,te){te&6&&i!==(i=(Y[2]?"Your Profile":Y[1].username)+"")&&ne(a,i),z===(z=H(Y))&&R?R.p(Y,te):(R.d(1),R=z(Y),R&&(R.c(),R.m(g,null))),Y[2]?x?x.p(Y,te):(x=hi(Y),x.c(),x.m(h,null)):x&&(x.d(1),x=null),te&2&&I!==(I=Y[1].username+"")&&ne(w,I),Y[2]?W&&(W.d(1),W=null):W?W.p(Y,te):(W=pi(Y),W.c(),W.m(p,N)),j===(j=q(Y))&&G?G.p(Y,te):(G.d(1),G=j(Y),G&&(G.c(),G.m(p,null))),Y[2]?Q?Q.p(Y,te):(Q=mi(Y),Q.c(),Q.m(t,null)):Q&&(Q.d(1),Q=null)},d(Y){Y&&_(e),R.d(),x&&x.d(),W&&W.d(),G.d(),Q&&Q.d(),L=!1,De(B)}}}function $u(s){let e,t=s[1].username.charAt(0).toUpperCase()+"",n;return{c(){e=y("div"),n=K(t),this.h()},l(r){e=k(r,"DIV",{class:!0,style:!0});var i=D(e);n=Z(i,t),i.forEach(_),this.h()},h(){d(e,"class","profile-picture-placeholder svelte-mn2c16"),Ee(e,"background-color",s[1].color)},m(r,i){V(r,e,i),c(e,n)},p(r,i){i&2&&t!==(t=r[1].username.charAt(0).toUpperCase()+"")&&ne(n,t),i&2&&Ee(e,"background-color",r[1].color)},d(r){r&&_(e)}}}function ef(s){let e,t,n;return{c(){e=y("img"),this.h()},l(r){e=k(r,"IMG",{src:!0,alt:!0,class:!0}),this.h()},h(){Be(e.src,t=s[4]||s[1].profilePicture)||d(e,"src",t),d(e,"alt",n=s[1].username),d(e,"class","profile-picture svelte-mn2c16")},m(r,i){V(r,e,i)},p(r,i){i&18&&!Be(e.src,t=r[4]||r[1].profilePicture)&&d(e,"src",t),i&2&&n!==(n=r[1].username)&&d(e,"alt",n)},d(r){r&&_(e)}}}function hi(s){let e,t,n=s[4]||s[1].profilePicture?"Change Picture":"Upload Picture",r,i,a,l,o;return{c(){e=y("div"),t=y("label"),r=K(n),i=F(),a=y("input"),this.h()},l(u){e=k(u,"DIV",{class:!0});var f=D(e);t=k(f,"LABEL",{for:!0,class:!0});var p=D(t);r=Z(p,n),p.forEach(_),i=P(f),a=k(f,"INPUT",{id:!0,type:!0,accept:!0,class:!0}),f.forEach(_),this.h()},h(){d(t,"for","profile-picture"),d(t,"class","upload-label svelte-mn2c16"),d(a,"id","profile-picture"),d(a,"type","file"),d(a,"accept","image/*"),d(a,"class","file-input svelte-mn2c16"),d(e,"class","upload-section svelte-mn2c16")},m(u,f){V(u,e,f),c(e,t),c(t,r),c(e,i),c(e,a),l||(o=X(a,"change",s[10]),l=!0)},p(u,f){f&18&&n!==(n=u[4]||u[1].profilePicture?"Change Picture":"Upload Picture")&&ne(r,n)},d(u){u&&_(e),l=!1,o()}}}function pi(s){let e,t,n,r="Personal Notes:",i,a,l=!s[6]&&gi(s);function o(p,h){return p[6]?nf:p[5]?sf:tf}let u=o(s),f=u(s);return{c(){e=y("div"),t=y("div"),n=y("label"),n.textContent=r,i=F(),l&&l.c(),a=F(),f.c(),this.h()},l(p){e=k(p,"DIV",{class:!0});var h=D(e);t=k(h,"DIV",{class:!0});var g=D(t);n=k(g,"LABEL",{class:!0,"data-svelte-h":!0}),$(n)!=="svelte-1vz1uda"&&(n.textContent=r),i=P(g),l&&l.l(g),g.forEach(_),a=P(h),f.l(h),h.forEach(_),this.h()},h(){d(n,"class","notes-label svelte-mn2c16"),d(t,"class","notes-header svelte-mn2c16"),d(e,"class","notes-section svelte-mn2c16")},m(p,h){V(p,e,h),c(e,t),c(t,n),c(t,i),l&&l.m(t,null),c(e,a),f.m(e,null)},p(p,h){p[6]?l&&(l.d(1),l=null):l?l.p(p,h):(l=gi(p),l.c(),l.m(t,null)),u===(u=o(p))&&f?f.p(p,h):(f.d(1),f=u(p),f&&(f.c(),f.m(e,null)))},d(p){p&&_(e),l&&l.d(),f.d()}}}function gi(s){let e,t=s[5]?"Edit":"Add Note",n,r,i;return{c(){e=y("button"),n=K(t),this.h()},l(a){e=k(a,"BUTTON",{class:!0});var l=D(e);n=Z(l,t),l.forEach(_),this.h()},h(){d(e,"class","edit-note-btn svelte-mn2c16")},m(a,l){V(a,e,l),c(e,n),r||(i=X(e,"click",s[13]),r=!0)},p(a,l){l&32&&t!==(t=a[5]?"Edit":"Add Note")&&ne(n,t)},d(a){a&&_(e),r=!1,i()}}}function tf(s){let e,t='No notes yet. Click "Add Note" to remember details about this user.';return{c(){e=y("div"),e.textContent=t,this.h()},l(n){e=k(n,"DIV",{class:!0,"data-svelte-h":!0}),$(e)!=="svelte-t39qdr"&&(e.textContent=t),this.h()},h(){d(e,"class","note-placeholder svelte-mn2c16")},m(n,r){V(n,e,r)},p:Ce,d(n){n&&_(e)}}}function sf(s){let e,t;return{c(){e=y("div"),t=K(s[5]),this.h()},l(n){e=k(n,"DIV",{class:!0});var r=D(e);t=Z(r,s[5]),r.forEach(_),this.h()},h(){d(e,"class","note-display svelte-mn2c16")},m(n,r){V(n,e,r),c(e,t)},p(n,r){r&32&&ne(t,n[5])},d(n){n&&_(e)}}}function nf(s){let e,t,n,r,i="Cancel",a,l,o="Save Note",u,f;return{c(){e=y("textarea"),t=F(),n=y("div"),r=y("button"),r.textContent=i,a=F(),l=y("button"),l.textContent=o,this.h()},l(p){e=k(p,"TEXTAREA",{placeholder:!0,class:!0,rows:!0}),D(e).forEach(_),t=P(p),n=k(p,"DIV",{class:!0});var h=D(n);r=k(h,"BUTTON",{class:!0,"data-svelte-h":!0}),$(r)!=="svelte-hulrz8"&&(r.textContent=i),a=P(h),l=k(h,"BUTTON",{class:!0,"data-svelte-h":!0}),$(l)!=="svelte-9d2dbm"&&(l.textContent=o),h.forEach(_),this.h()},h(){d(e,"placeholder","Add personal notes (e.g., nickname, birthday, interests...)"),d(e,"class","note-textarea svelte-mn2c16"),d(e,"rows","3"),d(r,"class","cancel-note-btn svelte-mn2c16"),d(l,"class","save-note-btn svelte-mn2c16"),d(n,"class","note-actions svelte-mn2c16")},m(p,h){V(p,e,h),lt(e,s[5]),V(p,t,h),V(p,n,h),c(n,r),c(n,a),c(n,l),u||(f=[X(e,"input",s[14]),X(r,"click",s[15]),X(l,"click",s[8])],u=!0)},p(p,h){h&32&&lt(e,p[5])},d(p){p&&(_(e),_(t),_(n)),u=!1,De(f)}}}function rf(s){let e,t,n,r,i=s[1].status.charAt(0).toUpperCase()+s[1].status.slice(1)+"",a;return{c(){e=y("div"),t=y("span"),n=F(),r=y("span"),a=K(i),this.h()},l(l){e=k(l,"DIV",{class:!0});var o=D(e);t=k(o,"SPAN",{class:!0,style:!0}),D(t).forEach(_),n=P(o),r=k(o,"SPAN",{class:!0});var u=D(r);a=Z(u,i),u.forEach(_),o.forEach(_),this.h()},h(){d(t,"class","status-dot svelte-mn2c16"),Ee(t,"background-color",tn(s[1].status)),d(r,"class","status-text svelte-mn2c16"),d(e,"class","status-display svelte-mn2c16")},m(l,o){V(l,e,o),c(e,t),c(e,n),c(e,r),c(r,a)},p(l,o){o&2&&Ee(t,"background-color",tn(l[1].status)),o&2&&i!==(i=l[1].status.charAt(0).toUpperCase()+l[1].status.slice(1)+"")&&ne(a,i)},d(l){l&&_(e)}}}function lf(s){let e,t,n="Status:",r,i,a,l,o,u,f,p,h,g,m,v,T,C,E,S,b,A;return{c(){e=y("div"),t=y("label"),t.textContent=n,r=F(),i=y("div"),a=y("button"),l=y("span"),o=K(`\r
								Active`),f=F(),p=y("button"),h=y("span"),g=K(`\r
								Away`),v=F(),T=y("button"),C=y("span"),E=K(`\r
								Busy`),this.h()},l(I){e=k(I,"DIV",{class:!0});var w=D(e);t=k(w,"LABEL",{class:!0,"data-svelte-h":!0}),$(t)!=="svelte-138t5u0"&&(t.textContent=n),r=P(w),i=k(w,"DIV",{class:!0});var O=D(i);a=k(O,"BUTTON",{class:!0});var N=D(a);l=k(N,"SPAN",{class:!0,style:!0}),D(l).forEach(_),o=Z(N,`\r
								Active`),N.forEach(_),f=P(O),p=k(O,"BUTTON",{class:!0});var M=D(p);h=k(M,"SPAN",{class:!0,style:!0}),D(h).forEach(_),g=Z(M,`\r
								Away`),M.forEach(_),v=P(O),T=k(O,"BUTTON",{class:!0});var L=D(T);C=k(L,"SPAN",{class:!0,style:!0}),D(C).forEach(_),E=Z(L,`\r
								Busy`),L.forEach(_),O.forEach(_),w.forEach(_),this.h()},h(){d(t,"class","status-label svelte-mn2c16"),d(l,"class","status-dot svelte-mn2c16"),Ee(l,"background-color",tn("active")),d(a,"class",u="status-btn "+(s[3]==="active"?"selected":"")+" svelte-mn2c16"),d(h,"class","status-dot svelte-mn2c16"),Ee(h,"background-color",tn("away")),d(p,"class",m="status-btn "+(s[3]==="away"?"selected":"")+" svelte-mn2c16"),d(C,"class","status-dot svelte-mn2c16"),Ee(C,"background-color",tn("busy")),d(T,"class",S="status-btn "+(s[3]==="busy"?"selected":"")+" svelte-mn2c16"),d(i,"class","status-options svelte-mn2c16"),d(e,"class","status-section svelte-mn2c16")},m(I,w){V(I,e,w),c(e,t),c(e,r),c(e,i),c(i,a),c(a,l),c(a,o),c(i,f),c(i,p),c(p,h),c(p,g),c(i,v),c(i,T),c(T,C),c(T,E),b||(A=[X(a,"click",s[16]),X(p,"click",s[17]),X(T,"click",s[18])],b=!0)},p(I,w){w&8&&u!==(u="status-btn "+(I[3]==="active"?"selected":"")+" svelte-mn2c16")&&d(a,"class",u),w&8&&m!==(m="status-btn "+(I[3]==="away"?"selected":"")+" svelte-mn2c16")&&d(p,"class",m),w&8&&S!==(S="status-btn "+(I[3]==="busy"?"selected":"")+" svelte-mn2c16")&&d(T,"class",S)},d(I){I&&_(e),b=!1,De(A)}}}function mi(s){let e,t,n="Cancel",r,i,a="Save Changes",l,o;return{c(){e=y("div"),t=y("button"),t.textContent=n,r=F(),i=y("button"),i.textContent=a,this.h()},l(u){e=k(u,"DIV",{class:!0});var f=D(e);t=k(f,"BUTTON",{class:!0,"data-svelte-h":!0}),$(t)!=="svelte-2pqgi7"&&(t.textContent=n),r=P(f),i=k(f,"BUTTON",{class:!0,"data-svelte-h":!0}),$(i)!=="svelte-2yi6cr"&&(i.textContent=a),f.forEach(_),this.h()},h(){d(t,"class","cancel-btn svelte-mn2c16"),d(i,"class","save-btn svelte-mn2c16"),d(e,"class","modal-footer svelte-mn2c16")},m(u,f){V(u,e,f),c(e,t),c(e,r),c(e,i),l||(o=[X(t,"click",s[9]),X(i,"click",s[11])],l=!0)},p:Ce,d(u){u&&_(e),l=!1,De(o)}}}function af(s){let e,t=s[0]&&s[1]&&di(s);return{c(){t&&t.c(),e=Ie()},l(n){t&&t.l(n),e=Ie()},m(n,r){t&&t.m(n,r),V(n,e,r)},p(n,[r]){n[0]&&n[1]?t?t.p(n,r):(t=di(n),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},i:Ce,o:Ce,d(n){n&&_(e),t&&t.d(n)}}}function tn(s){switch(s){case"active":return"var(--status-online)";case"away":return"var(--status-away)";case"busy":return"var(--status-busy)";default:return"var(--status-offline)"}}function of(s,e,t){let{isOpen:n=!1}=e,{user:r=null}=e,{isOwnProfile:i=!1}=e,a=(r==null?void 0:r.status)||"active";r!=null&&r.profilePicture;let l=null,o=null,u="",f=!1;function p(){if(!r)return;const w=JSON.parse(localStorage.getItem("userNotes")||"{}");t(5,u=w[r.id]||"")}function h(){if(!r)return;const w=JSON.parse(localStorage.getItem("userNotes")||"{}");u.trim()?w[r.id]=u:delete w[r.id],localStorage.setItem("userNotes",JSON.stringify(w)),t(6,f=!1)}function g(){t(0,n=!1),l=null,t(4,o=null),t(6,f=!1)}function m(w){var M;const N=(M=w.target.files)==null?void 0:M[0];if(N&&N.type.startsWith("image/")){l=N;const L=new FileReader;L.onload=B=>{var H;t(4,o=(H=B.target)==null?void 0:H.result)},L.readAsDataURL(N)}}function v(){i&&(l&&o?ti(a,o):a!==(r==null?void 0:r.status)&&ti(a,void 0),g())}function T(w){ds.call(this,s,w)}const C=()=>t(6,f=!0);function E(){u=this.value,t(5,u)}const S=()=>{t(6,f=!1),p()},b=()=>t(3,a="active"),A=()=>t(3,a="away"),I=()=>t(3,a="busy");return s.$$set=w=>{"isOpen"in w&&t(0,n=w.isOpen),"user"in w&&t(1,r=w.user),"isOwnProfile"in w&&t(2,i=w.isOwnProfile)},s.$$.update=()=>{s.$$.dirty&2&&r&&(t(3,a=r.status),r.profilePicture,p())},[n,r,i,a,o,u,f,p,h,g,m,v,T,C,E,S,b,A,I]}class Sr extends ct{constructor(e){super(),ut(this,e,of,af,ot,{isOpen:0,user:1,isOwnProfile:2})}}function vi(s){let e,t,n,r=`<span class="menu-icon svelte-n6yq8s">ðŸ’¬</span>
				Reply`,i,a,l,o,u,f,p=s[1].isPinned?"ðŸ“Œ":"ðŸ“",h,g,m=s[1].isPinned?"Unpin":"Pin",v,T,C,E,S=`<span class="menu-icon svelte-n6yq8s">ðŸ“‹</span>
				Copy Text`,b,A,I,w=s[11]&&s[6]&&_i(s),O=s[7]&&bi(s),N=s[12]&&ki(s),M=s[12]&&yi(s);return{c(){e=y("div"),t=y("div"),n=y("button"),n.innerHTML=r,i=F(),w&&w.c(),a=F(),O&&O.c(),l=F(),N&&N.c(),o=F(),u=y("button"),f=y("span"),h=K(p),g=F(),v=K(m),T=K(" Message"),C=F(),E=y("button"),E.innerHTML=S,b=F(),M&&M.c(),this.h()},l(L){e=k(L,"DIV",{class:!0});var B=D(e);t=k(B,"DIV",{class:!0,style:!0});var H=D(t);n=k(H,"BUTTON",{class:!0,"data-svelte-h":!0}),$(n)!=="svelte-1bhlhgs"&&(n.innerHTML=r),i=P(H),w&&w.l(H),a=P(H),O&&O.l(H),l=P(H),N&&N.l(H),o=P(H),u=k(H,"BUTTON",{class:!0});var z=D(u);f=k(z,"SPAN",{class:!0});var R=D(f);h=Z(R,p),R.forEach(_),g=P(z),v=Z(z,m),T=Z(z," Message"),z.forEach(_),C=P(H),E=k(H,"BUTTON",{class:!0,"data-svelte-h":!0}),$(E)!=="svelte-pkfnng"&&(E.innerHTML=S),b=P(H),M&&M.l(H),H.forEach(_),B.forEach(_),this.h()},h(){d(n,"class","menu-item svelte-n6yq8s"),d(f,"class","menu-icon svelte-n6yq8s"),d(u,"class","menu-item svelte-n6yq8s"),d(E,"class","menu-item copy svelte-n6yq8s"),d(t,"class","context-menu svelte-n6yq8s"),Ee(t,"top",s[9]+"px"),Ee(t,"left",s[10]+"px"),d(e,"class","context-menu-overlay svelte-n6yq8s")},m(L,B){V(L,e,B),c(e,t),c(t,n),c(t,i),w&&w.m(t,null),c(t,a),O&&O.m(t,null),c(t,l),N&&N.m(t,null),c(t,o),c(t,u),c(u,f),c(f,h),c(u,g),c(u,v),c(u,T),c(t,C),c(t,E),c(t,b),M&&M.m(t,null),s[18](t),A||(I=[X(n,"click",function(){Is(s[5])&&s[5].apply(this,arguments)}),X(u,"click",function(){Is(s[4])&&s[4].apply(this,arguments)}),X(E,"click",s[17]),X(t,"click",vt(s[16])),X(e,"click",s[19])],A=!0)},p(L,B){s=L,s[11]&&s[6]?w?w.p(s,B):(w=_i(s),w.c(),w.m(t,a)):w&&(w.d(1),w=null),s[7]?O?O.p(s,B):(O=bi(s),O.c(),O.m(t,l)):O&&(O.d(1),O=null),s[12]?N?N.p(s,B):(N=ki(s),N.c(),N.m(t,o)):N&&(N.d(1),N=null),B&2&&p!==(p=s[1].isPinned?"ðŸ“Œ":"ðŸ“")&&ne(h,p),B&2&&m!==(m=s[1].isPinned?"Unpin":"Pin")&&ne(v,m),s[12]?M?M.p(s,B):(M=yi(s),M.c(),M.m(t,null)):M&&(M.d(1),M=null),B&512&&Ee(t,"top",s[9]+"px"),B&1024&&Ee(t,"left",s[10]+"px")},d(L){L&&_(e),w&&w.d(),O&&O.d(),N&&N.d(),M&&M.d(),s[18](null),A=!1,De(I)}}}function _i(s){let e,t=`<span class="menu-icon svelte-n6yq8s">â¬‡ï¸</span>
					Download`,n,r;return{c(){e=y("button"),e.innerHTML=t,this.h()},l(i){e=k(i,"BUTTON",{class:!0,"data-svelte-h":!0}),$(e)!=="svelte-7q5p9o"&&(e.innerHTML=t),this.h()},h(){d(e,"class","menu-item svelte-n6yq8s")},m(i,a){V(i,e,a),n||(r=X(e,"click",function(){Is(s[6])&&s[6].apply(this,arguments)}),n=!0)},p(i,a){s=i},d(i){i&&_(e),n=!1,r()}}}function bi(s){let e,t=`<span class="menu-icon svelte-n6yq8s">â†—ï¸</span>
					Forward`,n,r;return{c(){e=y("button"),e.innerHTML=t,this.h()},l(i){e=k(i,"BUTTON",{class:!0,"data-svelte-h":!0}),$(e)!=="svelte-1d631nw"&&(e.innerHTML=t),this.h()},h(){d(e,"class","menu-item svelte-n6yq8s")},m(i,a){V(i,e,a),n||(r=X(e,"click",function(){Is(s[7])&&s[7].apply(this,arguments)}),n=!0)},p(i,a){s=i},d(i){i&&_(e),n=!1,r()}}}function ki(s){let e,t=`<span class="menu-icon svelte-n6yq8s">âœï¸</span>
					Edit Message`,n,r;return{c(){e=y("button"),e.innerHTML=t,this.h()},l(i){e=k(i,"BUTTON",{class:!0,"data-svelte-h":!0}),$(e)!=="svelte-8fvj6d"&&(e.innerHTML=t),this.h()},h(){d(e,"class","menu-item svelte-n6yq8s")},m(i,a){V(i,e,a),n||(r=X(e,"click",function(){Is(s[2])&&s[2].apply(this,arguments)}),n=!0)},p(i,a){s=i},d(i){i&&_(e),n=!1,r()}}}function yi(s){let e,t,n,r=`<span class="menu-icon svelte-n6yq8s">ðŸ—‘ï¸</span>
					Delete Message`,i,a;return{c(){e=y("div"),t=F(),n=y("button"),n.innerHTML=r,this.h()},l(l){e=k(l,"DIV",{class:!0}),D(e).forEach(_),t=P(l),n=k(l,"BUTTON",{class:!0,"data-svelte-h":!0}),$(n)!=="svelte-g8outl"&&(n.innerHTML=r),this.h()},h(){d(e,"class","menu-divider svelte-n6yq8s"),d(n,"class","menu-item delete svelte-n6yq8s")},m(l,o){V(l,e,o),V(l,t,o),V(l,n,o),i||(a=X(n,"click",function(){Is(s[3])&&s[3].apply(this,arguments)}),i=!0)},p(l,o){s=l},d(l){l&&(_(e),_(t),_(n)),i=!1,a()}}}function cf(s){let e,t=s[0]&&vi(s);return{c(){t&&t.c(),e=Ie()},l(n){t&&t.l(n),e=Ie()},m(n,r){t&&t.m(n,r),V(n,e,r)},p(n,[r]){n[0]?t?t.p(n,r):(t=vi(n),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},i:Ce,o:Ce,d(n){n&&_(e),t&&t.d(n)}}}function uf(s,e,t){let n,r,i,a,l;Ne(s,ns,w=>t(15,l=w));let{message:o}=e,{x:u=0}=e,{y:f=0}=e,{visible:p=!1}=e,{onEdit:h}=e,{onDelete:g}=e,{onPin:m}=e,{onReply:v}=e,{onDownload:T=void 0}=e,{onForward:C=void 0}=e,E;function S(w){ds.call(this,s,w)}const b=()=>{navigator.clipboard.writeText(o.text),t(0,p=!1)};function A(w){st[w?"unshift":"push"](()=>{E=w,t(8,E)})}const I=()=>t(0,p=!1);return s.$$set=w=>{"message"in w&&t(1,o=w.message),"x"in w&&t(13,u=w.x),"y"in w&&t(14,f=w.y),"visible"in w&&t(0,p=w.visible),"onEdit"in w&&t(2,h=w.onEdit),"onDelete"in w&&t(3,g=w.onDelete),"onPin"in w&&t(4,m=w.onPin),"onReply"in w&&t(5,v=w.onReply),"onDownload"in w&&t(6,T=w.onDownload),"onForward"in w&&t(7,C=w.onForward)},s.$$.update=()=>{s.$$.dirty&32770&&t(12,n=o.userId===(l==null?void 0:l.id)),s.$$.dirty&2&&t(11,r=o.type==="file"&&o.fileUrl),s.$$.dirty&8448&&t(10,i=(()=>{if(!E)return u;const w=E.offsetWidth||200,O=window.innerWidth;return u+w>O?u-w:u})()),s.$$.dirty&16640&&t(9,a=(()=>{if(!E)return f;const w=E.offsetHeight||300,O=window.innerHeight;return f+w>O?f-w:f})())},[p,o,h,g,m,v,T,C,E,a,i,r,n,u,f,l,S,b,A,I]}class ff extends ct{constructor(e){super(),ut(this,e,uf,cf,ot,{message:1,x:13,y:14,visible:0,onEdit:2,onDelete:3,onPin:4,onReply:5,onDownload:6,onForward:7})}}function wi(s,e,t){const n=s.slice();return n[9]=e[t],n}function Ei(s){let e,t,n,r,i="Forward Message",a,l,o="âœ•",u,f,p,h="Choose a channel to forward this message to:",g,m,v,T,C=ze(s[2]),E=[];for(let S=0;S<C.length;S+=1)E[S]=Si(wi(s,C,S));return{c(){e=y("div"),t=y("div"),n=y("div"),r=y("h3"),r.textContent=i,a=F(),l=y("button"),l.textContent=o,u=F(),f=y("div"),p=y("p"),p.textContent=h,g=F(),m=y("div");for(let S=0;S<E.length;S+=1)E[S].c();this.h()},l(S){e=k(S,"DIV",{class:!0});var b=D(e);t=k(b,"DIV",{class:!0});var A=D(t);n=k(A,"DIV",{class:!0});var I=D(n);r=k(I,"H3",{class:!0,"data-svelte-h":!0}),$(r)!=="svelte-1xq5ns4"&&(r.textContent=i),a=P(I),l=k(I,"BUTTON",{class:!0,"data-svelte-h":!0}),$(l)!=="svelte-19jqbg1"&&(l.textContent=o),I.forEach(_),u=P(A),f=k(A,"DIV",{class:!0});var w=D(f);p=k(w,"P",{class:!0,"data-svelte-h":!0}),$(p)!=="svelte-alvqmp"&&(p.textContent=h),g=P(w),m=k(w,"DIV",{class:!0});var O=D(m);for(let N=0;N<E.length;N+=1)E[N].l(O);O.forEach(_),w.forEach(_),A.forEach(_),b.forEach(_),this.h()},h(){d(r,"class","svelte-70r9o1"),d(l,"class","close-button svelte-70r9o1"),d(n,"class","dialog-header svelte-70r9o1"),d(p,"class","dialog-description svelte-70r9o1"),d(m,"class","channel-list svelte-70r9o1"),d(f,"class","dialog-content svelte-70r9o1"),d(t,"class","dialog svelte-70r9o1"),d(e,"class","dialog-overlay svelte-70r9o1")},m(S,b){V(S,e,b),c(e,t),c(t,n),c(n,r),c(n,a),c(n,l),c(t,u),c(t,f),c(f,p),c(f,g),c(f,m);for(let A=0;A<E.length;A+=1)E[A]&&E[A].m(m,null);v||(T=[X(l,"click",s[5]),X(t,"click",vt(s[6])),X(e,"click",s[5])],v=!0)},p(S,b){if(b&28){C=ze(S[2]);let A;for(A=0;A<C.length;A+=1){const I=wi(S,C,A);E[A]?E[A].p(I,b):(E[A]=Si(I),E[A].c(),E[A].m(m,null))}for(;A<E.length;A+=1)E[A].d(1);E.length=C.length}},d(S){S&&_(e),Dn(E,S),v=!1,De(T)}}}function Ti(s){let e,t,n,r,i=s[9].name+"",a,l,o,u;function f(m,v){return m[9].type==="dm"?hf:df}let p=f(s),h=p(s);function g(){return s[7](s[9])}return{c(){e=y("button"),t=y("span"),h.c(),n=F(),r=y("span"),a=K(i),l=F(),this.h()},l(m){e=k(m,"BUTTON",{class:!0});var v=D(e);t=k(v,"SPAN",{class:!0});var T=D(t);h.l(T),T.forEach(_),n=P(v),r=k(v,"SPAN",{class:!0});var C=D(r);a=Z(C,i),C.forEach(_),l=P(v),v.forEach(_),this.h()},h(){d(t,"class","channel-icon svelte-70r9o1"),d(r,"class","channel-name svelte-70r9o1"),d(e,"class","channel-item svelte-70r9o1")},m(m,v){V(m,e,v),c(e,t),h.m(t,null),c(e,n),c(e,r),c(r,a),c(e,l),o||(u=X(e,"click",g),o=!0)},p(m,v){s=m,p!==(p=f(s))&&(h.d(1),h=p(s),h&&(h.c(),h.m(t,null))),v&4&&i!==(i=s[9].name+"")&&ne(a,i)},d(m){m&&_(e),h.d(),o=!1,u()}}}function df(s){let e;return{c(){e=K("#")},l(t){e=Z(t,"#")},m(t,n){V(t,e,n)},d(t){t&&_(e)}}}function hf(s){let e;return{c(){e=K("ðŸ’¬")},l(t){e=Z(t,"ðŸ’¬")},m(t,n){V(t,e,n)},d(t){t&&_(e)}}}function Si(s){let e,t=s[9].id!==s[3]&&Ti(s);return{c(){t&&t.c(),e=Ie()},l(n){t&&t.l(n),e=Ie()},m(n,r){t&&t.m(n,r),V(n,e,r)},p(n,r){n[9].id!==n[3]?t?t.p(n,r):(t=Ti(n),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},d(n){n&&_(e),t&&t.d(n)}}}function pf(s){let e,t=s[0]&&s[1]&&Ei(s);return{c(){t&&t.c(),e=Ie()},l(n){t&&t.l(n),e=Ie()},m(n,r){t&&t.m(n,r),V(n,e,r)},p(n,[r]){n[0]&&n[1]?t?t.p(n,r):(t=Ei(n),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},i:Ce,o:Ce,d(n){n&&_(e),t&&t.d(n)}}}function gf(s,e,t){let n,r,i;Ne(s,Vs,h=>t(8,n=h)),Ne(s,us,h=>t(2,r=h)),Ne(s,Os,h=>t(3,i=h));let{visible:a=!1}=e,{message:l=null}=e;function o(h){!l||!n||(n.emit("message",{channelId:h,text:l.text,type:l.type,gifUrl:l.gifUrl,fileUrl:l.fileUrl,fileName:l.fileName,fileSize:l.fileSize,files:l.files}),t(0,a=!1))}function u(){t(0,a=!1)}function f(h){ds.call(this,s,h)}const p=h=>o(h.id);return s.$$set=h=>{"visible"in h&&t(0,a=h.visible),"message"in h&&t(1,l=h.message)},[a,l,r,i,o,u,f,p]}class mf extends ct{constructor(e){super(),ut(this,e,gf,pf,ot,{visible:0,message:1})}}function Ai(s){let e,t,n,r,i,a,l,o="Ã—",u,f,p,h,g,m,v,T,C,E,S,b,A,I;return{c(){e=y("div"),t=y("div"),n=y("div"),r=y("h2"),i=K(s[1]),a=F(),l=y("button"),l.textContent=o,u=F(),f=y("div"),p=y("p"),h=K(s[2]),g=F(),m=y("div"),v=y("button"),T=K(s[4]),C=F(),E=y("button"),S=K(s[3]),this.h()},l(w){e=k(w,"DIV",{class:!0});var O=D(e);t=k(O,"DIV",{class:!0});var N=D(t);n=k(N,"DIV",{class:!0});var M=D(n);r=k(M,"H2",{class:!0});var L=D(r);i=Z(L,s[1]),L.forEach(_),a=P(M),l=k(M,"BUTTON",{class:!0,"data-svelte-h":!0}),$(l)!=="svelte-y9ayml"&&(l.textContent=o),M.forEach(_),u=P(N),f=k(N,"DIV",{class:!0});var B=D(f);p=k(B,"P",{class:!0});var H=D(p);h=Z(H,s[2]),H.forEach(_),B.forEach(_),g=P(N),m=k(N,"DIV",{class:!0});var z=D(m);v=k(z,"BUTTON",{class:!0});var R=D(v);T=Z(R,s[4]),R.forEach(_),C=P(z),E=k(z,"BUTTON",{class:!0});var x=D(E);S=Z(x,s[3]),x.forEach(_),z.forEach(_),N.forEach(_),O.forEach(_),this.h()},h(){d(r,"class","svelte-1myntg4"),d(l,"class","close-btn svelte-1myntg4"),d(n,"class","modal-header svelte-1myntg4"),d(p,"class","svelte-1myntg4"),d(f,"class","modal-body svelte-1myntg4"),d(v,"class","cancel-btn svelte-1myntg4"),d(E,"class",b="confirm-btn "+s[5]+" svelte-1myntg4"),d(m,"class","modal-footer svelte-1myntg4"),d(t,"class","modal-content svelte-1myntg4"),d(e,"class","modal-overlay svelte-1myntg4")},m(w,O){V(w,e,O),c(e,t),c(t,n),c(n,r),c(r,i),c(n,a),c(n,l),c(t,u),c(t,f),c(f,p),c(p,h),c(t,g),c(t,m),c(m,v),c(v,T),c(m,C),c(m,E),c(E,S),A||(I=[X(l,"click",s[7]),X(v,"click",s[7]),X(E,"click",s[6]),X(t,"click",vt(s[10])),X(e,"click",s[7])],A=!0)},p(w,O){O&2&&ne(i,w[1]),O&4&&ne(h,w[2]),O&16&&ne(T,w[4]),O&8&&ne(S,w[3]),O&32&&b!==(b="confirm-btn "+w[5]+" svelte-1myntg4")&&d(E,"class",b)},d(w){w&&_(e),A=!1,De(I)}}}function vf(s){let e,t=s[0]&&Ai(s);return{c(){t&&t.c(),e=Ie()},l(n){t&&t.l(n),e=Ie()},m(n,r){t&&t.m(n,r),V(n,e,r)},p(n,[r]){n[0]?t?t.p(n,r):(t=Ai(n),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},i:Ce,o:Ce,d(n){n&&_(e),t&&t.d(n)}}}function _f(s,e,t){let{isOpen:n=!1}=e,{title:r="Confirm Action"}=e,{message:i="Are you sure you want to proceed?"}=e,{confirmText:a="Confirm"}=e,{cancelText:l="Cancel"}=e,{variant:o="warning"}=e,{onConfirm:u=()=>{}}=e,{onCancel:f=()=>{}}=e;function p(){u()}function h(){f()}function g(v){v.key==="Escape"&&n&&h()}rs(()=>(window.addEventListener("keydown",g),()=>{window.removeEventListener("keydown",g)}));function m(v){ds.call(this,s,v)}return s.$$set=v=>{"isOpen"in v&&t(0,n=v.isOpen),"title"in v&&t(1,r=v.title),"message"in v&&t(2,i=v.message),"confirmText"in v&&t(3,a=v.confirmText),"cancelText"in v&&t(4,l=v.cancelText),"variant"in v&&t(5,o=v.variant),"onConfirm"in v&&t(8,u=v.onConfirm),"onCancel"in v&&t(9,f=v.onCancel)},[n,r,i,a,l,o,p,h,u,f,m]}class Cs extends ct{constructor(e){super(),ut(this,e,_f,vf,ot,{isOpen:0,title:1,message:2,confirmText:3,cancelText:4,variant:5,onConfirm:8,onCancel:9})}}const{window:bf}=Zl;function Ci(s,e,t){const n=s.slice();n[65]=e[t];const r=n[18](n[65].user);n[66]=r;const i=n[32](n[65].replyTo);return n[67]=i,n}function Ii(s,e,t){const n=s.slice();return n[70]=e[t],n[72]=t,n}function Di(s){let e,t="<span>New Messages</span>";return{c(){e=y("div"),e.innerHTML=t,this.h()},l(n){e=k(n,"DIV",{class:!0,"data-svelte-h":!0}),$(e)!=="svelte-1uzyipm"&&(e.innerHTML=t),this.h()},h(){d(e,"class","new-messages-divider svelte-5e601o")},m(n,r){V(n,e,r)},d(n){n&&_(e)}}}function kf(s){let e,t=s[65].user.charAt(0).toUpperCase()+"",n;return{c(){e=y("div"),n=K(t),this.h()},l(r){e=k(r,"DIV",{class:!0,style:!0});var i=D(e);n=Z(i,t),i.forEach(_),this.h()},h(){d(e,"class","avatar-placeholder svelte-5e601o"),Ee(e,"background-color",s[19](s[65].user))},m(r,i){V(r,e,i),c(e,n)},p(r,i){i[0]&1&&t!==(t=r[65].user.charAt(0).toUpperCase()+"")&&ne(n,t),i[0]&1&&Ee(e,"background-color",r[19](r[65].user))},d(r){r&&_(e)}}}function yf(s){let e,t,n;return{c(){e=y("img"),this.h()},l(r){e=k(r,"IMG",{src:!0,alt:!0,class:!0}),this.h()},h(){Be(e.src,t=s[66].profilePicture)||d(e,"src",t),d(e,"alt",n=s[65].user),d(e,"class","avatar svelte-5e601o")},m(r,i){V(r,e,i)},p(r,i){i[0]&1&&!Be(e.src,t=r[66].profilePicture)&&d(e,"src",t),i[0]&1&&n!==(n=r[65].user)&&d(e,"alt",n)},d(r){r&&_(e)}}}function wf(s){let e,t=s[65].user+"",n;return{c(){e=y("span"),n=K(t),this.h()},l(r){e=k(r,"SPAN",{class:!0});var i=D(e);n=Z(i,t),i.forEach(_),this.h()},h(){d(e,"class","username svelte-5e601o")},m(r,i){V(r,e,i),c(e,n)},p(r,i){i[0]&1&&t!==(t=r[65].user+"")&&ne(n,t)},d(r){r&&_(e)}}}function Ef(s){let e,t=s[65].user+"",n,r,i;function a(){return s[42](s[66])}return{c(){e=y("button"),n=K(t),this.h()},l(l){e=k(l,"BUTTON",{class:!0});var o=D(e);n=Z(o,t),o.forEach(_),this.h()},h(){d(e,"class","username svelte-5e601o")},m(l,o){V(l,e,o),c(e,n),r||(i=X(e,"click",a),r=!0)},p(l,o){s=l,o[0]&1&&t!==(t=s[65].user+"")&&ne(n,t)},d(l){l&&_(e),r=!1,i()}}}function Oi(s){let e,t="ðŸ“Œ";return{c(){e=y("span"),e.textContent=t,this.h()},l(n){e=k(n,"SPAN",{class:!0,title:!0,"data-svelte-h":!0}),$(e)!=="svelte-cawwa1"&&(e.textContent=t),this.h()},h(){d(e,"class","pin-badge svelte-5e601o"),d(e,"title","Pinned message")},m(n,r){V(n,e,r)},d(n){n&&_(e)}}}function Ni(s){let e,t="(edited)";return{c(){e=y("span"),e.textContent=t,this.h()},l(n){e=k(n,"SPAN",{class:!0,title:!0,"data-svelte-h":!0}),$(e)!=="svelte-13y41lm"&&(e.textContent=t),this.h()},h(){d(e,"class","edited-badge svelte-5e601o"),d(e,"title","Edited")},m(n,r){V(n,e,r)},d(n){n&&_(e)}}}function Ri(s){let e,t,n,r,i,a=s[67].user+"",l,o,u,f=s[67].text.substring(0,100)+"",p,h=s[67].text.length>100?"...":"",g;return{c(){e=y("div"),t=y("div"),n=F(),r=y("div"),i=y("span"),l=K(a),o=F(),u=y("span"),p=K(f),g=K(h),this.h()},l(m){e=k(m,"DIV",{class:!0});var v=D(e);t=k(v,"DIV",{class:!0}),D(t).forEach(_),n=P(v),r=k(v,"DIV",{class:!0});var T=D(r);i=k(T,"SPAN",{class:!0});var C=D(i);l=Z(C,a),C.forEach(_),o=P(T),u=k(T,"SPAN",{class:!0});var E=D(u);p=Z(E,f),g=Z(E,h),E.forEach(_),T.forEach(_),v.forEach(_),this.h()},h(){d(t,"class","reply-line svelte-5e601o"),d(i,"class","reply-username svelte-5e601o"),d(u,"class","reply-text svelte-5e601o"),d(r,"class","reply-content svelte-5e601o"),d(e,"class","reply-preview svelte-5e601o")},m(m,v){V(m,e,v),c(e,t),c(e,n),c(e,r),c(r,i),c(i,l),c(r,o),c(r,u),c(u,p),c(u,g)},p(m,v){v[0]&1&&a!==(a=m[67].user+"")&&ne(l,a),v[0]&1&&f!==(f=m[67].text.substring(0,100)+"")&&ne(p,f),v[0]&1&&h!==(h=m[67].text.length>100?"...":"")&&ne(g,h)},d(m){m&&_(e)}}}function Tf(s){let e;function t(i,a){return i[65].type==="gif"&&i[65].gifUrl?If:i[65].type==="file"&&(i[65].fileUrl||i[65].files)?Cf:Af}let n=t(s),r=n(s);return{c(){e=y("div"),r.c(),this.h()},l(i){e=k(i,"DIV",{class:!0});var a=D(e);r.l(a),a.forEach(_),this.h()},h(){d(e,"class","message-content")},m(i,a){V(i,e,a),r.m(e,null)},p(i,a){n===(n=t(i))&&r?r.p(i,a):(r.d(1),r=n(i),r&&(r.c(),r.m(e,null)))},d(i){i&&_(e),r.d()}}}function Sf(s){let e,t,n,r,i,a="Cancel",l,o,u="Save",f,p;function h(...m){return s[44](s[65],...m)}function g(){return s[45](s[65])}return{c(){e=y("div"),t=y("textarea"),n=F(),r=y("div"),i=y("button"),i.textContent=a,l=F(),o=y("button"),o.textContent=u,this.h()},l(m){e=k(m,"DIV",{class:!0});var v=D(e);t=k(v,"TEXTAREA",{class:!0,rows:!0}),D(t).forEach(_),n=P(v),r=k(v,"DIV",{class:!0});var T=D(r);i=k(T,"BUTTON",{class:!0,"data-svelte-h":!0}),$(i)!=="svelte-1czerce"&&(i.textContent=a),l=P(T),o=k(T,"BUTTON",{class:!0,"data-svelte-h":!0}),$(o)!=="svelte-w3glyi"&&(o.textContent=u),T.forEach(_),v.forEach(_),this.h()},h(){d(t,"class","edit-textarea svelte-5e601o"),d(t,"rows","3"),d(i,"class","edit-cancel svelte-5e601o"),d(o,"class","edit-save svelte-5e601o"),d(r,"class","edit-actions svelte-5e601o"),d(e,"class","edit-mode svelte-5e601o")},m(m,v){V(m,e,v),c(e,t),lt(t,s[10]),c(e,n),c(e,r),c(r,i),c(r,l),c(r,o),f||(p=[X(t,"input",s[43]),X(t,"keydown",h),X(i,"click",s[24]),X(o,"click",g)],f=!0)},p(m,v){s=m,v[0]&1024&&lt(t,s[10])},d(m){m&&_(e),f=!1,De(p)}}}function Af(s){let e,t,n=Sn(s[65].text)+"";return{c(){e=y("div"),t=new Wl(!1),this.h()},l(r){e=k(r,"DIV",{class:!0});var i=D(e);t=Gl(i,!1),i.forEach(_),this.h()},h(){t.a=null,d(e,"class","markdown-content svelte-5e601o")},m(r,i){V(r,e,i),t.m(n,e)},p(r,i){i[0]&1&&n!==(n=Sn(r[65].text)+"")&&t.p(n)},d(r){r&&_(e)}}}function Cf(s){let e,t;function n(l,o){if(l[65].files&&l[65].files.length>1)return Of;if(l[65].fileUrl)return Df}let r=n(s),i=r&&r(s),a=s[65].text&&(s[65].files?s[65].text!==`Shared ${s[65].files.length} files`:s[65].text!==`Shared: ${s[65].fileName}`)&&Mi(s);return{c(){i&&i.c(),e=F(),a&&a.c(),t=Ie()},l(l){i&&i.l(l),e=P(l),a&&a.l(l),t=Ie()},m(l,o){i&&i.m(l,o),V(l,e,o),a&&a.m(l,o),V(l,t,o)},p(l,o){r===(r=n(l))&&i?i.p(l,o):(i&&i.d(1),i=r&&r(l),i&&(i.c(),i.m(e.parentNode,e))),l[65].text&&(l[65].files?l[65].text!==`Shared ${l[65].files.length} files`:l[65].text!==`Shared: ${l[65].fileName}`)?a?a.p(l,o):(a=Mi(l),a.c(),a.m(t.parentNode,t)):a&&(a.d(1),a=null)},d(l){l&&(_(e),_(t)),i&&i.d(l),a&&a.d(l)}}}function If(s){let e,t,n,r;return{c(){e=y("img"),this.h()},l(i){e=k(i,"IMG",{src:!0,alt:!0,class:!0,"data-spoiler":!0}),this.h()},h(){Be(e.src,t=s[65].gifUrl)||d(e,"src",t),d(e,"alt","GIF"),d(e,"class",n="gif "+(s[65].isSpoiler?"spoiler":"")+" svelte-5e601o"),d(e,"data-spoiler",r=s[65].isSpoiler?"true":"false")},m(i,a){V(i,e,a)},p(i,a){a[0]&1&&!Be(e.src,t=i[65].gifUrl)&&d(e,"src",t),a[0]&1&&n!==(n="gif "+(i[65].isSpoiler?"spoiler":"")+" svelte-5e601o")&&d(e,"class",n),a[0]&1&&r!==(r=i[65].isSpoiler?"true":"false")&&d(e,"data-spoiler",r)},d(i){i&&_(e)}}}function Df(s){let e,t,n;function r(l,o){return o[0]&1&&(e=null),o[0]&1&&(t=null),e==null&&(e=!!Ar(l[65].fileName)),e?Pf:(t==null&&(t=!!Ma(l[65].fileName)),t?Rf:Nf)}let i=r(s,[-1,-1,-1]),a=i(s);return{c(){a.c(),n=Ie()},l(l){a.l(l),n=Ie()},m(l,o){a.m(l,o),V(l,n,o)},p(l,o){i===(i=r(l,o))&&a?a.p(l,o):(a.d(1),a=i(l),a&&(a.c(),a.m(n.parentNode,n)))},d(l){l&&_(n),a.d(l)}}}function Of(s){let e,t=ze(s[65].files.slice(0,4)),n=[];for(let r=0;r<t.length;r+=1)n[r]=Li(Ii(s,t,r));return{c(){e=y("div");for(let r=0;r<n.length;r+=1)n[r].c();this.h()},l(r){e=k(r,"DIV",{class:!0});var i=D(e);for(let a=0;a<n.length;a+=1)n[a].l(i);i.forEach(_),this.h()},h(){d(e,"class","files-gallery svelte-5e601o"),me(e,"has-more",s[65].files.length>4)},m(r,i){V(r,e,i);for(let a=0;a<n.length;a+=1)n[a]&&n[a].m(e,null)},p(r,i){if(i[0]&1|i[1]&68){t=ze(r[65].files.slice(0,4));let a;for(a=0;a<t.length;a+=1){const l=Ii(r,t,a);n[a]?n[a].p(l,i):(n[a]=Li(l),n[a].c(),n[a].m(e,null))}for(;a<n.length;a+=1)n[a].d(1);n.length=t.length}i[0]&1&&me(e,"has-more",r[65].files.length>4)},d(r){r&&_(e),Dn(n,r)}}}function Nf(s){let e,t,n=ms(s[65].fileName)+"",r,i,a,l,o=s[65].fileName+"",u,f,p,h=gs(s[65].fileSize)+"",g,m,v;return{c(){e=y("a"),t=y("span"),r=K(n),i=F(),a=y("div"),l=y("span"),u=K(o),f=F(),p=y("span"),g=K(h),this.h()},l(T){e=k(T,"A",{href:!0,download:!0,class:!0});var C=D(e);t=k(C,"SPAN",{class:!0});var E=D(t);r=Z(E,n),E.forEach(_),i=P(C),a=k(C,"DIV",{class:!0});var S=D(a);l=k(S,"SPAN",{class:!0});var b=D(l);u=Z(b,o),b.forEach(_),f=P(S),p=k(S,"SPAN",{class:!0});var A=D(p);g=Z(A,h),A.forEach(_),S.forEach(_),C.forEach(_),this.h()},h(){d(t,"class","file-icon svelte-5e601o"),d(l,"class","file-name svelte-5e601o"),d(p,"class","file-size svelte-5e601o"),d(a,"class","file-info svelte-5e601o"),d(e,"href",m=$e(s[65].fileUrl)),d(e,"download",v=s[65].fileName),d(e,"class","file-attachment svelte-5e601o")},m(T,C){V(T,e,C),c(e,t),c(t,r),c(e,i),c(e,a),c(a,l),c(l,u),c(a,f),c(a,p),c(p,g)},p(T,C){C[0]&1&&n!==(n=ms(T[65].fileName)+"")&&ne(r,n),C[0]&1&&o!==(o=T[65].fileName+"")&&ne(u,o),C[0]&1&&h!==(h=gs(T[65].fileSize)+"")&&ne(g,h),C[0]&1&&m!==(m=$e(T[65].fileUrl))&&d(e,"href",m),C[0]&1&&v!==(v=T[65].fileName)&&d(e,"download",v)},d(T){T&&_(e)}}}function Rf(s){let e,t,n,r,i,a,l,o,u,f,p,h=ms(s[65].fileName)+"",g,m,v=s[65].fileName+"",T,C,E,S,b=gs(s[65].fileSize)+"",A,I,w,O,N,M;function L(...H){return s[50](s[65],...H)}function B(...H){return s[51](s[65],...H)}return{c(){e=y("div"),t=y("video"),n=y("source"),a=K(`\r
									Your browser does not support the video tag.`),u=F(),f=y("a"),p=y("span"),g=K(h),m=F(),T=K(v),C=F(),E=y("span"),S=K("("),A=K(b),I=K(")"),this.h()},l(H){e=k(H,"DIV",{class:!0});var z=D(e);t=k(z,"VIDEO",{class:!0,"data-spoiler":!0,title:!0});var R=D(t);n=k(R,"SOURCE",{src:!0,type:!0}),a=Z(R,`\r
									Your browser does not support the video tag.`),R.forEach(_),u=P(z),f=k(z,"A",{href:!0,download:!0,class:!0});var x=D(f);p=k(x,"SPAN",{class:!0});var W=D(p);g=Z(W,h),W.forEach(_),m=P(x),T=Z(x,v),C=P(x),E=k(x,"SPAN",{class:!0});var q=D(E);S=Z(q,"("),A=Z(q,b),I=Z(q,")"),q.forEach(_),x.forEach(_),z.forEach(_),this.h()},h(){var H;Be(n.src,r=$e(s[65].fileUrl))||d(n,"src",r),d(n,"type",i="video/"+((H=s[65].fileName)==null?void 0:H.split(".").pop())),t.controls=!0,d(t,"class",l="inline-video "+(s[65].isSpoiler?"spoiler":"")+" svelte-5e601o"),d(t,"data-spoiler",o=s[65].isSpoiler?"true":"false"),d(t,"title","Click to enlarge, right-click for options"),d(p,"class","file-icon svelte-5e601o"),d(E,"class","file-size svelte-5e601o"),d(f,"href",w=$e(s[65].fileUrl)),d(f,"download",O=s[65].fileName),d(f,"class","video-download-link svelte-5e601o"),d(e,"class","video-container svelte-5e601o")},m(H,z){V(H,e,z),c(e,t),c(t,n),c(t,a),c(e,u),c(e,f),c(f,p),c(p,g),c(f,m),c(f,T),c(f,C),c(f,E),c(E,S),c(E,A),c(E,I),N||(M=[X(t,"click",L),X(t,"contextmenu",B)],N=!0)},p(H,z){var R;s=H,z[0]&1&&!Be(n.src,r=$e(s[65].fileUrl))&&d(n,"src",r),z[0]&1&&i!==(i="video/"+((R=s[65].fileName)==null?void 0:R.split(".").pop()))&&d(n,"type",i),z[0]&1&&l!==(l="inline-video "+(s[65].isSpoiler?"spoiler":"")+" svelte-5e601o")&&d(t,"class",l),z[0]&1&&o!==(o=s[65].isSpoiler?"true":"false")&&d(t,"data-spoiler",o),z[0]&1&&h!==(h=ms(s[65].fileName)+"")&&ne(g,h),z[0]&1&&v!==(v=s[65].fileName+"")&&ne(T,v),z[0]&1&&b!==(b=gs(s[65].fileSize)+"")&&ne(A,b),z[0]&1&&w!==(w=$e(s[65].fileUrl))&&d(f,"href",w),z[0]&1&&O!==(O=s[65].fileName)&&d(f,"download",O)},d(H){H&&_(e),N=!1,De(M)}}}function Pf(s){let e,t,n,r,i,a,l,o,u,f=ms(s[65].fileName)+"",p,h,g=s[65].fileName+"",m,v,T,C,E=gs(s[65].fileSize)+"",S,b,A,I,w,O;function N(...L){return s[48](s[65],...L)}function M(...L){return s[49](s[65],...L)}return{c(){e=y("div"),t=y("img"),l=F(),o=y("a"),u=y("span"),p=K(f),h=F(),m=K(g),v=F(),T=y("span"),C=K("("),S=K(E),b=K(")"),this.h()},l(L){e=k(L,"DIV",{class:!0});var B=D(e);t=k(B,"IMG",{src:!0,alt:!0,class:!0,"data-spoiler":!0,title:!0}),l=P(B),o=k(B,"A",{href:!0,download:!0,class:!0});var H=D(o);u=k(H,"SPAN",{class:!0});var z=D(u);p=Z(z,f),z.forEach(_),h=P(H),m=Z(H,g),v=P(H),T=k(H,"SPAN",{class:!0});var R=D(T);C=Z(R,"("),S=Z(R,E),b=Z(R,")"),R.forEach(_),H.forEach(_),B.forEach(_),this.h()},h(){Be(t.src,n=$e(s[65].fileUrl))||d(t,"src",n),d(t,"alt",r=s[65].fileName),d(t,"class",i="inline-image "+(s[65].isSpoiler?"spoiler":"")+" svelte-5e601o"),d(t,"data-spoiler",a=s[65].isSpoiler?"true":"false"),d(t,"title","Click to enlarge, right-click for options"),d(u,"class","file-icon svelte-5e601o"),d(T,"class","file-size svelte-5e601o"),d(o,"href",A=$e(s[65].fileUrl)),d(o,"download",I=s[65].fileName),d(o,"class","image-download-link svelte-5e601o"),d(e,"class","image-container svelte-5e601o")},m(L,B){V(L,e,B),c(e,t),c(e,l),c(e,o),c(o,u),c(u,p),c(o,h),c(o,m),c(o,v),c(o,T),c(T,C),c(T,S),c(T,b),w||(O=[X(t,"click",N),X(t,"contextmenu",M)],w=!0)},p(L,B){s=L,B[0]&1&&!Be(t.src,n=$e(s[65].fileUrl))&&d(t,"src",n),B[0]&1&&r!==(r=s[65].fileName)&&d(t,"alt",r),B[0]&1&&i!==(i="inline-image "+(s[65].isSpoiler?"spoiler":"")+" svelte-5e601o")&&d(t,"class",i),B[0]&1&&a!==(a=s[65].isSpoiler?"true":"false")&&d(t,"data-spoiler",a),B[0]&1&&f!==(f=ms(s[65].fileName)+"")&&ne(p,f),B[0]&1&&g!==(g=s[65].fileName+"")&&ne(m,g),B[0]&1&&E!==(E=gs(s[65].fileSize)+"")&&ne(S,E),B[0]&1&&A!==(A=$e(s[65].fileUrl))&&d(o,"href",A),B[0]&1&&I!==(I=s[65].fileName)&&d(o,"download",I)},d(L){L&&_(e),w=!1,De(O)}}}function Ff(s){let e,t,n=ms(s[70].fileName)+"",r,i,a,l,o=s[70].fileName+"",u,f,p,h,g=gs(s[70].fileSize)+"",m,v,T,C,E;return{c(){e=y("a"),t=y("div"),r=K(n),i=F(),a=y("div"),l=y("span"),u=K(o),f=F(),p=y("span"),h=K("("),m=K(g),v=K(")"),T=F(),this.h()},l(S){e=k(S,"A",{href:!0,download:!0,class:!0});var b=D(e);t=k(b,"DIV",{class:!0});var A=D(t);r=Z(A,n),A.forEach(_),i=P(b),a=k(b,"DIV",{class:!0});var I=D(a);l=k(I,"SPAN",{class:!0});var w=D(l);u=Z(w,o),w.forEach(_),f=P(I),p=k(I,"SPAN",{class:!0});var O=D(p);h=Z(O,"("),m=Z(O,g),v=Z(O,")"),O.forEach(_),I.forEach(_),T=P(b),b.forEach(_),this.h()},h(){d(t,"class","gallery-file-icon-large svelte-5e601o"),d(l,"class","file-name-truncate svelte-5e601o"),d(p,"class","file-size-small svelte-5e601o"),d(a,"class","gallery-file-overlay svelte-5e601o"),d(e,"href",C=$e(s[70].fileUrl)),d(e,"download",E=s[70].fileName),d(e,"class","gallery-file-item file-link svelte-5e601o")},m(S,b){V(S,e,b),c(e,t),c(t,r),c(e,i),c(e,a),c(a,l),c(l,u),c(a,f),c(a,p),c(p,h),c(p,m),c(p,v),c(e,T)},p(S,b){b[0]&1&&n!==(n=ms(S[70].fileName)+"")&&ne(r,n),b[0]&1&&o!==(o=S[70].fileName+"")&&ne(u,o),b[0]&1&&g!==(g=gs(S[70].fileSize)+"")&&ne(m,g),b[0]&1&&C!==(C=$e(S[70].fileUrl))&&d(e,"href",C),b[0]&1&&E!==(E=S[70].fileName)&&d(e,"download",E)},d(S){S&&_(e)}}}function Lf(s){let e,t,n,r,i,a,l,o,u,f;function p(...g){return s[47](s[70],...g)}let h=s[72]===3&&s[65].files.length>4&&Pi(s);return{c(){e=y("div"),t=y("video"),n=y("source"),l=F(),h&&h.c(),o=F(),this.h()},l(g){e=k(g,"DIV",{class:!0});var m=D(e);t=k(m,"VIDEO",{class:!0,"data-spoiler":!0,title:!0});var v=D(t);n=k(v,"SOURCE",{src:!0}),v.forEach(_),l=P(m),h&&h.l(m),o=P(m),m.forEach(_),this.h()},h(){Be(n.src,r=$e(s[70].fileUrl))||d(n,"src",r),d(t,"class",i="gallery-file-video "+(s[65].isSpoiler?"spoiler":"")+" svelte-5e601o"),d(t,"data-spoiler",a=s[65].isSpoiler?"true":"false"),d(t,"title","Click to enlarge"),d(e,"class","gallery-file-item svelte-5e601o"),me(e,"last-item",s[72]===3&&s[65].files.length>4)},m(g,m){V(g,e,m),c(e,t),c(t,n),c(e,l),h&&h.m(e,null),c(e,o),u||(f=X(t,"click",p),u=!0)},p(g,m){s=g,m[0]&1&&!Be(n.src,r=$e(s[70].fileUrl))&&d(n,"src",r),m[0]&1&&i!==(i="gallery-file-video "+(s[65].isSpoiler?"spoiler":"")+" svelte-5e601o")&&d(t,"class",i),m[0]&1&&a!==(a=s[65].isSpoiler?"true":"false")&&d(t,"data-spoiler",a),s[72]===3&&s[65].files.length>4?h?h.p(s,m):(h=Pi(s),h.c(),h.m(e,o)):h&&(h.d(1),h=null),m[0]&1&&me(e,"last-item",s[72]===3&&s[65].files.length>4)},d(g){g&&_(e),h&&h.d(),u=!1,f()}}}function Mf(s){let e,t,n,r,i,a,l,o,u,f;function p(...g){return s[46](s[65],s[70],...g)}let h=s[72]===3&&s[65].files.length>4&&Fi(s);return{c(){e=y("div"),t=y("img"),l=F(),h&&h.c(),o=F(),this.h()},l(g){e=k(g,"DIV",{class:!0});var m=D(e);t=k(m,"IMG",{src:!0,alt:!0,class:!0,"data-spoiler":!0,title:!0}),l=P(m),h&&h.l(m),o=P(m),m.forEach(_),this.h()},h(){Be(t.src,n=$e(s[70].fileUrl))||d(t,"src",n),d(t,"alt",r=s[70].fileName),d(t,"class",i="gallery-file-image "+(s[65].isSpoiler?"spoiler":"")+" svelte-5e601o"),d(t,"data-spoiler",a=s[65].isSpoiler?"true":"false"),d(t,"title","Click to enlarge"),d(e,"class","gallery-file-item svelte-5e601o"),me(e,"last-item",s[72]===3&&s[65].files.length>4)},m(g,m){V(g,e,m),c(e,t),c(e,l),h&&h.m(e,null),c(e,o),u||(f=X(t,"click",p),u=!0)},p(g,m){s=g,m[0]&1&&!Be(t.src,n=$e(s[70].fileUrl))&&d(t,"src",n),m[0]&1&&r!==(r=s[70].fileName)&&d(t,"alt",r),m[0]&1&&i!==(i="gallery-file-image "+(s[65].isSpoiler?"spoiler":"")+" svelte-5e601o")&&d(t,"class",i),m[0]&1&&a!==(a=s[65].isSpoiler?"true":"false")&&d(t,"data-spoiler",a),s[72]===3&&s[65].files.length>4?h?h.p(s,m):(h=Fi(s),h.c(),h.m(e,o)):h&&(h.d(1),h=null),m[0]&1&&me(e,"last-item",s[72]===3&&s[65].files.length>4)},d(g){g&&_(e),h&&h.d(),u=!1,f()}}}function Pi(s){let e,t,n,r=s[65].files.length-4+"",i;return{c(){e=y("div"),t=y("span"),n=K("+"),i=K(r),this.h()},l(a){e=k(a,"DIV",{class:!0});var l=D(e);t=k(l,"SPAN",{class:!0});var o=D(t);n=Z(o,"+"),i=Z(o,r),o.forEach(_),l.forEach(_),this.h()},h(){d(t,"class","more-count svelte-5e601o"),d(e,"class","more-overlay svelte-5e601o")},m(a,l){V(a,e,l),c(e,t),c(t,n),c(t,i)},p(a,l){l[0]&1&&r!==(r=a[65].files.length-4+"")&&ne(i,r)},d(a){a&&_(e)}}}function Fi(s){let e,t,n,r=s[65].files.length-4+"",i;return{c(){e=y("div"),t=y("span"),n=K("+"),i=K(r),this.h()},l(a){e=k(a,"DIV",{class:!0});var l=D(e);t=k(l,"SPAN",{class:!0});var o=D(t);n=Z(o,"+"),i=Z(o,r),o.forEach(_),l.forEach(_),this.h()},h(){d(t,"class","more-count svelte-5e601o"),d(e,"class","more-overlay svelte-5e601o")},m(a,l){V(a,e,l),c(e,t),c(t,n),c(t,i)},p(a,l){l[0]&1&&r!==(r=a[65].files.length-4+"")&&ne(i,r)},d(a){a&&_(e)}}}function Li(s){let e,t,n;function r(l,o){return o[0]&1&&(e=null),o[0]&1&&(t=null),e==null&&(e=!!Ar(l[70].fileName)),e?Mf:(t==null&&(t=!!Ma(l[70].fileName)),t?Lf:Ff)}let i=r(s,[-1,-1,-1]),a=i(s);return{c(){a.c(),n=Ie()},l(l){a.l(l),n=Ie()},m(l,o){a.m(l,o),V(l,n,o)},p(l,o){i===(i=r(l,o))&&a?a.p(l,o):(a.d(1),a=i(l),a&&(a.c(),a.m(n.parentNode,n)))},d(l){l&&_(n),a.d(l)}}}function Mi(s){let e,t,n=Sn(s[65].text)+"";return{c(){e=y("div"),t=new Wl(!1),this.h()},l(r){e=k(r,"DIV",{class:!0});var i=D(e);t=Gl(i,!1),i.forEach(_),this.h()},h(){t.a=null,d(e,"class","markdown-content svelte-5e601o")},m(r,i){V(r,e,i),t.m(n,e)},p(r,i){i[0]&1&&n!==(n=Sn(r[65].text)+"")&&t.p(n)},d(r){r&&_(e)}}}function xi(s,e){let t,n,r,i,a,l,o,u,f,p,h,g,m=qi(e[65].timestamp)+"",v,T,C,E,S,b,A=e[1]===e[65].id&&Di();function I(j,G){var Q;return(Q=j[66])!=null&&Q.profilePicture?yf:kf}let w=I(e),O=w(e);function N(j,G){return j[66]?Ef:wf}let M=N(e),L=M(e),B=e[65].isPinned&&Oi(),H=e[65].isEdited&&Ni(),z=e[67]&&Ri(e);function R(j,G){return j[9]===j[65].id?Sf:Tf}let x=R(e),W=x(e);function q(...j){return e[52](e[65],...j)}return{key:s,first:null,c(){t=Ie(),A&&A.c(),n=F(),r=y("div"),i=y("div"),O.c(),a=F(),l=y("div"),o=y("div"),u=y("div"),L.c(),f=F(),B&&B.c(),p=F(),H&&H.c(),h=F(),g=y("span"),v=K(m),T=F(),z&&z.c(),C=F(),W.c(),this.h()},l(j){t=Ie(),A&&A.l(j),n=P(j),r=k(j,"DIV",{class:!0});var G=D(r);i=k(G,"DIV",{class:!0});var Q=D(i);O.l(Q),Q.forEach(_),a=P(G),l=k(G,"DIV",{class:!0});var Y=D(l);o=k(Y,"DIV",{class:!0});var te=D(o);u=k(te,"DIV",{class:!0});var fe=D(u);L.l(fe),f=P(fe),B&&B.l(fe),p=P(fe),H&&H.l(fe),fe.forEach(_),h=P(te),g=k(te,"SPAN",{class:!0});var se=D(g);v=Z(se,m),se.forEach(_),te.forEach(_),T=P(Y),z&&z.l(Y),C=P(Y),W.l(Y),Y.forEach(_),G.forEach(_),this.h()},h(){d(i,"class","message-avatar svelte-5e601o"),d(u,"class","header-left svelte-5e601o"),d(g,"class","timestamp svelte-5e601o"),d(o,"class","message-header svelte-5e601o"),d(l,"class","message-body svelte-5e601o"),d(r,"class",E="message "+(e[65].isPinned?"pinned":"")+" svelte-5e601o"),this.first=t},m(j,G){V(j,t,G),A&&A.m(j,G),V(j,n,G),V(j,r,G),c(r,i),O.m(i,null),c(r,a),c(r,l),c(l,o),c(o,u),L.m(u,null),c(u,f),B&&B.m(u,null),c(u,p),H&&H.m(u,null),c(o,h),c(o,g),c(g,v),c(l,T),z&&z.m(l,null),c(l,C),W.m(l,null),S||(b=X(r,"contextmenu",q),S=!0)},p(j,G){e=j,e[1]===e[65].id?A||(A=Di(),A.c(),A.m(n.parentNode,n)):A&&(A.d(1),A=null),w===(w=I(e))&&O?O.p(e,G):(O.d(1),O=w(e),O&&(O.c(),O.m(i,null))),M===(M=N(e))&&L?L.p(e,G):(L.d(1),L=M(e),L&&(L.c(),L.m(u,f))),e[65].isPinned?B||(B=Oi(),B.c(),B.m(u,p)):B&&(B.d(1),B=null),e[65].isEdited?H||(H=Ni(),H.c(),H.m(u,null)):H&&(H.d(1),H=null),G[0]&1&&m!==(m=qi(e[65].timestamp)+"")&&ne(v,m),e[67]?z?z.p(e,G):(z=Ri(e),z.c(),z.m(l,C)):z&&(z.d(1),z=null),x===(x=R(e))&&W?W.p(e,G):(W.d(1),W=x(e),W&&(W.c(),W.m(l,null))),G[0]&1&&E!==(E="message "+(e[65].isPinned?"pinned":"")+" svelte-5e601o")&&d(r,"class",E)},d(j){j&&(_(t),_(n),_(r)),A&&A.d(j),O.d(),L.d(),B&&B.d(),H&&H.d(),z&&z.d(),W.d(),S=!1,b()}}}function Ui(s){let e,t,n;function r(a){s[55](a)}let i={message:s[8],x:s[6],y:s[7],onEdit:s[22],onDelete:s[25],onPin:s[27],onReply:s[28],onDownload:s[29],onForward:s[30]};return s[5]!==void 0&&(i.visible=s[5]),e=new ff({props:i}),st.push(()=>Lt(e,"visible",r)),{c(){Ye(e.$$.fragment)},l(a){We(e.$$.fragment,a)},m(a,l){Ge(e,a,l),n=!0},p(a,l){const o={};l[0]&256&&(o.message=a[8]),l[0]&64&&(o.x=a[6]),l[0]&128&&(o.y=a[7]),!t&&l[0]&32&&(t=!0,o.visible=a[5],Ft(()=>t=!1)),e.$set(o)},i(a){n||(ke(e.$$.fragment,a),n=!0)},o(a){Ae(e.$$.fragment,a),n=!1},d(a){He(e,a)}}}function Bi(s){let e,t,n,r,i,a,l="âœ•",o,u,f,p,h,g=s[16].length>1&&Vi(s);return{c(){e=y("div"),t=y("img"),r=F(),g&&g.c(),i=F(),a=y("button"),a.textContent=l,o=F(),u=y("a"),f=K("Open in new tab"),this.h()},l(m){e=k(m,"DIV",{class:!0});var v=D(e);t=k(v,"IMG",{src:!0,alt:!0,class:!0}),r=P(v),g&&g.l(v),i=P(v),a=k(v,"BUTTON",{class:!0,"data-svelte-h":!0}),$(a)!=="svelte-cyanf1"&&(a.textContent=l),o=P(v),u=k(v,"A",{href:!0,target:!0,rel:!0,class:!0});var T=D(u);f=Z(T,"Open in new tab"),T.forEach(_),v.forEach(_),this.h()},h(){Be(t.src,n=s[14])||d(t,"src",n),d(t,"alt","Enlarged"),d(t,"class","enlarged-image svelte-5e601o"),d(a,"class","close-modal svelte-5e601o"),d(u,"href",s[14]),d(u,"target","_blank"),d(u,"rel","noopener noreferrer"),d(u,"class","open-new-tab svelte-5e601o"),d(e,"class","image-modal svelte-5e601o")},m(m,v){V(m,e,v),c(e,t),c(e,r),g&&g.m(e,null),c(e,i),c(e,a),c(e,o),c(e,u),c(u,f),p||(h=[X(t,"click",vt(s[41])),X(a,"click",s[34]),X(e,"click",s[34])],p=!0)},p(m,v){v[0]&16384&&!Be(t.src,n=m[14])&&d(t,"src",n),m[16].length>1?g?g.p(m,v):(g=Vi(m),g.c(),g.m(e,i)):g&&(g.d(1),g=null),v[0]&16384&&d(u,"href",m[14])},d(m){m&&_(e),g&&g.d(),p=!1,De(h)}}}function Vi(s){let e,t="â€¹",n,r,i="â€º",a,l,o=s[17]+1+"",u,f,p=s[16].length+"",h,g,m;return{c(){e=y("button"),e.textContent=t,n=F(),r=y("button"),r.textContent=i,a=F(),l=y("div"),u=K(o),f=K(" / "),h=K(p),this.h()},l(v){e=k(v,"BUTTON",{class:!0,title:!0,"data-svelte-h":!0}),$(e)!=="svelte-c4iawu"&&(e.textContent=t),n=P(v),r=k(v,"BUTTON",{class:!0,title:!0,"data-svelte-h":!0}),$(r)!=="svelte-1gn22tr"&&(r.textContent=i),a=P(v),l=k(v,"DIV",{class:!0});var T=D(l);u=Z(T,o),f=Z(T," / "),h=Z(T,p),T.forEach(_),this.h()},h(){d(e,"class","nav-arrow nav-prev svelte-5e601o"),d(e,"title","Previous (â†)"),d(r,"class","nav-arrow nav-next svelte-5e601o"),d(r,"title","Next (â†’)"),d(l,"class","image-counter svelte-5e601o")},m(v,T){V(v,e,T),V(v,n,T),V(v,r,T),V(v,a,T),V(v,l,T),c(l,u),c(l,f),c(l,h),g||(m=[X(e,"click",vt(s[59])),X(r,"click",vt(s[60]))],g=!0)},p(v,T){T[0]&131072&&o!==(o=v[17]+1+"")&&ne(u,o),T[0]&65536&&p!==(p=v[16].length+"")&&ne(h,p)},d(v){v&&(_(e),_(n),_(r),_(a),_(l)),g=!1,De(m)}}}function zi(s){let e,t,n,r,i,a,l,o="âœ•",u,f,p,h,g;return{c(){e=y("div"),t=y("video"),n=y("source"),i=K(`\r
			Your browser does not support the video tag.`),a=F(),l=y("button"),l.textContent=o,u=F(),f=y("a"),p=K("Open in new tab"),this.h()},l(m){e=k(m,"DIV",{class:!0});var v=D(e);t=k(v,"VIDEO",{class:!0});var T=D(t);n=k(T,"SOURCE",{src:!0}),i=Z(T,`\r
			Your browser does not support the video tag.`),T.forEach(_),a=P(v),l=k(v,"BUTTON",{class:!0,"data-svelte-h":!0}),$(l)!=="svelte-yc21b"&&(l.textContent=o),u=P(v),f=k(v,"A",{href:!0,target:!0,rel:!0,class:!0});var C=D(f);p=Z(C,"Open in new tab"),C.forEach(_),v.forEach(_),this.h()},h(){Be(n.src,r=s[15])||d(n,"src",r),t.controls=!0,t.autoplay=!0,d(t,"class","enlarged-video svelte-5e601o"),d(l,"class","close-modal svelte-5e601o"),d(f,"href",s[15]),d(f,"target","_blank"),d(f,"rel","noopener noreferrer"),d(f,"class","open-new-tab svelte-5e601o"),d(e,"class","video-modal svelte-5e601o")},m(m,v){V(m,e,v),c(e,t),c(t,n),c(t,i),c(e,a),c(e,l),c(e,u),c(e,f),c(f,p),h||(g=[X(t,"click",vt(s[40])),X(l,"click",s[38]),X(e,"click",s[38])],h=!0)},p(m,v){v[0]&32768&&!Be(n.src,r=m[15])&&d(n,"src",r),v[0]&32768&&d(f,"href",m[15])},d(m){m&&_(e),h=!1,De(g)}}}function xf(s){let e=[],t=new Map,n,r,i,a,l,o,u,f,p,h,g,m,v,T,C,E,S,b=ze(s[0]);const A=R=>R[65].id;for(let R=0;R<b.length;R+=1){let x=Ci(s,b,R),W=A(x);t.set(W,e[R]=xi(W,x))}function I(R){s[53](R)}function w(R){s[54](R)}let O={isOwnProfile:s[4]};s[2]!==void 0&&(O.isOpen=s[2]),s[3]!==void 0&&(O.user=s[3]),r=new Sr({props:O}),st.push(()=>Lt(r,"isOpen",I)),st.push(()=>Lt(r,"user",w));let N=s[8]&&Ui(s);function M(R){s[56](R)}function L(R){s[57](R)}let B={};s[12]!==void 0&&(B.visible=s[12]),s[13]!==void 0&&(B.message=s[13]),u=new mf({props:B}),st.push(()=>Lt(u,"visible",M)),st.push(()=>Lt(u,"message",L)),g=new Cs({props:{isOpen:s[11],title:"Delete Message",message:"Are you sure you want to delete this message?",confirmText:"Delete",variant:"danger",onConfirm:s[26],onCancel:s[58]}});let H=s[14]&&Bi(s),z=s[15]&&zi(s);return{c(){for(let R=0;R<e.length;R+=1)e[R].c();n=F(),Ye(r.$$.fragment),l=F(),N&&N.c(),o=F(),Ye(u.$$.fragment),h=F(),Ye(g.$$.fragment),m=F(),H&&H.c(),v=F(),z&&z.c(),T=Ie()},l(R){for(let x=0;x<e.length;x+=1)e[x].l(R);n=P(R),We(r.$$.fragment,R),l=P(R),N&&N.l(R),o=P(R),We(u.$$.fragment,R),h=P(R),We(g.$$.fragment,R),m=P(R),H&&H.l(R),v=P(R),z&&z.l(R),T=Ie()},m(R,x){for(let W=0;W<e.length;W+=1)e[W]&&e[W].m(R,x);V(R,n,x),Ge(r,R,x),V(R,l,x),N&&N.m(R,x),V(R,o,x),Ge(u,R,x),V(R,h,x),Ge(g,R,x),V(R,m,x),H&&H.m(R,x),V(R,v,x),z&&z.m(R,x),V(R,T,x),C=!0,E||(S=X(bf,"keydown",s[36]),E=!0)},p(R,x){x[0]&29099523|x[1]&71&&(b=ze(R[0]),e=Qt(e,x,A,1,R,b,t,n.parentNode,Kt,xi,n,Ci));const W={};x[0]&16&&(W.isOwnProfile=R[4]),!i&&x[0]&4&&(i=!0,W.isOpen=R[2],Ft(()=>i=!1)),!a&&x[0]&8&&(a=!0,W.user=R[3],Ft(()=>a=!1)),r.$set(W),R[8]?N?(N.p(R,x),x[0]&256&&ke(N,1)):(N=Ui(R),N.c(),ke(N,1),N.m(o.parentNode,o)):N&&(xs(),Ae(N,1,1,()=>{N=null}),Us());const q={};!f&&x[0]&4096&&(f=!0,q.visible=R[12],Ft(()=>f=!1)),!p&&x[0]&8192&&(p=!0,q.message=R[13],Ft(()=>p=!1)),u.$set(q);const j={};x[0]&2048&&(j.isOpen=R[11]),x[0]&2048&&(j.onCancel=R[58]),g.$set(j),R[14]?H?H.p(R,x):(H=Bi(R),H.c(),H.m(v.parentNode,v)):H&&(H.d(1),H=null),R[15]?z?z.p(R,x):(z=zi(R),z.c(),z.m(T.parentNode,T)):z&&(z.d(1),z=null)},i(R){C||(ke(r.$$.fragment,R),ke(N),ke(u.$$.fragment,R),ke(g.$$.fragment,R),C=!0)},o(R){Ae(r.$$.fragment,R),Ae(N),Ae(u.$$.fragment,R),Ae(g.$$.fragment,R),C=!1},d(R){R&&(_(n),_(l),_(o),_(h),_(m),_(v),_(T));for(let x=0;x<e.length;x+=1)e[x].d(R);He(r,R),N&&N.d(R),He(u,R),He(g,R),H&&H.d(R),z&&z.d(R),E=!1,S()}}}function qi(s){return new Date(s).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"})}function gs(s){return s?s<1024?s+" B":s<1024*1024?(s/1024).toFixed(1)+" KB":(s/(1024*1024)).toFixed(1)+" MB":""}function $e(s){return s?s.startsWith("data:")||s.startsWith("http:")||s.startsWith("https:")?s:`${window.location.origin.includes(":5173")?"http://localhost:3000":window.location.origin}${s}`:""}function ms(s){if(!s)return"ðŸ“Ž";const e=s.toLowerCase().split(".").pop()||"";return{jpg:"ðŸ–¼ï¸",jpeg:"ðŸ–¼ï¸",png:"ðŸ–¼ï¸",gif:"ðŸ–¼ï¸",bmp:"ðŸ–¼ï¸",svg:"ðŸ–¼ï¸",webp:"ðŸ–¼ï¸",mp4:"ðŸŽ¬",mov:"ðŸŽ¬",avi:"ðŸŽ¬",mkv:"ðŸŽ¬",webm:"ðŸŽ¬",flv:"ðŸŽ¬",mp3:"ðŸŽµ",wav:"ðŸŽµ",ogg:"ðŸŽµ",flac:"ðŸŽµ",pdf:"ðŸ“„",doc:"ðŸ“",docx:"ðŸ“",txt:"ðŸ“",rtf:"ðŸ“",xls:"ðŸ“Š",xlsx:"ðŸ“Š",csv:"ðŸ“Š",ppt:"ðŸ“½ï¸",pptx:"ðŸ“½ï¸",zip:"ðŸ“¦",rar:"ðŸ“¦","7z":"ðŸ“¦",tar:"ðŸ“¦",gz:"ðŸ“¦",js:"ðŸ’»",ts:"ðŸ’»",py:"ðŸ’»",java:"ðŸ’»",cpp:"ðŸ’»",c:"ðŸ’»",cs:"ðŸ’»",html:"ðŸ’»",css:"ðŸ’»",json:"ðŸ’»",blend:"ðŸŽ¨",fbx:"ðŸŽ¨",obj:"ðŸŽ¨",stl:"ðŸŽ¨",psd:"ðŸŽ¨",ai:"ðŸŽ¨",sketch:"ðŸŽ¨"}[e]||"ðŸ“Ž"}function Ar(s){if(!s)return!1;const e=s.toLowerCase().split(".").pop()||"";return["jpg","jpeg","png","gif","bmp","svg","webp"].includes(e)}function Ma(s){if(!s)return!1;const e=s.toLowerCase().split(".").pop()||"";return["mp4","mov","avi","mkv","webm","flv"].includes(e)}function ji(){document.querySelectorAll('.spoiler[data-spoiler="true"]').forEach(e=>{e.hasAttribute("data-listener-attached")||(e.addEventListener("click",function(){this.classList.toggle("revealed")}),e.setAttribute("data-listener-attached","true"))})}function Uf(s,e,t){let n,r,i;Ne(s,Os,ee=>t(62,n=ee)),Ne(s,ns,ee=>t(63,r=ee)),Ne(s,Zt,ee=>t(64,i=ee));let{messages:a}=e,{onReply:l=()=>{}}=e,{firstUnreadMessageId:o=null}=e,u=!1,f=null,p=!1,h=!1,g=0,m=0,v=null,T=null,C="",E=!1,S=null;function b(ee){return i.find(be=>be.username===ee)}function A(ee){const be=b(ee);return(be==null?void 0:be.color)||"var(--status-offline)"}function I(ee){t(3,f=ee),t(4,p=ee.id===(r==null?void 0:r.id)),t(2,u=!0)}function w(ee,be){ee.preventDefault(),t(8,v=be),t(6,g=ee.clientX),t(7,m=ee.clientY),t(5,h=!0)}function O(){v&&(t(9,T=v.id),t(10,C=v.text),t(5,h=!1))}function N(ee){C.trim()&&Oa(n,ee,C.trim()),t(9,T=null),t(10,C="")}function M(){t(9,T=null),t(10,C="")}function L(){v&&(S=v,t(11,E=!0),t(5,h=!1))}function B(){S&&fu(n,S.id),t(11,E=!1)}function H(){v&&(Tr(n,v.id),t(5,h=!1))}function z(){v&&(l(v),t(5,h=!1))}async function R(){if(!(!(v!=null&&v.fileUrl)||!(v!=null&&v.fileName))){try{const ee=$e(v.fileUrl),wt=await(await fetch(ee)).blob(),qe=window.URL.createObjectURL(wt),Qe=document.createElement("a");Qe.href=qe,Qe.download=v.fileName,document.body.appendChild(Qe),Qe.click(),document.body.removeChild(Qe),window.URL.revokeObjectURL(qe)}catch(ee){console.error("Download failed:",ee)}t(5,h=!1)}}let x=!1,W=null;function q(){v&&(t(13,W=v),t(12,x=!0),t(5,h=!1))}function j(ee,be){ee.preventDefault(),t(8,v=be),t(6,g=ee.clientX),t(7,m=ee.clientY),t(5,h=!0)}function G(ee){if(ee)return a.find(be=>be.id===ee)}let Q=null,Y=null,te=[],fe=0;function se(ee,be=[]){t(14,Q=ee),t(16,te=be.length>0?be:[ee]),t(17,fe=te.indexOf(ee))}function ue(){t(14,Q=null),t(16,te=[]),t(17,fe=0)}function ce(ee){te.length!==0&&(ee==="prev"?t(17,fe=(fe-1+te.length)%te.length):t(17,fe=(fe+1)%te.length),t(14,Q=te[fe]))}function le(ee){Q&&(ee.key==="ArrowLeft"?(ee.preventDefault(),ce("prev")):ee.key==="ArrowRight"?(ee.preventDefault(),ce("next")):ee.key==="Escape"&&(ee.preventDefault(),ue()))}function he(ee){t(15,Y=ee)}function Re(){t(15,Y=null)}rs(ji),ja(ji);function ae(ee){ds.call(this,s,ee)}function Ve(ee){ds.call(this,s,ee)}const Te=ee=>I(ee);function re(){C=this.value,t(10,C)}const J=(ee,be)=>{be.key==="Enter"&&!be.shiftKey?(be.preventDefault(),N(ee.id)):be.key==="Escape"&&(be.preventDefault(),M())},oe=ee=>N(ee.id),ye=(ee,be,wt)=>{if(wt.button===0){const qe=ee.files.filter(Qe=>Ar(Qe.fileName)).map(Qe=>$e(Qe.fileUrl));se($e(be.fileUrl),qe)}},_e=(ee,be)=>be.button===0&&he($e(ee.fileUrl)),we=(ee,be)=>be.button===0&&ee.fileUrl&&se($e(ee.fileUrl)),xe=(ee,be)=>j(be,ee),et=(ee,be)=>{be.button===0&&ee.fileUrl&&he($e(ee.fileUrl))},Ke=(ee,be)=>j(be,ee),Pe=(ee,be)=>w(be,ee);function je(ee){u=ee,t(2,u)}function pt(ee){f=ee,t(3,f)}function ft(ee){h=ee,t(5,h)}function nt(ee){x=ee,t(12,x)}function yt(ee){W=ee,t(13,W)}const Ut=()=>t(11,E=!1),rt=()=>ce("prev"),ve=()=>ce("next");return s.$$set=ee=>{"messages"in ee&&t(0,a=ee.messages),"onReply"in ee&&t(39,l=ee.onReply),"firstUnreadMessageId"in ee&&t(1,o=ee.firstUnreadMessageId)},[a,o,u,f,p,h,g,m,v,T,C,E,x,W,Q,Y,te,fe,b,A,I,w,O,N,M,L,B,H,z,R,q,j,G,se,ue,ce,le,he,Re,l,ae,Ve,Te,re,J,oe,ye,_e,we,xe,et,Ke,Pe,je,pt,ft,nt,yt,Ut,rt,ve]}class Bf extends ct{constructor(e){super(),ut(this,e,Uf,xf,ot,{messages:0,onReply:39,firstUnreadMessageId:1},null,[-1,-1,-1])}}function Hi(s,e,t){const n=s.slice();return n[6]=e[t],n}function Gi(s){let e,t,n,r="ðŸ“Œ",i,a,l="Pinned Messages",o,u,f,p=s[0].length+"",h,g,m,v,T=[],C=new Map,E=ze(s[0]);const S=b=>b[6].id;for(let b=0;b<E.length;b+=1){let A=Hi(s,E,b),I=S(A);C.set(I,T[b]=Wi(I,A))}return{c(){e=y("div"),t=y("div"),n=y("span"),n.textContent=r,i=F(),a=y("span"),a.textContent=l,o=F(),u=y("span"),f=K("("),h=K(p),g=K(")"),m=F(),v=y("div");for(let b=0;b<T.length;b+=1)T[b].c();this.h()},l(b){e=k(b,"DIV",{class:!0});var A=D(e);t=k(A,"DIV",{class:!0});var I=D(t);n=k(I,"SPAN",{class:!0,"data-svelte-h":!0}),$(n)!=="svelte-73xtmc"&&(n.textContent=r),i=P(I),a=k(I,"SPAN",{class:!0,"data-svelte-h":!0}),$(a)!=="svelte-123zvdk"&&(a.textContent=l),o=P(I),u=k(I,"SPAN",{class:!0});var w=D(u);f=Z(w,"("),h=Z(w,p),g=Z(w,")"),w.forEach(_),I.forEach(_),m=P(A),v=k(A,"DIV",{class:!0});var O=D(v);for(let N=0;N<T.length;N+=1)T[N].l(O);O.forEach(_),A.forEach(_),this.h()},h(){d(n,"class","pinned-icon svelte-d1025n"),d(a,"class","pinned-title svelte-d1025n"),d(u,"class","pinned-count svelte-d1025n"),d(t,"class","pinned-header svelte-d1025n"),d(v,"class","pinned-messages svelte-d1025n"),d(e,"class","pinned-container svelte-d1025n")},m(b,A){V(b,e,A),c(e,t),c(t,n),c(t,i),c(t,a),c(t,o),c(t,u),c(u,f),c(u,h),c(u,g),c(e,m),c(e,v);for(let I=0;I<T.length;I+=1)T[I]&&T[I].m(v,null)},p(b,A){A&1&&p!==(p=b[0].length+"")&&ne(h,p),A&7&&(E=ze(b[0]),T=Qt(T,A,S,1,b,E,C,v,Kt,Wi,null,Hi))},d(b){b&&_(e);for(let A=0;A<T.length;A+=1)T[A].d()}}}function Wi(s,e){let t,n,r,i=e[6].user+"",a,l,o,u=e[6].text.substring(0,100)+"",f,p=e[6].text.length>100?"...":"",h,g,m,v=Yi(e[6].timestamp)+"",T,C,E,S="Ã—",b,A,I;function w(){return e[3](e[6])}return{key:s,first:null,c(){t=y("div"),n=y("div"),r=y("span"),a=K(i),l=F(),o=y("span"),f=K(u),h=K(p),g=F(),m=y("span"),T=K(v),C=F(),E=y("button"),E.textContent=S,b=F(),this.h()},l(O){t=k(O,"DIV",{class:!0});var N=D(t);n=k(N,"DIV",{class:!0});var M=D(n);r=k(M,"SPAN",{class:!0,style:!0});var L=D(r);a=Z(L,i),L.forEach(_),l=P(M),o=k(M,"SPAN",{class:!0});var B=D(o);f=Z(B,u),h=Z(B,p),B.forEach(_),g=P(M),m=k(M,"SPAN",{class:!0});var H=D(m);T=Z(H,v),H.forEach(_),M.forEach(_),C=P(N),E=k(N,"BUTTON",{class:!0,title:!0,"data-svelte-h":!0}),$(E)!=="svelte-87szfn"&&(E.textContent=S),b=P(N),N.forEach(_),this.h()},h(){d(r,"class","pinned-user svelte-d1025n"),Ee(r,"color",e[1](e[6].user)),d(o,"class","pinned-text svelte-d1025n"),d(m,"class","pinned-time svelte-d1025n"),d(n,"class","pinned-message-content svelte-d1025n"),d(E,"class","unpin-btn svelte-d1025n"),d(E,"title","Unpin message"),d(t,"class","pinned-message svelte-d1025n"),this.first=t},m(O,N){V(O,t,N),c(t,n),c(n,r),c(r,a),c(n,l),c(n,o),c(o,f),c(o,h),c(n,g),c(n,m),c(m,T),c(t,C),c(t,E),c(t,b),A||(I=X(E,"click",w),A=!0)},p(O,N){e=O,N&1&&i!==(i=e[6].user+"")&&ne(a,i),N&1&&Ee(r,"color",e[1](e[6].user)),N&1&&u!==(u=e[6].text.substring(0,100)+"")&&ne(f,u),N&1&&p!==(p=e[6].text.length>100?"...":"")&&ne(h,p),N&1&&v!==(v=Yi(e[6].timestamp)+"")&&ne(T,v)},d(O){O&&_(t),A=!1,I()}}}function Vf(s){let e,t=s[0].length>0&&Gi(s);return{c(){t&&t.c(),e=Ie()},l(n){t&&t.l(n),e=Ie()},m(n,r){t&&t.m(n,r),V(n,e,r)},p(n,[r]){n[0].length>0?t?t.p(n,r):(t=Gi(n),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},i:Ce,o:Ce,d(n){n&&_(e),t&&t.d(n)}}}function Yi(s){return new Date(s).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"})}function zf(s,e,t){let n;Ne(s,Zt,u=>t(4,n=u));let{pinnedMessages:r}=e;function i(u){return n.find(f=>f.username===u)}function a(u){const f=i(u);return(f==null?void 0:f.color)||"var(--status-offline)"}function l(u){Tr(u)}const o=u=>l(u.id);return s.$$set=u=>{"pinnedMessages"in u&&t(0,r=u.pinnedMessages)},[r,a,l,o]}class qf extends ct{constructor(e){super(),ut(this,e,zf,Vf,ot,{pinnedMessages:0})}}function Xi(s,e,t){const n=s.slice();return n[47]=e[t].file,n[48]=e[t].preview,n[50]=t,n}function Zi(s){let e,t='<div class="drag-overlay-content svelte-1mvqxem"><div class="drag-icon svelte-1mvqxem">ðŸ“</div> <div class="drag-text svelte-1mvqxem">Drop files here to upload</div></div>';return{c(){e=y("div"),e.innerHTML=t,this.h()},l(n){e=k(n,"DIV",{class:!0,"data-svelte-h":!0}),$(e)!=="svelte-1patjf9"&&(e.innerHTML=t),this.h()},h(){d(e,"class","drag-overlay svelte-1mvqxem")},m(n,r){V(n,e,r)},d(n){n&&_(e)}}}function Ki(s){let e,t,n,r,i=s[16].join(", ")+"",a,l,o=s[16].length===1?"is":"are",u,f;return{c(){e=y("div"),t=y("span"),n=F(),r=y("span"),a=K(i),l=F(),u=K(o),f=K(" typing..."),this.h()},l(p){e=k(p,"DIV",{class:!0});var h=D(e);t=k(h,"SPAN",{class:!0}),D(t).forEach(_),n=P(h),r=k(h,"SPAN",{});var g=D(r);a=Z(g,i),l=P(g),u=Z(g,o),f=Z(g," typing..."),g.forEach(_),h.forEach(_),this.h()},h(){d(t,"class","typing-dots svelte-1mvqxem"),d(e,"class","typing-indicator svelte-1mvqxem")},m(p,h){V(p,e,h),c(e,t),c(e,n),c(e,r),c(r,a),c(r,l),c(r,u),c(r,f)},p(p,h){h[0]&65536&&i!==(i=p[16].join(", ")+"")&&ne(a,i),h[0]&65536&&o!==(o=p[16].length===1?"is":"are")&&ne(u,o)},d(p){p&&_(e)}}}function Qi(s){let e,t;return e=new Ju({}),e.$on("select",s[21]),e.$on("close",s[33]),{c(){Ye(e.$$.fragment)},l(n){We(e.$$.fragment,n)},m(n,r){Ge(e,n,r),t=!0},p:Ce,i(n){t||(ke(e.$$.fragment,n),t=!0)},o(n){Ae(e.$$.fragment,n),t=!1},d(n){He(e,n)}}}function jf(s){let e,t,n,r,i=s[5].user+"",a,l,o,u,f=s[5].text.substring(0,50)+"",p,h=s[5].text.length>50?"...":"",g,m,v,T="âœ•",C,E;return{c(){e=y("div"),t=y("div"),n=y("span"),r=K("Replying to "),a=K(i),l=K(":"),o=F(),u=y("span"),p=K(f),g=K(h),m=F(),v=y("button"),v.textContent=T,this.h()},l(S){e=k(S,"DIV",{class:!0});var b=D(e);t=k(b,"DIV",{class:!0});var A=D(t);n=k(A,"SPAN",{class:!0});var I=D(n);r=Z(I,"Replying to "),a=Z(I,i),l=Z(I,":"),I.forEach(_),o=P(A),u=k(A,"SPAN",{class:!0});var w=D(u);p=Z(w,f),g=Z(w,h),w.forEach(_),A.forEach(_),m=P(b),v=k(b,"BUTTON",{class:!0,"data-svelte-h":!0}),$(v)!=="svelte-1av190j"&&(v.textContent=T),b.forEach(_),this.h()},h(){d(n,"class","reply-label svelte-1mvqxem"),d(u,"class","reply-preview svelte-1mvqxem"),d(t,"class","reply-info svelte-1mvqxem"),d(v,"class","cancel-reply svelte-1mvqxem"),d(e,"class","reply-bar svelte-1mvqxem")},m(S,b){V(S,e,b),c(e,t),c(t,n),c(n,r),c(n,a),c(n,l),c(t,o),c(t,u),c(u,p),c(u,g),c(e,m),c(e,v),C||(E=X(v,"click",s[23]),C=!0)},p(S,b){b[0]&32&&i!==(i=S[5].user+"")&&ne(a,i),b[0]&32&&f!==(f=S[5].text.substring(0,50)+"")&&ne(p,f),b[0]&32&&h!==(h=S[5].text.length>50?"...":"")&&ne(g,h)},d(S){S&&_(e),C=!1,E()}}}function Hf(s){let e,t,n='<span class="edit-label svelte-1mvqxem">Editing message</span> <span class="edit-hint svelte-1mvqxem">Press Escape to cancel</span>',r,i,a="âœ•",l,o;return{c(){e=y("div"),t=y("div"),t.innerHTML=n,r=F(),i=y("button"),i.textContent=a,this.h()},l(u){e=k(u,"DIV",{class:!0});var f=D(e);t=k(f,"DIV",{class:!0,"data-svelte-h":!0}),$(t)!=="svelte-1kwfa7y"&&(t.innerHTML=n),r=P(f),i=k(f,"BUTTON",{class:!0,"data-svelte-h":!0}),$(i)!=="svelte-1anw7a5"&&(i.textContent=a),f.forEach(_),this.h()},h(){d(t,"class","edit-info svelte-1mvqxem"),d(i,"class","cancel-edit svelte-1mvqxem"),d(e,"class","edit-bar svelte-1mvqxem")},m(u,f){V(u,e,f),c(e,t),c(e,r),c(e,i),l||(o=X(i,"click",s[20]),l=!0)},p:Ce,d(u){u&&_(e),l=!1,o()}}}function Ji(s){let e,t,n,r=s[10].length+"",i,a,l=s[10].length>1?"s":"",o,u,f,p,h="âœ•",g,m,v,T,C,E,S,b,A="Mark as spoiler",I,w,O="âš ï¸",N,M,L,B=s[10].length+"",H,z,R=s[10].length>1?"s":"",x,W,q,j=ze(s[10]),G=[];for(let Q=0;Q<j.length;Q+=1)G[Q]=$i(Xi(s,j,Q));return{c(){e=y("div"),t=y("div"),n=y("span"),i=K(r),a=K(" file"),o=K(l),u=K(" selected"),f=F(),p=y("button"),p.textContent=h,g=F(),m=y("div");for(let Q=0;Q<G.length;Q+=1)G[Q].c();v=F(),T=y("div"),C=y("label"),E=y("input"),S=F(),b=y("span"),b.textContent=A,I=F(),w=y("span"),w.textContent=O,N=F(),M=y("button"),L=K("Upload "),H=K(B),z=K(" file"),x=K(R),this.h()},l(Q){e=k(Q,"DIV",{class:!0});var Y=D(e);t=k(Y,"DIV",{class:!0});var te=D(t);n=k(te,"SPAN",{});var fe=D(n);i=Z(fe,r),a=Z(fe," file"),o=Z(fe,l),u=Z(fe," selected"),fe.forEach(_),f=P(te),p=k(te,"BUTTON",{class:!0,"data-svelte-h":!0}),$(p)!=="svelte-pcsk7y"&&(p.textContent=h),te.forEach(_),g=P(Y),m=k(Y,"DIV",{class:!0});var se=D(m);for(let he=0;he<G.length;he+=1)G[he].l(se);se.forEach(_),v=P(Y),T=k(Y,"DIV",{class:!0});var ue=D(T);C=k(ue,"LABEL",{class:!0});var ce=D(C);E=k(ce,"INPUT",{type:!0,class:!0}),S=P(ce),b=k(ce,"SPAN",{"data-svelte-h":!0}),$(b)!=="svelte-6s6emx"&&(b.textContent=A),ce.forEach(_),I=P(ue),w=k(ue,"SPAN",{class:!0,title:!0,"data-svelte-h":!0}),$(w)!=="svelte-6jzi8y"&&(w.textContent=O),ue.forEach(_),N=P(Y),M=k(Y,"BUTTON",{class:!0});var le=D(M);L=Z(le,"Upload "),H=Z(le,B),z=Z(le," file"),x=Z(le,R),le.forEach(_),Y.forEach(_),this.h()},h(){d(p,"class","cancel-gallery svelte-1mvqxem"),d(t,"class","gallery-header svelte-1mvqxem"),d(m,"class","gallery-grid svelte-1mvqxem"),d(E,"type","checkbox"),d(E,"class","spoiler-checkbox svelte-1mvqxem"),d(C,"class","spoiler-checkbox-label svelte-1mvqxem"),d(w,"class","spoiler-hint svelte-1mvqxem"),d(w,"title","Sensitive content will be hidden until clicked"),d(T,"class","spoiler-checkbox-container svelte-1mvqxem"),d(M,"class","upload-files-btn svelte-1mvqxem"),d(e,"class","file-gallery svelte-1mvqxem")},m(Q,Y){V(Q,e,Y),c(e,t),c(t,n),c(n,i),c(n,a),c(n,o),c(n,u),c(t,f),c(t,p),c(e,g),c(e,m);for(let te=0;te<G.length;te+=1)G[te]&&G[te].m(m,null);c(e,v),c(e,T),c(T,C),c(C,E),E.checked=s[11],c(C,S),c(C,b),c(T,I),c(T,w),c(e,N),c(e,M),c(M,L),c(M,H),c(M,z),c(M,x),W||(q=[X(p,"click",s[26]),X(E,"change",s[35]),X(M,"click",s[30])],W=!0)},p(Q,Y){if(Y[0]&1024&&r!==(r=Q[10].length+"")&&ne(i,r),Y[0]&1024&&l!==(l=Q[10].length>1?"s":"")&&ne(o,l),Y[0]&33555456){j=ze(Q[10]);let te;for(te=0;te<j.length;te+=1){const fe=Xi(Q,j,te);G[te]?G[te].p(fe,Y):(G[te]=$i(fe),G[te].c(),G[te].m(m,null))}for(;te<G.length;te+=1)G[te].d(1);G.length=j.length}Y[0]&2048&&(E.checked=Q[11]),Y[0]&1024&&B!==(B=Q[10].length+"")&&ne(H,B),Y[0]&1024&&R!==(R=Q[10].length>1?"s":"")&&ne(x,R)},d(Q){Q&&_(e),Dn(G,Q),W=!1,De(q)}}}function Gf(s){let e,t,n;function r(l,o){return o[0]&1024&&(t=null),o[0]&1024&&(n=null),t==null&&(t=!!l[47].type.startsWith("video/")),t?Zf:(n==null&&(n=!!l[47].type.startsWith("audio/")),n?Xf:Yf)}let i=r(s,[-1,-1]),a=i(s);return{c(){e=y("div"),a.c(),this.h()},l(l){e=k(l,"DIV",{class:!0});var o=D(e);a.l(o),o.forEach(_),this.h()},h(){d(e,"class","gallery-file-icon svelte-1mvqxem")},m(l,o){V(l,e,o),a.m(e,null)},p(l,o){i!==(i=r(l,o))&&(a.d(1),a=i(l),a&&(a.c(),a.m(e,null)))},d(l){l&&_(e),a.d()}}}function Wf(s){let e,t,n;return{c(){e=y("img"),this.h()},l(r){e=k(r,"IMG",{src:!0,alt:!0,class:!0}),this.h()},h(){Be(e.src,t=s[48])||d(e,"src",t),d(e,"alt",n=s[47].name),d(e,"class","gallery-preview svelte-1mvqxem")},m(r,i){V(r,e,i)},p(r,i){i[0]&1024&&!Be(e.src,t=r[48])&&d(e,"src",t),i[0]&1024&&n!==(n=r[47].name)&&d(e,"alt",n)},d(r){r&&_(e)}}}function Yf(s){let e;return{c(){e=K("ðŸ“„")},l(t){e=Z(t,"ðŸ“„")},m(t,n){V(t,e,n)},d(t){t&&_(e)}}}function Xf(s){let e;return{c(){e=K("ðŸŽµ")},l(t){e=Z(t,"ðŸŽµ")},m(t,n){V(t,e,n)},d(t){t&&_(e)}}}function Zf(s){let e;return{c(){e=K("ðŸŽ¬")},l(t){e=Z(t,"ðŸŽ¬")},m(t,n){V(t,e,n)},d(t){t&&_(e)}}}function $i(s){let e,t,n,r,i=s[47].name+"",a,l,o,u=(s[47].size/1024/1024).toFixed(2)+"",f,p,h,g,m="âœ•",v,T,C;function E(I,w){return I[48]?Wf:Gf}let S=E(s),b=S(s);function A(){return s[34](s[50])}return{c(){e=y("div"),b.c(),t=F(),n=y("div"),r=y("div"),a=K(i),l=F(),o=y("div"),f=K(u),p=K(" MB"),h=F(),g=y("button"),g.textContent=m,v=F(),this.h()},l(I){e=k(I,"DIV",{class:!0});var w=D(e);b.l(w),t=P(w),n=k(w,"DIV",{class:!0});var O=D(n);r=k(O,"DIV",{class:!0});var N=D(r);a=Z(N,i),N.forEach(_),l=P(O),o=k(O,"DIV",{class:!0});var M=D(o);f=Z(M,u),p=Z(M," MB"),M.forEach(_),O.forEach(_),h=P(w),g=k(w,"BUTTON",{class:!0,"data-svelte-h":!0}),$(g)!=="svelte-17gof1i"&&(g.textContent=m),v=P(w),w.forEach(_),this.h()},h(){d(r,"class","gallery-file-name svelte-1mvqxem"),d(o,"class","gallery-file-size svelte-1mvqxem"),d(n,"class","gallery-file-info svelte-1mvqxem"),d(g,"class","remove-file svelte-1mvqxem"),d(e,"class","gallery-item svelte-1mvqxem")},m(I,w){V(I,e,w),b.m(e,null),c(e,t),c(e,n),c(n,r),c(r,a),c(n,l),c(n,o),c(o,f),c(o,p),c(e,h),c(e,g),c(e,v),T||(C=X(g,"click",A),T=!0)},p(I,w){s=I,S===(S=E(s))&&b?b.p(s,w):(b.d(1),b=S(s),b&&(b.c(),b.m(e,t))),w[0]&1024&&i!==(i=s[47].name+"")&&ne(a,i),w[0]&1024&&u!==(u=(s[47].size/1024/1024).toFixed(2)+"")&&ne(f,u)},d(I){I&&_(e),b.d(),T=!1,C()}}}function el(s){let e,t,n,r="Uploading files...",i,a,l,o,u,f,p;return{c(){e=y("div"),t=y("div"),n=y("span"),n.textContent=r,i=F(),a=y("span"),l=K(s[8]),o=K("%"),u=F(),f=y("div"),p=y("div"),this.h()},l(h){e=k(h,"DIV",{class:!0});var g=D(e);t=k(g,"DIV",{class:!0});var m=D(t);n=k(m,"SPAN",{"data-svelte-h":!0}),$(n)!=="svelte-10wvq4k"&&(n.textContent=r),i=P(m),a=k(m,"SPAN",{});var v=D(a);l=Z(v,s[8]),o=Z(v,"%"),v.forEach(_),m.forEach(_),u=P(g),f=k(g,"DIV",{class:!0});var T=D(f);p=k(T,"DIV",{class:!0,style:!0}),D(p).forEach(_),T.forEach(_),g.forEach(_),this.h()},h(){d(t,"class","upload-progress-info svelte-1mvqxem"),d(p,"class","progress-fill svelte-1mvqxem"),Ee(p,"width",s[8]+"%"),d(f,"class","progress-bar svelte-1mvqxem"),d(e,"class","upload-progress-bar svelte-1mvqxem")},m(h,g){V(h,e,g),c(e,t),c(t,n),c(t,i),c(t,a),c(a,l),c(a,o),c(e,u),c(e,f),c(f,p)},p(h,g){g[0]&256&&ne(l,h[8]),g[0]&256&&Ee(p,"width",h[8]+"%")},d(h){h&&_(e)}}}function Kf(s){let e,t,n,r,i,a,l,o,u,f,p,h,g,m,v,T,C,E,S,b,A,I,w="ðŸ“Ž",O,N,M,L,B="GIF",H,z,R,x,W,q,j,G=s[12]&&Zi();o=new qf({props:{pinnedMessages:s[14]}}),f=new Bf({props:{messages:s[0],onReply:s[22],firstUnreadMessageId:s[15]}});let Q=s[16].length>0&&Ki(s),Y=s[4]&&Qi(s);function te(le,he){if(le[7])return Hf;if(le[5])return jf}let fe=te(s),se=fe&&fe(s),ue=s[10].length>0&&!s[9]&&Ji(s),ce=s[9]&&el(s);return{c(){e=y("div"),G&&G.c(),t=F(),n=y("div"),r=y("h2"),i=K(s[1]),a=F(),l=y("div"),Ye(o.$$.fragment),u=F(),Ye(f.$$.fragment),p=F(),Q&&Q.c(),h=F(),Y&&Y.c(),g=F(),se&&se.c(),m=F(),v=y("div"),ue&&ue.c(),T=F(),ce&&ce.c(),C=F(),E=y("input"),S=F(),b=y("div"),A=y("div"),I=y("button"),I.textContent=w,O=F(),N=y("textarea"),M=F(),L=y("button"),L.textContent=B,H=F(),z=y("button"),R=K("Send"),this.h()},l(le){e=k(le,"DIV",{class:!0});var he=D(e);G&&G.l(he),t=P(he),n=k(he,"DIV",{class:!0});var Re=D(n);r=k(Re,"H2",{class:!0});var ae=D(r);i=Z(ae,s[1]),ae.forEach(_),Re.forEach(_),a=P(he),l=k(he,"DIV",{class:!0});var Ve=D(l);We(o.$$.fragment,Ve),u=P(Ve),We(f.$$.fragment,Ve),p=P(Ve),Q&&Q.l(Ve),Ve.forEach(_),h=P(he),Y&&Y.l(he),g=P(he),se&&se.l(he),m=P(he),v=k(he,"DIV",{class:!0});var Te=D(v);ue&&ue.l(Te),T=P(Te),ce&&ce.l(Te),C=P(Te),E=k(Te,"INPUT",{type:!0,style:!0}),S=P(Te),b=k(Te,"DIV",{class:!0});var re=D(b);A=k(re,"DIV",{class:!0});var J=D(A);I=k(J,"BUTTON",{class:!0,title:!0,"data-svelte-h":!0}),$(I)!=="svelte-1fiys3t"&&(I.textContent=w),J.forEach(_),O=P(re),N=k(re,"TEXTAREA",{placeholder:!0,maxlength:!0,rows:!0,class:!0}),D(N).forEach(_),M=P(re),L=k(re,"BUTTON",{class:!0,title:!0,"data-svelte-h":!0}),$(L)!=="svelte-1ty10q8"&&(L.textContent=B),H=P(re),z=k(re,"BUTTON",{class:!0});var oe=D(z);R=Z(oe,"Send"),oe.forEach(_),re.forEach(_),Te.forEach(_),he.forEach(_),this.h()},h(){d(r,"class","svelte-1mvqxem"),d(n,"class","chat-header svelte-1mvqxem"),d(l,"class","messages svelte-1mvqxem"),d(E,"type","file"),E.multiple=!0,Ee(E,"display","none"),d(I,"class","input-icon-button svelte-1mvqxem"),d(I,"title","Attach file"),d(A,"class","input-buttons-left svelte-1mvqxem"),d(N,"placeholder","Type a message... (Shift+Enter for new line)"),d(N,"maxlength","2000"),d(N,"rows","1"),d(N,"class","svelte-1mvqxem"),d(L,"class","input-icon-button svelte-1mvqxem"),d(L,"title","Add GIF"),d(z,"class","send-button svelte-1mvqxem"),z.disabled=x=!s[2].trim(),d(b,"class","input-container svelte-1mvqxem"),d(v,"class","input-wrapper svelte-1mvqxem"),d(e,"class","chat-container svelte-1mvqxem")},m(le,he){V(le,e,he),G&&G.m(e,null),c(e,t),c(e,n),c(n,r),c(r,i),c(e,a),c(e,l),Ge(o,l,null),c(l,u),Ge(f,l,null),c(l,p),Q&&Q.m(l,null),s[32](l),c(e,h),Y&&Y.m(e,null),c(e,g),se&&se.m(e,null),c(e,m),c(e,v),ue&&ue.m(v,null),c(v,T),ce&&ce.m(v,null),c(v,C),c(v,E),s[36](E),c(v,S),c(v,b),c(b,A),c(A,I),c(b,O),c(b,N),s[38](N),lt(N,s[2]),c(b,M),c(b,L),c(b,H),c(b,z),c(z,R),W=!0,q||(j=[X(E,"change",s[24]),X(I,"click",s[37]),X(N,"input",s[39]),X(N,"input",s[17]),X(N,"keydown",s[18]),X(L,"click",s[40]),X(z,"click",s[19]),X(e,"dragenter",s[27]),X(e,"dragleave",s[28]),X(e,"dragover",Qf),X(e,"drop",s[29])],q=!0)},p(le,he){le[12]?G||(G=Zi(),G.c(),G.m(e,t)):G&&(G.d(1),G=null),(!W||he[0]&2)&&ne(i,le[1]);const Re={};he[0]&16384&&(Re.pinnedMessages=le[14]),o.$set(Re);const ae={};he[0]&1&&(ae.messages=le[0]),he[0]&32768&&(ae.firstUnreadMessageId=le[15]),f.$set(ae),le[16].length>0?Q?Q.p(le,he):(Q=Ki(le),Q.c(),Q.m(l,null)):Q&&(Q.d(1),Q=null),le[4]?Y?(Y.p(le,he),he[0]&16&&ke(Y,1)):(Y=Qi(le),Y.c(),ke(Y,1),Y.m(e,g)):Y&&(xs(),Ae(Y,1,1,()=>{Y=null}),Us()),fe===(fe=te(le))&&se?se.p(le,he):(se&&se.d(1),se=fe&&fe(le),se&&(se.c(),se.m(e,m))),le[10].length>0&&!le[9]?ue?ue.p(le,he):(ue=Ji(le),ue.c(),ue.m(v,T)):ue&&(ue.d(1),ue=null),le[9]?ce?ce.p(le,he):(ce=el(le),ce.c(),ce.m(v,C)):ce&&(ce.d(1),ce=null),he[0]&4&&lt(N,le[2]),(!W||he[0]&4&&x!==(x=!le[2].trim()))&&(z.disabled=x)},i(le){W||(ke(o.$$.fragment,le),ke(f.$$.fragment,le),ke(Y),W=!0)},o(le){Ae(o.$$.fragment,le),Ae(f.$$.fragment,le),Ae(Y),W=!1},d(le){le&&_(e),G&&G.d(),He(o),He(f),Q&&Q.d(),s[32](null),Y&&Y.d(),se&&se.d(),ue&&ue.d(),ce&&ce.d(),s[36](null),s[38](null),q=!1,De(j)}}}function Qf(s){s.preventDefault(),s.stopPropagation()}function Jf(s,e,t){let n,r,i,a,l,o,u;Ne(s,Os,re=>t(1,i=re)),Ne(s,ns,re=>t(44,a=re)),Ne(s,St,re=>t(31,l=re)),Ne(s,Er,re=>t(15,o=re)),Ne(s,Ia,re=>t(16,u=re));let f="",p,h,g=!1,m=null,v,T=null,C=0,E=!1,S=[],b=[],A=!1,I=!1,w=0,O;async function N(){await Ha(),p&&t(3,p.scrollTop=p.scrollHeight,p)}function M(){if(!O)return;t(13,O.style.height="auto",O);const re=Math.min(O.scrollHeight,120);t(13,O.style.height=`${re}px`,O)}function L(){M(),Wn(!0),h&&clearTimeout(h),h=setTimeout(()=>{Wn(!1)},1e3)}function B(re){if(re.key==="ArrowUp"&&!f.trim()&&!T){re.preventDefault();const J=n.filter(oe=>oe.userId===(a==null?void 0:a.id));if(J.length>0){const oe=J[J.length-1];t(7,T=oe),t(2,f=oe.text)}}else re.key==="Escape"&&T?(re.preventDefault(),z()):re.key==="Enter"&&!re.shiftKey&&(re.preventDefault(),H())}function H(){f.trim()&&(T?(Oa(i,T.id,f.trim()),t(7,T=null)):(hn(i,f.trim(),"text",{replyTo:m==null?void 0:m.id,isSpoiler:A}),t(5,m=null)),t(2,f=""),Wn(!1),h&&clearTimeout(h),O&&t(13,O.style.height="auto",O))}function z(){t(7,T=null),t(2,f=""),O&&t(13,O.style.height="auto",O)}function R(re){hn(i,"","gif",{gifUrl:re.detail,replyTo:m==null?void 0:m.id,isSpoiler:A}),t(5,m=null),t(4,g=!1)}function x(re){t(5,m=re);const J=document.querySelector('input[type="text"]');J==null||J.focus()}function W(){t(5,m=null)}async function q(re){const J=re.target,oe=Array.from(J.files||[]);if(oe.length===0){console.log("No files selected");return}console.log("Files selected:",oe.length);const ye=1024*1024*1024;for(const _e of oe)if(_e.size>ye){alert(`File too large! Maximum size is 1GB per file. "${_e.name}" is ${(_e.size/1024/1024).toFixed(2)}MB`),J.value="";return}S=oe,t(10,b=await Promise.all(oe.map(async _e=>{if(_e.type.startsWith("image/")){const we=await new Promise(xe=>{const et=new FileReader;et.onload=Ke=>{var Pe;return xe((Pe=Ke.target)==null?void 0:Pe.result)},et.readAsDataURL(_e)});return{file:_e,preview:we}}return{file:_e}}))),J.value=""}function j(re){S=S.filter((J,oe)=>oe!==re),t(10,b=b.filter((J,oe)=>oe!==re))}function G(){S=[],t(10,b=[])}function Q(re){var J;re.preventDefault(),re.stopPropagation(),w++,(J=re.dataTransfer)!=null&&J.types.includes("Files")&&t(12,I=!0)}function Y(re){re.preventDefault(),re.stopPropagation(),w--,w===0&&t(12,I=!1)}async function te(re){var ye;re.preventDefault(),re.stopPropagation(),t(12,I=!1),w=0;const J=Array.from(((ye=re.dataTransfer)==null?void 0:ye.files)||[]);if(J.length===0)return;const oe=1024*1024*1024;for(const _e of J)if(_e.size>oe){alert(`File too large! Maximum size is 1GB per file. "${_e.name}" is ${(_e.size/1024/1024).toFixed(2)}MB`);return}S=J,t(10,b=await Promise.all(J.map(async _e=>{if(_e.type.startsWith("image/")){const we=await new Promise(xe=>{const et=new FileReader;et.onload=Ke=>{var Pe;return xe((Pe=Ke.target)==null?void 0:Pe.result)},et.readAsDataURL(_e)});return{file:_e,preview:we}}return{file:_e}})))}async function fe(){if(S.length===0)return;t(9,E=!0);const re=S.length;let J=0;try{const oe=window.location.origin.includes(":5173")?"http://localhost:3000":window.location.origin,ye=[];for(const _e of S){const we=await new Promise((xe,et)=>{const Ke=new FormData;Ke.append("file",_e),Ke.append("channelId",i);const Pe=new XMLHttpRequest;Pe.upload.addEventListener("progress",je=>{if(je.lengthComputable){const pt=je.loaded/je.total*100,ft=(J+pt/100)/re*100;t(8,C=Math.round(ft))}}),Pe.addEventListener("load",()=>{if(Pe.status===200){const je=JSON.parse(Pe.responseText);J++,xe({fileUrl:je.fileUrl,fileName:_e.name,fileSize:_e.size})}else et(new Error("Upload failed"))}),Pe.addEventListener("error",()=>{et(new Error("Upload failed"))}),Pe.open("POST",`${oe}/api/upload`),Pe.send(Ke)});ye.push(we)}ye.length===1?hn(i,f.trim()||`Shared: ${ye[0].fileName}`,"file",{fileUrl:ye[0].fileUrl,fileName:ye[0].fileName,fileSize:ye[0].fileSize,replyTo:m==null?void 0:m.id,isSpoiler:A}):hn(i,f.trim()||`Shared ${ye.length} files`,"file",{files:ye,replyTo:m==null?void 0:m.id,isSpoiler:A}),console.log("All files uploaded"),t(2,f=""),t(5,m=null),S=[],t(10,b=[]),t(9,E=!1),t(8,C=0)}catch(oe){console.error("Upload error:",oe),alert("Failed to upload files. Please try again."),t(9,E=!1),t(8,C=0)}}rs(()=>{N()});function se(re){st[re?"unshift":"push"](()=>{p=re,t(3,p)})}const ue=()=>t(4,g=!1),ce=re=>j(re);function le(){A=this.checked,t(11,A)}function he(re){st[re?"unshift":"push"](()=>{v=re,t(6,v)})}const Re=()=>v==null?void 0:v.click();function ae(re){st[re?"unshift":"push"](()=>{O=re,t(13,O)})}function Ve(){f=this.value,t(2,f)}const Te=()=>t(4,g=!g);return s.$$.update=()=>{s.$$.dirty[0]&2|s.$$.dirty[1]&1&&t(0,n=l[i]||[]),s.$$.dirty[0]&1&&t(14,r=n.filter(re=>re.isPinned)),s.$$.dirty[0]&1&&n.length&&N()},[n,i,f,p,g,m,v,T,C,E,b,A,I,O,r,o,u,L,B,H,z,R,x,W,q,j,G,Q,Y,te,fe,l,se,ue,ce,le,he,Re,ae,Ve,Te]}class $f extends ct{constructor(e){super(),ut(this,e,Jf,Kf,ot,{},null,[-1,-1])}}function ed(s){let e,t,n,r,i,a,l,o,u,f="Join Chat",p,h;return{c(){e=y("div"),t=y("div"),n=y("img"),i=F(),a=y("form"),l=y("input"),o=F(),u=y("button"),u.textContent=f,this.h()},l(g){e=k(g,"DIV",{class:!0});var m=D(e);t=k(m,"DIV",{class:!0});var v=D(t);n=k(v,"IMG",{src:!0,alt:!0,class:!0}),i=P(v),a=k(v,"FORM",{class:!0});var T=D(a);l=k(T,"INPUT",{type:!0,placeholder:!0,maxlength:!0,class:!0}),o=P(T),u=k(T,"BUTTON",{type:!0,class:!0,"data-svelte-h":!0}),$(u)!=="svelte-1oym1t5"&&(u.textContent=f),T.forEach(_),v.forEach(_),m.forEach(_),this.h()},h(){Be(n.src,r="/wabi-logo.png")||d(n,"src",r),d(n,"alt","Wabi"),d(n,"class","logo svelte-1vqfptn"),d(l,"type","text"),d(l,"placeholder","Enter your username"),d(l,"maxlength","20"),l.required=!0,l.autofocus=!0,d(l,"class","svelte-1vqfptn"),d(u,"type","submit"),d(u,"class","svelte-1vqfptn"),d(a,"class","svelte-1vqfptn"),d(t,"class","login-box svelte-1vqfptn"),d(e,"class","login-container svelte-1vqfptn")},m(g,m){V(g,e,m),c(e,t),c(t,n),c(t,i),c(t,a),c(a,l),lt(l,s[0]),c(a,o),c(a,u),l.focus(),p||(h=[X(l,"input",s[2]),X(a,"submit",Ga(s[1]))],p=!0)},p(g,[m]){m&1&&l.value!==g[0]&&lt(l,g[0])},i:Ce,o:Ce,d(g){g&&_(e),p=!1,De(h)}}}function td(s,e,t){const n=or();let r="";function i(){r.trim()&&n("login",r.trim())}function a(){r=this.value,t(0,r)}return[r,i,a]}class sd extends ct{constructor(e){super(),ut(this,e,td,ed,ot,{})}}function tl(s,e,t){const n=s.slice();return n[27]=e[t],n}function sl(s){let e,t,n,r="Total Messages",i,a,l=s[3].totalMessages.toLocaleString()+"",o,u,f,p,h="Storage Used",g,m,v=An(s[3].totalSize)+"",T,C,E,S,b="Archives",A,I,w=s[3].archives.length+"",O,N,M,L,B,H="Rotation Period",z,R,x,W="Weekly",q,j="Monthly",G,Q="Every 6 Months",Y,te="Yearly",fe,se,ue="How often to create a new archive file (like changing batteries)",ce,le,he,Re,ae="Keep Last",Ve,Te,re,J,oe,ye="archives",_e,we,xe="Older archives are automatically deleted to save space",et,Ke,Pe,je,pt="ðŸ—‘ï¸ Clear All History",ft,nt;function yt(ve,ee){return ve[3].archives.length>0?rd:nd}let Ut=yt(s),rt=Ut(s);return{c(){e=y("div"),t=y("div"),n=y("div"),n.textContent=r,i=F(),a=y("div"),o=K(l),u=F(),f=y("div"),p=y("div"),p.textContent=h,g=F(),m=y("div"),T=K(v),C=F(),E=y("div"),S=y("div"),S.textContent=b,A=F(),I=y("div"),O=K(w),N=F(),M=y("div"),L=y("label"),B=y("span"),B.textContent=H,z=F(),R=y("select"),x=y("option"),x.textContent=W,q=y("option"),q.textContent=j,G=y("option"),G.textContent=Q,Y=y("option"),Y.textContent=te,fe=F(),se=y("p"),se.textContent=ue,ce=F(),le=y("div"),he=y("label"),Re=y("span"),Re.textContent=ae,Ve=F(),Te=y("div"),re=y("input"),J=F(),oe=y("span"),oe.textContent=ye,_e=F(),we=y("p"),we.textContent=xe,et=F(),rt.c(),Ke=F(),Pe=y("div"),je=y("button"),je.textContent=pt,this.h()},l(ve){e=k(ve,"DIV",{class:!0});var ee=D(e);t=k(ee,"DIV",{class:!0});var be=D(t);n=k(be,"DIV",{class:!0,"data-svelte-h":!0}),$(n)!=="svelte-akn32o"&&(n.textContent=r),i=P(be),a=k(be,"DIV",{class:!0});var wt=D(a);o=Z(wt,l),wt.forEach(_),be.forEach(_),u=P(ee),f=k(ee,"DIV",{class:!0});var qe=D(f);p=k(qe,"DIV",{class:!0,"data-svelte-h":!0}),$(p)!=="svelte-5vlbe4"&&(p.textContent=h),g=P(qe),m=k(qe,"DIV",{class:!0});var Qe=D(m);T=Z(Qe,v),Qe.forEach(_),qe.forEach(_),C=P(ee),E=k(ee,"DIV",{class:!0});var Bt=D(E);S=k(Bt,"DIV",{class:!0,"data-svelte-h":!0}),$(S)!=="svelte-1e1df45"&&(S.textContent=b),A=P(Bt),I=k(Bt,"DIV",{class:!0});var Mt=D(I);O=Z(Mt,w),Mt.forEach(_),Bt.forEach(_),ee.forEach(_),N=P(ve),M=k(ve,"DIV",{class:!0});var Dt=D(M);L=k(Dt,"LABEL",{class:!0});var xt=D(L);B=k(xt,"SPAN",{class:!0,"data-svelte-h":!0}),$(B)!=="svelte-608xyy"&&(B.textContent=H),z=P(xt),R=k(xt,"SELECT",{class:!0});var dt=D(R);x=k(dt,"OPTION",{"data-svelte-h":!0}),$(x)!=="svelte-crm6lv"&&(x.textContent=W),q=k(dt,"OPTION",{"data-svelte-h":!0}),$(q)!=="svelte-hva46z"&&(q.textContent=j),G=k(dt,"OPTION",{"data-svelte-h":!0}),$(G)!=="svelte-1s0lvql"&&(G.textContent=Q),Y=k(dt,"OPTION",{"data-svelte-h":!0}),$(Y)!=="svelte-jp5v27"&&(Y.textContent=te),dt.forEach(_),xt.forEach(_),fe=P(Dt),se=k(Dt,"P",{class:!0,"data-svelte-h":!0}),$(se)!=="svelte-qu5pay"&&(se.textContent=ue),Dt.forEach(_),ce=P(ve),le=k(ve,"DIV",{class:!0});var is=D(le);he=k(is,"LABEL",{class:!0});var Xe=D(he);Re=k(Xe,"SPAN",{class:!0,"data-svelte-h":!0}),$(Re)!=="svelte-1im50qe"&&(Re.textContent=ae),Ve=P(Xe),Te=k(Xe,"DIV",{class:!0});var Jt=D(Te);re=k(Jt,"INPUT",{type:!0,min:!0,max:!0,class:!0}),J=P(Jt),oe=k(Jt,"SPAN",{class:!0,"data-svelte-h":!0}),$(oe)!=="svelte-nj3imy"&&(oe.textContent=ye),Jt.forEach(_),Xe.forEach(_),_e=P(is),we=k(is,"P",{class:!0,"data-svelte-h":!0}),$(we)!=="svelte-he359b"&&(we.textContent=xe),is.forEach(_),et=P(ve),rt.l(ve),Ke=P(ve),Pe=k(ve,"DIV",{class:!0});var _s=D(Pe);je=k(_s,"BUTTON",{class:!0,"data-svelte-h":!0}),$(je)!=="svelte-1u0bcm7"&&(je.textContent=pt),_s.forEach(_),this.h()},h(){d(n,"class","stat-label svelte-1jfalu6"),d(a,"class","stat-value svelte-1jfalu6"),d(t,"class","stat svelte-1jfalu6"),d(p,"class","stat-label svelte-1jfalu6"),d(m,"class","stat-value svelte-1jfalu6"),d(f,"class","stat svelte-1jfalu6"),d(S,"class","stat-label svelte-1jfalu6"),d(I,"class","stat-value svelte-1jfalu6"),d(E,"class","stat svelte-1jfalu6"),d(e,"class","stats-panel svelte-1jfalu6"),d(B,"class","label svelte-1jfalu6"),x.__value="week",lt(x,x.__value),q.__value="month",lt(q,q.__value),G.__value="half-year",lt(G,G.__value),Y.__value="year",lt(Y,Y.__value),d(R,"class","svelte-1jfalu6"),s[1]===void 0&&Wa(()=>s[20].call(R)),d(L,"class","svelte-1jfalu6"),d(se,"class","hint svelte-1jfalu6"),d(M,"class","setting-group svelte-1jfalu6"),d(Re,"class","label svelte-1jfalu6"),d(re,"type","number"),d(re,"min","1"),d(re,"max","52"),d(re,"class","svelte-1jfalu6"),d(oe,"class","unit svelte-1jfalu6"),d(Te,"class","number-input-group svelte-1jfalu6"),d(he,"class","svelte-1jfalu6"),d(we,"class","hint svelte-1jfalu6"),d(le,"class","setting-group svelte-1jfalu6"),d(je,"class","btn-danger svelte-1jfalu6"),d(Pe,"class","actions svelte-1jfalu6")},m(ve,ee){V(ve,e,ee),c(e,t),c(t,n),c(t,i),c(t,a),c(a,o),c(e,u),c(e,f),c(f,p),c(f,g),c(f,m),c(m,T),c(e,C),c(e,E),c(E,S),c(E,A),c(E,I),c(I,O),V(ve,N,ee),V(ve,M,ee),c(M,L),c(L,B),c(L,z),c(L,R),c(R,x),c(R,q),c(R,G),c(R,Y),Rr(R,s[1],!0),c(M,fe),c(M,se),V(ve,ce,ee),V(ve,le,ee),c(le,he),c(he,Re),c(he,Ve),c(he,Te),c(Te,re),lt(re,s[2]),c(Te,J),c(Te,oe),c(le,_e),c(le,we),V(ve,et,ee),rt.m(ve,ee),V(ve,Ke,ee),V(ve,Pe,ee),c(Pe,je),ft||(nt=[X(R,"change",s[20]),X(R,"change",s[11]),X(re,"input",s[21]),X(re,"change",s[12]),X(je,"click",s[17])],ft=!0)},p(ve,ee){ee&8&&l!==(l=ve[3].totalMessages.toLocaleString()+"")&&ne(o,l),ee&8&&v!==(v=An(ve[3].totalSize)+"")&&ne(T,v),ee&8&&w!==(w=ve[3].archives.length+"")&&ne(O,w),ee&2&&Rr(R,ve[1]),ee&4&&Yl(re.value)!==ve[2]&&lt(re,ve[2]),Ut===(Ut=yt(ve))&&rt?rt.p(ve,ee):(rt.d(1),rt=Ut(ve),rt&&(rt.c(),rt.m(Ke.parentNode,Ke)))},d(ve){ve&&(_(e),_(N),_(M),_(ce),_(le),_(et),_(Ke),_(Pe)),rt.d(ve),ft=!1,De(nt)}}}function nd(s){let e,t="<p>No archives yet. Messages will be saved as you chat.</p>";return{c(){e=y("div"),e.innerHTML=t,this.h()},l(n){e=k(n,"DIV",{class:!0,"data-svelte-h":!0}),$(e)!=="svelte-kqcvlb"&&(e.innerHTML=t),this.h()},h(){d(e,"class","empty-state svelte-1jfalu6")},m(n,r){V(n,e,r)},p:Ce,d(n){n&&_(e)}}}function rd(s){let e,t,n,r="Archive History",i,a,l="ðŸ“¦ Export All",o,u,f,p,h=ze(s[3].archives),g=[];for(let m=0;m<h.length;m+=1)g[m]=nl(tl(s,h,m));return{c(){e=y("div"),t=y("div"),n=y("h4"),n.textContent=r,i=F(),a=y("button"),a.textContent=l,o=F(),u=y("div");for(let m=0;m<g.length;m+=1)g[m].c();this.h()},l(m){e=k(m,"DIV",{class:!0});var v=D(e);t=k(v,"DIV",{class:!0});var T=D(t);n=k(T,"H4",{class:!0,"data-svelte-h":!0}),$(n)!=="svelte-1i91zrs"&&(n.textContent=r),i=P(T),a=k(T,"BUTTON",{class:!0,"data-svelte-h":!0}),$(a)!=="svelte-197zvis"&&(a.textContent=l),T.forEach(_),o=P(v),u=k(v,"DIV",{class:!0});var C=D(u);for(let E=0;E<g.length;E+=1)g[E].l(C);C.forEach(_),v.forEach(_),this.h()},h(){d(n,"class","svelte-1jfalu6"),d(a,"class","btn-small svelte-1jfalu6"),d(t,"class","section-header svelte-1jfalu6"),d(u,"class","archive-list svelte-1jfalu6"),d(e,"class","archives-section svelte-1jfalu6")},m(m,v){V(m,e,v),c(e,t),c(t,n),c(t,i),c(t,a),c(e,o),c(e,u);for(let T=0;T<g.length;T+=1)g[T]&&g[T].m(u,null);f||(p=X(a,"click",s[16]),f=!0)},p(m,v){if(v&40968){h=ze(m[3].archives);let T;for(T=0;T<h.length;T+=1){const C=tl(m,h,T);g[T]?g[T].p(C,v):(g[T]=nl(C),g[T].c(),g[T].m(u,null))}for(;T<g.length;T+=1)g[T].d(1);g.length=h.length}},d(m){m&&_(e),Dn(g,m),f=!1,p()}}}function nl(s){let e,t,n,r=Cn(s[27].period)+"",i,a,l,o=An(s[27].size)+"",u,f,p=s[27].messageCount.toLocaleString()+"",h,g,m,v,T,C="ðŸ’¾",E,S,b="ðŸ—‘ï¸",A,I,w;function O(){return s[22](s[27])}function N(){return s[23](s[27])}return{c(){e=y("div"),t=y("div"),n=y("span"),i=K(r),a=F(),l=y("span"),u=K(o),f=K(" â€¢ "),h=K(p),g=K(" messages"),m=F(),v=y("div"),T=y("button"),T.textContent=C,E=F(),S=y("button"),S.textContent=b,A=F(),this.h()},l(M){e=k(M,"DIV",{class:!0});var L=D(e);t=k(L,"DIV",{class:!0});var B=D(t);n=k(B,"SPAN",{class:!0});var H=D(n);i=Z(H,r),H.forEach(_),a=P(B),l=k(B,"SPAN",{class:!0});var z=D(l);u=Z(z,o),f=Z(z," â€¢ "),h=Z(z,p),g=Z(z," messages"),z.forEach(_),B.forEach(_),m=P(L),v=k(L,"DIV",{class:!0});var R=D(v);T=k(R,"BUTTON",{class:!0,title:!0,"data-svelte-h":!0}),$(T)!=="svelte-13e8aja"&&(T.textContent=C),E=P(R),S=k(R,"BUTTON",{class:!0,title:!0,"data-svelte-h":!0}),$(S)!=="svelte-1br206h"&&(S.textContent=b),R.forEach(_),A=P(L),L.forEach(_),this.h()},h(){d(n,"class","archive-period svelte-1jfalu6"),d(l,"class","archive-meta svelte-1jfalu6"),d(t,"class","archive-info svelte-1jfalu6"),d(T,"class","btn-icon svelte-1jfalu6"),d(T,"title","Export"),d(S,"class","btn-icon danger svelte-1jfalu6"),d(S,"title","Delete"),d(v,"class","archive-actions svelte-1jfalu6"),d(e,"class","archive-item svelte-1jfalu6")},m(M,L){V(M,e,L),c(e,t),c(t,n),c(n,i),c(t,a),c(t,l),c(l,u),c(l,f),c(l,h),c(l,g),c(e,m),c(e,v),c(v,T),c(v,E),c(v,S),c(e,A),I||(w=[X(T,"click",O),X(S,"click",N)],I=!0)},p(M,L){s=M,L&8&&r!==(r=Cn(s[27].period)+"")&&ne(i,r),L&8&&o!==(o=An(s[27].size)+"")&&ne(u,o),L&8&&p!==(p=s[27].messageCount.toLocaleString()+"")&&ne(h,p)},d(M){M&&_(e),I=!1,De(w)}}}function id(s){let e,t,n='<h3 class="svelte-1jfalu6">ðŸ’¾ Local Storage</h3> <p class="subtitle svelte-1jfalu6">Your chat history is saved only on your device. The server stores nothing permanently.</p>',r,i,a,l,o,u,f="Save chat history locally",p,h,g="When enabled, messages are stored in your browser. You control your data.",m,v,T,C,E,S,b,A,I,w,O=s[0]&&sl(s);return T=new Cs({props:{isOpen:s[4],title:"Disable Local Storage",message:"Disable local storage? Your saved history will remain until you clear it manually.",confirmText:"Disable",variant:"warning",onConfirm:s[9],onCancel:s[10]}}),E=new Cs({props:{isOpen:s[5],title:"Delete Archive",message:`Delete archive "${Cn(s[6])}"?`,confirmText:"Delete",variant:"danger",onConfirm:s[14],onCancel:s[24]}}),b=new Cs({props:{isOpen:s[7],title:"Delete All History",message:"Delete ALL saved chat history? This cannot be undone!",confirmText:"Delete All",variant:"danger",onConfirm:s[18],onCancel:s[25]}}),{c(){e=y("div"),t=y("div"),t.innerHTML=n,r=F(),i=y("div"),a=y("label"),l=y("input"),o=F(),u=y("span"),u.textContent=f,p=F(),h=y("p"),h.textContent=g,m=F(),O&&O.c(),v=F(),Ye(T.$$.fragment),C=F(),Ye(E.$$.fragment),S=F(),Ye(b.$$.fragment),this.h()},l(N){e=k(N,"DIV",{class:!0});var M=D(e);t=k(M,"DIV",{class:!0,"data-svelte-h":!0}),$(t)!=="svelte-s9o5r3"&&(t.innerHTML=n),r=P(M),i=k(M,"DIV",{class:!0});var L=D(i);a=k(L,"LABEL",{class:!0});var B=D(a);l=k(B,"INPUT",{type:!0,class:!0}),o=P(B),u=k(B,"SPAN",{class:!0,"data-svelte-h":!0}),$(u)!=="svelte-1ssgcs1"&&(u.textContent=f),B.forEach(_),p=P(L),h=k(L,"P",{class:!0,"data-svelte-h":!0}),$(h)!=="svelte-1hbmqvb"&&(h.textContent=g),L.forEach(_),m=P(M),O&&O.l(M),M.forEach(_),v=P(N),We(T.$$.fragment,N),C=P(N),We(E.$$.fragment,N),S=P(N),We(b.$$.fragment,N),this.h()},h(){d(t,"class","header svelte-1jfalu6"),d(l,"type","checkbox"),d(l,"class","svelte-1jfalu6"),d(u,"class","toggle-label"),d(a,"class","toggle-setting svelte-1jfalu6"),d(h,"class","hint svelte-1jfalu6"),d(i,"class","setting-group svelte-1jfalu6"),d(e,"class","storage-settings svelte-1jfalu6")},m(N,M){V(N,e,M),c(e,t),c(e,r),c(e,i),c(i,a),c(a,l),l.checked=s[0],c(a,o),c(a,u),c(i,p),c(i,h),c(e,m),O&&O.m(e,null),V(N,v,M),Ge(T,N,M),V(N,C,M),Ge(E,N,M),V(N,S,M),Ge(b,N,M),A=!0,I||(w=[X(l,"change",s[19]),X(l,"change",s[8])],I=!0)},p(N,[M]){M&1&&(l.checked=N[0]),N[0]?O?O.p(N,M):(O=sl(N),O.c(),O.m(e,null)):O&&(O.d(1),O=null);const L={};M&16&&(L.isOpen=N[4]),T.$set(L);const B={};M&32&&(B.isOpen=N[5]),M&64&&(B.message=`Delete archive "${Cn(N[6])}"?`),M&32&&(B.onCancel=N[24]),E.$set(B);const H={};M&128&&(H.isOpen=N[7]),M&128&&(H.onCancel=N[25]),b.$set(H)},i(N){A||(ke(T.$$.fragment,N),ke(E.$$.fragment,N),ke(b.$$.fragment,N),A=!0)},o(N){Ae(T.$$.fragment,N),Ae(E.$$.fragment,N),Ae(b.$$.fragment,N),A=!1},d(N){N&&(_(e),_(v),_(C),_(S)),O&&O.d(),He(T,N),He(E,N),He(b,N),I=!1,De(w)}}}function An(s){if(s===0)return"0 B";const e=s/(1024*1024);return e>=.01?`${e.toFixed(2)} MB`:`${(s/1024).toFixed(2)} KB`}function Cn(s){if(s.includes("-W")){const[e,t]=s.split("-W");return`Week ${t}, ${e}`}else if(s.includes("-H")){const[e,t]=s.split("-");return`${t==="H1"?"First":"Second"} Half ${e}`}else if(s.match(/^\d{4}-\d{2}$/)){const[e,t]=s.split("-");return`${["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][parseInt(t)-1]} ${e}`}else return`Year ${s}`}function ld(s,e,t){let n=!1,r=Pt.getRotationPeriod(),i=Pt.getMaxArchives(),a={archives:[],totalSize:0,totalMessages:0},l=!1,o=!1,u="",f=!1;async function p(){t(0,n=!n),await Pt.setEnabled(n),n?await I():t(4,l=!0)}async function h(){t(4,l=!1),await I()}function g(){t(0,n=!0),Pt.setEnabled(!0),t(4,l=!1)}async function m(){await Pt.setRotationPeriod(r),await I()}async function v(){await Pt.setMaxArchives(i),await I()}async function T(z){t(6,u=z),t(5,o=!0)}async function C(){await Pt.deleteArchive(u),await I(),t(5,o=!1)}async function E(z){await Pt.exportArchive(z)}async function S(){await Pt.exportArchives()}async function b(){t(7,f=!0)}async function A(){await Pt.clearAllHistory(),await I(),t(7,f=!1)}async function I(){t(3,a=await Pt.getStats())}rs(async()=>{t(0,n=await Pt.isEnabled()),await I()});function w(){n=this.checked,t(0,n)}function O(){r=Ya(this),t(1,r)}function N(){i=Yl(this.value),t(2,i)}return[n,r,i,a,l,o,u,f,p,h,g,m,v,T,C,E,S,b,A,w,O,N,z=>E(z.period),z=>T(z.period),()=>t(5,o=!1),()=>t(7,f=!1)]}class ad extends ct{constructor(e){super(),ut(this,e,ld,id,ot,{})}}function rl(s){let e,t,n,r,i="âš™ï¸ Settings",a,l,o="âœ•",u,f,p,h,g="ðŸŽ¤ Audio & Video",m,v,T,C='<span class="setting-label svelte-1l9ajc2">Sound Effects</span> <span class="setting-description svelte-1l9ajc2">Play sounds for messages and notifications</span>',E,S,b=s[1]?"ðŸ”Š":"ðŸ”‡",A,I,w,O,N='<span class="setting-label svelte-1l9ajc2">Microphone</span> <span class="setting-description svelte-1l9ajc2">Enable microphone for voice calls</span>',M,L,B=s[3]?"ðŸŽ¤":"ðŸ”‡",H,z,R,x,W='<span class="setting-label svelte-1l9ajc2">Camera</span> <span class="setting-description svelte-1l9ajc2">Enable camera for video calls</span>',q,j,G=s[4]?"ðŸ“¹":"ðŸ“·",Q,Y,te,fe,se="ðŸ”” Notifications",ue,ce,le,he='<span class="setting-label svelte-1l9ajc2">Desktop Notifications</span> <span class="setting-description svelte-1l9ajc2">Get notified when you receive new messages</span>',Re,ae,Ve=s[2]?"âœ… Enabled":"ðŸ”” Enable",Te,re,J,oe,ye="ðŸŽ¨ Appearance",_e,we,xe,et='<span class="setting-label svelte-1l9ajc2">Theme</span> <span class="setting-description svelte-1l9ajc2">Switch between light and dark mode</span>',Ke,Pe,je=s[5]==="dark"?"ðŸŒ™":"â˜€ï¸",pt,ft,nt,yt,Ut="ðŸ–¥ï¸ Server Management",rt,ve,ee,be='<span class="setting-label svelte-1l9ajc2">Clear All Server Messages</span> <span class="setting-description svelte-1l9ajc2">Delete all messages from the server for all users (cannot be undone)</span>',wt,qe,Qe="ðŸ—‘ï¸ Clear Server",Bt,Mt,Dt,xt,dt,is='<h3 class="svelte-1l9ajc2">â„¹ï¸ About</h3> <div class="about-info svelte-1l9ajc2"><p class="svelte-1l9ajc2"><strong class="svelte-1l9ajc2">Wabi Chat</strong></p> <p class="svelte-1l9ajc2">Privacy-first ephemeral chat. No tracking. No data collection.</p> <p class="svelte-1l9ajc2">Server stores nothing permanently. You control your data.</p> <p class="version svelte-1l9ajc2">Version 1.0.0</p></div>',Xe,Jt,_s;return Dt=new ad({}),{c(){e=y("div"),t=y("div"),n=y("div"),r=y("h2"),r.textContent=i,a=F(),l=y("button"),l.textContent=o,u=F(),f=y("div"),p=y("div"),h=y("h3"),h.textContent=g,m=F(),v=y("div"),T=y("div"),T.innerHTML=C,E=F(),S=y("button"),A=K(b),I=F(),w=y("div"),O=y("div"),O.innerHTML=N,M=F(),L=y("button"),H=K(B),z=F(),R=y("div"),x=y("div"),x.innerHTML=W,q=F(),j=y("button"),Q=K(G),Y=F(),te=y("div"),fe=y("h3"),fe.textContent=se,ue=F(),ce=y("div"),le=y("div"),le.innerHTML=he,Re=F(),ae=y("button"),Te=K(Ve),re=F(),J=y("div"),oe=y("h3"),oe.textContent=ye,_e=F(),we=y("div"),xe=y("div"),xe.innerHTML=et,Ke=F(),Pe=y("button"),pt=K(je),ft=F(),nt=y("div"),yt=y("h3"),yt.textContent=Ut,rt=F(),ve=y("div"),ee=y("div"),ee.innerHTML=be,wt=F(),qe=y("button"),qe.textContent=Qe,Bt=F(),Mt=y("div"),Ye(Dt.$$.fragment),xt=F(),dt=y("div"),dt.innerHTML=is,this.h()},l(Se){e=k(Se,"DIV",{class:!0});var Je=D(e);t=k(Je,"DIV",{class:!0});var Rs=D(t);n=k(Rs,"DIV",{class:!0});var bs=D(n);r=k(bs,"H2",{class:!0,"data-svelte-h":!0}),$(r)!=="svelte-15bbpfh"&&(r.textContent=i),a=P(bs),l=k(bs,"BUTTON",{class:!0,"data-svelte-h":!0}),$(l)!=="svelte-3o141q"&&(l.textContent=o),bs.forEach(_),u=P(Rs),f=k(Rs,"DIV",{class:!0});var bt=D(f);p=k(bt,"DIV",{class:!0});var jt=D(p);h=k(jt,"H3",{class:!0,"data-svelte-h":!0}),$(h)!=="svelte-1tdb4hv"&&(h.textContent=g),m=P(jt),v=k(jt,"DIV",{class:!0});var ks=D(v);T=k(ks,"DIV",{class:!0,"data-svelte-h":!0}),$(T)!=="svelte-5e193f"&&(T.innerHTML=C),E=P(ks),S=k(ks,"BUTTON",{class:!0});var an=D(S);A=Z(an,b),an.forEach(_),ks.forEach(_),I=P(jt),w=k(jt,"DIV",{class:!0});var Et=D(w);O=k(Et,"DIV",{class:!0,"data-svelte-h":!0}),$(O)!=="svelte-ql0oob"&&(O.innerHTML=N),M=P(Et),L=k(Et,"BUTTON",{class:!0});var $t=D(L);H=Z($t,B),$t.forEach(_),Et.forEach(_),z=P(jt),R=k(jt,"DIV",{class:!0});var ys=D(R);x=k(ys,"DIV",{class:!0,"data-svelte-h":!0}),$(x)!=="svelte-fu2kxq"&&(x.innerHTML=W),q=P(ys),j=k(ys,"BUTTON",{class:!0});var zs=D(j);Q=Z(zs,G),zs.forEach(_),ys.forEach(_),jt.forEach(_),Y=P(bt),te=k(bt,"DIV",{class:!0});var hs=D(te);fe=k(hs,"H3",{class:!0,"data-svelte-h":!0}),$(fe)!=="svelte-yb4801"&&(fe.textContent=se),ue=P(hs),ce=k(hs,"DIV",{class:!0});var ws=D(ce);le=k(ws,"DIV",{class:!0,"data-svelte-h":!0}),$(le)!=="svelte-11j8eba"&&(le.innerHTML=he),Re=P(ws),ae=k(ws,"BUTTON",{class:!0});var Vt=D(ae);Te=Z(Vt,Ve),Vt.forEach(_),ws.forEach(_),hs.forEach(_),re=P(bt),J=k(bt,"DIV",{class:!0});var Es=D(J);oe=k(Es,"H3",{class:!0,"data-svelte-h":!0}),$(oe)!=="svelte-bdq4j0"&&(oe.textContent=ye),_e=P(Es),we=k(Es,"DIV",{class:!0});var Ts=D(we);xe=k(Ts,"DIV",{class:!0,"data-svelte-h":!0}),$(xe)!=="svelte-1expsbb"&&(xe.innerHTML=et),Ke=P(Ts),Pe=k(Ts,"BUTTON",{class:!0});var qs=D(Pe);pt=Z(qs,je),qs.forEach(_),Ts.forEach(_),Es.forEach(_),ft=P(bt),nt=k(bt,"DIV",{class:!0});var Ss=D(nt);yt=k(Ss,"H3",{class:!0,"data-svelte-h":!0}),$(yt)!=="svelte-13bxj89"&&(yt.textContent=Ut),rt=P(Ss),ve=k(Ss,"DIV",{class:!0});var Ps=D(ve);ee=k(Ps,"DIV",{class:!0,"data-svelte-h":!0}),$(ee)!=="svelte-1kywvm7"&&(ee.innerHTML=be),wt=P(Ps),qe=k(Ps,"BUTTON",{class:!0,"data-svelte-h":!0}),$(qe)!=="svelte-uzfcg3"&&(qe.textContent=Qe),Ps.forEach(_),Ss.forEach(_),Bt=P(bt),Mt=k(bt,"DIV",{class:!0});var ge=D(Mt);We(Dt.$$.fragment,ge),ge.forEach(_),xt=P(bt),dt=k(bt,"DIV",{class:!0,"data-svelte-h":!0}),$(dt)!=="svelte-137zy12"&&(dt.innerHTML=is),bt.forEach(_),Rs.forEach(_),Je.forEach(_),this.h()},h(){d(r,"class","svelte-1l9ajc2"),d(l,"class","close-btn svelte-1l9ajc2"),d(n,"class","modal-header svelte-1l9ajc2"),d(h,"class","svelte-1l9ajc2"),d(T,"class","setting-info svelte-1l9ajc2"),d(S,"class","toggle-btn svelte-1l9ajc2"),me(S,"active",s[1]),d(v,"class","setting-item svelte-1l9ajc2"),d(O,"class","setting-info svelte-1l9ajc2"),d(L,"class","toggle-btn svelte-1l9ajc2"),me(L,"active",s[3]),d(w,"class","setting-item svelte-1l9ajc2"),d(x,"class","setting-info svelte-1l9ajc2"),d(j,"class","toggle-btn svelte-1l9ajc2"),me(j,"active",s[4]),d(R,"class","setting-item svelte-1l9ajc2"),d(p,"class","settings-section svelte-1l9ajc2"),d(fe,"class","svelte-1l9ajc2"),d(le,"class","setting-info svelte-1l9ajc2"),d(ae,"class","action-btn svelte-1l9ajc2"),me(ae,"active",s[2]),d(ce,"class","setting-item svelte-1l9ajc2"),d(te,"class","settings-section svelte-1l9ajc2"),d(oe,"class","svelte-1l9ajc2"),d(xe,"class","setting-info svelte-1l9ajc2"),d(Pe,"class","toggle-btn svelte-1l9ajc2"),me(Pe,"active",s[5]==="light"),d(we,"class","setting-item svelte-1l9ajc2"),d(J,"class","settings-section svelte-1l9ajc2"),d(yt,"class","svelte-1l9ajc2"),d(ee,"class","setting-info svelte-1l9ajc2"),d(qe,"class","action-btn danger svelte-1l9ajc2"),d(ve,"class","setting-item svelte-1l9ajc2"),d(nt,"class","settings-section svelte-1l9ajc2"),d(Mt,"class","settings-section svelte-1l9ajc2"),d(dt,"class","settings-section svelte-1l9ajc2"),d(f,"class","settings-sections svelte-1l9ajc2"),d(t,"class","modal-content svelte-1l9ajc2"),d(e,"class","modal-overlay svelte-1l9ajc2")},m(Se,Je){V(Se,e,Je),c(e,t),c(t,n),c(n,r),c(n,a),c(n,l),c(t,u),c(t,f),c(f,p),c(p,h),c(p,m),c(p,v),c(v,T),c(v,E),c(v,S),c(S,A),c(p,I),c(p,w),c(w,O),c(w,M),c(w,L),c(L,H),c(p,z),c(p,R),c(R,x),c(R,q),c(R,j),c(j,Q),c(f,Y),c(f,te),c(te,fe),c(te,ue),c(te,ce),c(ce,le),c(ce,Re),c(ce,ae),c(ae,Te),c(f,re),c(f,J),c(J,oe),c(J,_e),c(J,we),c(we,xe),c(we,Ke),c(we,Pe),c(Pe,pt),c(f,ft),c(f,nt),c(nt,yt),c(nt,rt),c(nt,ve),c(ve,ee),c(ve,wt),c(ve,qe),c(f,Bt),c(f,Mt),Ge(Dt,Mt,null),c(f,xt),c(f,dt),Xe=!0,Jt||(_s=[X(l,"click",s[16]),X(S,"click",s[8]),X(L,"click",s[9]),X(j,"click",s[10]),X(ae,"click",s[12]),X(Pe,"click",s[11]),X(qe,"click",s[14]),X(t,"click",vt(s[17])),X(e,"click",s[16])],Jt=!0)},p(Se,Je){(!Xe||Je&2)&&b!==(b=Se[1]?"ðŸ”Š":"ðŸ”‡")&&ne(A,b),(!Xe||Je&2)&&me(S,"active",Se[1]),(!Xe||Je&8)&&B!==(B=Se[3]?"ðŸŽ¤":"ðŸ”‡")&&ne(H,B),(!Xe||Je&8)&&me(L,"active",Se[3]),(!Xe||Je&16)&&G!==(G=Se[4]?"ðŸ“¹":"ðŸ“·")&&ne(Q,G),(!Xe||Je&16)&&me(j,"active",Se[4]),(!Xe||Je&4)&&Ve!==(Ve=Se[2]?"âœ… Enabled":"ðŸ”” Enable")&&ne(Te,Ve),(!Xe||Je&4)&&me(ae,"active",Se[2]),(!Xe||Je&32)&&je!==(je=Se[5]==="dark"?"ðŸŒ™":"â˜€ï¸")&&ne(pt,je),(!Xe||Je&32)&&me(Pe,"active",Se[5]==="light")},i(Se){Xe||(ke(Dt.$$.fragment,Se),Xe=!0)},o(Se){Ae(Dt.$$.fragment,Se),Xe=!1},d(Se){Se&&_(e),He(Dt),Jt=!1,De(_s)}}}function od(s){let e,t,n,r,i,a=s[0]&&rl(s);return t=new Cs({props:{isOpen:s[6],title:"Clear Local Data",message:"Are you sure you want to clear all chat data? This cannot be undone.",confirmText:"Clear Data",variant:"danger",onConfirm:s[13],onCancel:s[18]}}),r=new Cs({props:{isOpen:s[7],title:"Clear Server Messages",message:"Are you sure you want to delete ALL messages from the server? This will clear messages for all users and cannot be undone!",confirmText:"Delete All",variant:"danger",onConfirm:s[15],onCancel:s[19]}}),{c(){a&&a.c(),e=F(),Ye(t.$$.fragment),n=F(),Ye(r.$$.fragment)},l(l){a&&a.l(l),e=P(l),We(t.$$.fragment,l),n=P(l),We(r.$$.fragment,l)},m(l,o){a&&a.m(l,o),V(l,e,o),Ge(t,l,o),V(l,n,o),Ge(r,l,o),i=!0},p(l,[o]){l[0]?a?(a.p(l,o),o&1&&ke(a,1)):(a=rl(l),a.c(),ke(a,1),a.m(e.parentNode,e)):a&&(xs(),Ae(a,1,1,()=>{a=null}),Us());const u={};o&64&&(u.isOpen=l[6]),o&64&&(u.onCancel=l[18]),t.$set(u);const f={};o&128&&(f.isOpen=l[7]),o&128&&(f.onCancel=l[19]),r.$set(f)},i(l){i||(ke(a),ke(t.$$.fragment,l),ke(r.$$.fragment,l),i=!0)},o(l){Ae(a),Ae(t.$$.fragment,l),Ae(r.$$.fragment,l),i=!1},d(l){l&&(_(e),_(n)),a&&a.d(l),He(t,l),He(r,l)}}}function cd(s,e,t){Ne(s,ns,w=>t(20,w)),Ne(s,Zt,w=>t(21,w)),Ne(s,St,w=>t(22,w));let{isOpen:n=!1}=e,r=!0,i=!0,a=!0,l=!0,o="dark",u=!1,f=!1;rs(()=>{t(1,r=localStorage.getItem("soundEnabled")!=="false"),t(2,i=localStorage.getItem("notificationsEnabled")!=="false"),t(3,a=localStorage.getItem("micEnabled")!=="false"),t(4,l=localStorage.getItem("cameraEnabled")!=="false"),t(5,o=localStorage.getItem("theme")||"dark")});function p(){t(1,r=!r),localStorage.setItem("soundEnabled",r.toString())}function h(){t(3,a=!a),localStorage.setItem("micEnabled",a.toString())}function g(){t(4,l=!l),localStorage.setItem("cameraEnabled",l.toString())}function m(){t(5,o=o==="dark"?"light":"dark"),localStorage.setItem("theme",o),document.documentElement.setAttribute("data-theme",o)}async function v(){if(!("Notification"in window)){alert("This browser does not support notifications");return}if(Notification.permission==="granted"){alert("Notifications are already enabled!");return}await Notification.requestPermission()==="granted"?(t(2,i=!0),localStorage.setItem("notificationsEnabled","true"),new Notification("Community Chat",{body:"Notifications enabled! You'll be notified of new messages.",icon:"/icon-192.png"})):(t(2,i=!1),localStorage.setItem("notificationsEnabled","false"))}function T(){St.set({general:[]}),localStorage.clear(),alert("All data cleared."),t(6,u=!1)}async function C(){t(7,f=!0)}async function E(){try{const w=window.location.origin.includes(":5173")?"http://localhost:3000":window.location.origin,N=await(await fetch(`${w}/api/clear-messages`,{method:"POST",headers:{"Content-Type":"application/json"}})).json();N.success?(St.set({general:[]}),alert("All server messages have been deleted successfully!")):alert("Failed to clear server messages: "+(N.error||"Unknown error"))}catch(w){console.error("Error clearing server messages:",w),alert("Failed to clear server messages. Check console for details.")}t(7,f=!1)}function S(){t(0,n=!1)}function b(w){ds.call(this,s,w)}const A=()=>t(6,u=!1),I=()=>t(7,f=!1);return s.$$set=w=>{"isOpen"in w&&t(0,n=w.isOpen)},[n,r,i,a,l,o,u,f,p,h,g,m,v,T,C,E,S,b,A,I]}class ud extends ct{constructor(e){super(),ut(this,e,cd,od,ot,{isOpen:0})}}function il(s,e,t){const n=s.slice();return n[14]=e[t],n}function ll(s){let e,t,n,r,i,a,l,o,u="Ã—",f,p,h,g;function m(C,E){return C[2].length===0?dd:fd}let v=m(s),T=v(s);return{c(){e=y("div"),t=y("div"),n=y("div"),r=y("h2"),i=K("ðŸ“Œ Pinned Messages in #"),a=K(s[1]),l=F(),o=y("button"),o.textContent=u,f=F(),p=y("div"),T.c(),this.h()},l(C){e=k(C,"DIV",{class:!0});var E=D(e);t=k(E,"DIV",{class:!0});var S=D(t);n=k(S,"DIV",{class:!0});var b=D(n);r=k(b,"H2",{class:!0});var A=D(r);i=Z(A,"ðŸ“Œ Pinned Messages in #"),a=Z(A,s[1]),A.forEach(_),l=P(b),o=k(b,"BUTTON",{class:!0,"data-svelte-h":!0}),$(o)!=="svelte-12zniqk"&&(o.textContent=u),b.forEach(_),f=P(S),p=k(S,"DIV",{class:!0});var I=D(p);T.l(I),I.forEach(_),S.forEach(_),E.forEach(_),this.h()},h(){d(r,"class","svelte-hvmvnm"),d(o,"class","close-btn svelte-hvmvnm"),d(n,"class","modal-header svelte-hvmvnm"),d(p,"class","modal-body svelte-hvmvnm"),d(t,"class","modal-content svelte-hvmvnm"),d(e,"class","modal-overlay svelte-hvmvnm")},m(C,E){V(C,e,E),c(e,t),c(t,n),c(n,r),c(r,i),c(r,a),c(n,l),c(n,o),c(t,f),c(t,p),T.m(p,null),h||(g=[X(o,"click",s[3]),X(t,"click",vt(s[9])),X(e,"click",s[3])],h=!0)},p(C,E){E&2&&ne(a,C[1]),v===(v=m(C))&&T?T.p(C,E):(T.d(1),T=v(C),T&&(T.c(),T.m(p,null)))},d(C){C&&_(e),T.d(),h=!1,De(g)}}}function fd(s){let e,t=[],n=new Map,r=ze(s[2]);const i=a=>a[14].id;for(let a=0;a<r.length;a+=1){let l=il(s,r,a),o=i(l);n.set(o,t[a]=al(o,l))}return{c(){e=y("div");for(let a=0;a<t.length;a+=1)t[a].c();this.h()},l(a){e=k(a,"DIV",{class:!0});var l=D(e);for(let o=0;o<t.length;o+=1)t[o].l(l);l.forEach(_),this.h()},h(){d(e,"class","pinned-messages-list svelte-hvmvnm")},m(a,l){V(a,e,l);for(let o=0;o<t.length;o+=1)t[o]&&t[o].m(e,null)},p(a,l){l&52&&(r=ze(a[2]),t=Qt(t,l,i,1,a,r,n,e,Kt,al,null,il))},d(a){a&&_(e);for(let l=0;l<t.length;l+=1)t[l].d()}}}function dd(s){let e,t='<p class="svelte-hvmvnm">No pinned messages in this channel</p> <p class="hint svelte-hvmvnm">Right-click a message and select &quot;Pin Message&quot; to pin it here.</p>';return{c(){e=y("div"),e.innerHTML=t,this.h()},l(n){e=k(n,"DIV",{class:!0,"data-svelte-h":!0}),$(e)!=="svelte-1esi9tz"&&(e.innerHTML=t),this.h()},h(){d(e,"class","empty-state svelte-hvmvnm")},m(n,r){V(n,e,r)},p:Ce,d(n){n&&_(e)}}}function al(s,e){let t,n,r,i,a=e[14].user+"",l,o,u,f=ol(e[14].timestamp)+"",p,h,g,m="Unpin",v,T,C=e[14].text+"",E,S,b,A;function I(){return e[10](e[14])}return{key:s,first:null,c(){t=y("div"),n=y("div"),r=y("div"),i=y("span"),l=K(a),o=F(),u=y("span"),p=K(f),h=F(),g=y("button"),g.textContent=m,v=F(),T=y("div"),E=K(C),S=F(),this.h()},l(w){t=k(w,"DIV",{class:!0});var O=D(t);n=k(O,"DIV",{class:!0});var N=D(n);r=k(N,"DIV",{class:!0});var M=D(r);i=k(M,"SPAN",{class:!0,style:!0});var L=D(i);l=Z(L,a),L.forEach(_),o=P(M),u=k(M,"SPAN",{class:!0});var B=D(u);p=Z(B,f),B.forEach(_),M.forEach(_),h=P(N),g=k(N,"BUTTON",{class:!0,title:!0,"data-svelte-h":!0}),$(g)!=="svelte-1nppumi"&&(g.textContent=m),N.forEach(_),v=P(O),T=k(O,"DIV",{class:!0});var H=D(T);E=Z(H,C),H.forEach(_),S=P(O),O.forEach(_),this.h()},h(){d(i,"class","username svelte-hvmvnm"),Ee(i,"color",e[5](e[14].user)),d(u,"class","timestamp svelte-hvmvnm"),d(r,"class","user-info svelte-hvmvnm"),d(g,"class","unpin-btn svelte-hvmvnm"),d(g,"title","Unpin message"),d(n,"class","message-header svelte-hvmvnm"),d(T,"class","message-text svelte-hvmvnm"),d(t,"class","pinned-message svelte-hvmvnm"),this.first=t},m(w,O){V(w,t,O),c(t,n),c(n,r),c(r,i),c(i,l),c(r,o),c(r,u),c(u,p),c(n,h),c(n,g),c(t,v),c(t,T),c(T,E),c(t,S),b||(A=X(g,"click",I),b=!0)},p(w,O){e=w,O&4&&a!==(a=e[14].user+"")&&ne(l,a),O&4&&Ee(i,"color",e[5](e[14].user)),O&4&&f!==(f=ol(e[14].timestamp)+"")&&ne(p,f),O&4&&C!==(C=e[14].text+"")&&ne(E,C)},d(w){w&&_(t),b=!1,A()}}}function hd(s){let e,t=s[0]&&ll(s);return{c(){t&&t.c(),e=Ie()},l(n){t&&t.l(n),e=Ie()},m(n,r){t&&t.m(n,r),V(n,e,r)},p(n,[r]){n[0]?t?t.p(n,r):(t=ll(n),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},i:Ce,o:Ce,d(n){n&&_(e),t&&t.d(n)}}}function ol(s){return new Date(s).toLocaleString("en-US",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}function pd(s,e,t){let n,r,i,a,l;Ne(s,Zt,C=>t(11,i=C)),Ne(s,us,C=>t(7,a=C)),Ne(s,St,C=>t(8,l=C));let{isOpen:o=!1}=e,{channelId:u=""}=e;function f(){t(0,o=!1)}function p(C){Tr(u,C)}function h(C){return i.find(E=>E.username===C)}function g(C){const E=h(C);return(E==null?void 0:E.color)||"var(--status-offline)"}function m(C){C.key==="Escape"&&o&&f()}rs(()=>(window.addEventListener("keydown",m),()=>{window.removeEventListener("keydown",m)}));function v(C){ds.call(this,s,C)}const T=C=>p(C.id);return s.$$set=C=>{"isOpen"in C&&t(0,o=C.isOpen),"channelId"in C&&t(6,u=C.channelId)},s.$$.update=()=>{var C;s.$$.dirty&320&&t(2,n=(l[u]||[]).filter(E=>E.isPinned)),s.$$.dirty&192&&t(1,r=((C=a.find(E=>E.id===u))==null?void 0:C.name)||u)},[o,r,n,f,p,g,u,a,l,v,T]}class gd extends ct{constructor(e){super(),ut(this,e,pd,hd,ot,{isOpen:0,channelId:6})}}function cl(s,e,t){const n=s.slice();return n[44]=e[t],n}function ul(s,e,t){const n=s.slice();return n[44]=e[t],n}function fl(s,e,t){const n=s.slice();return n[44]=e[t],n}function dl(s){let e,t,n,r,i="Create",a,l;return{c(){e=y("div"),t=y("input"),n=F(),r=y("button"),r.textContent=i,this.h()},l(o){e=k(o,"DIV",{class:!0});var u=D(e);t=k(u,"INPUT",{type:!0,placeholder:!0,class:!0}),n=P(u),r=k(u,"BUTTON",{class:!0,"data-svelte-h":!0}),$(r)!=="svelte-1ih09o9"&&(r.textContent=i),u.forEach(_),this.h()},h(){d(t,"type","text"),d(t,"placeholder","channel-name"),t.autofocus=!0,d(t,"class","svelte-yyh4lc"),d(r,"class","svelte-yyh4lc"),d(e,"class","create-channel svelte-yyh4lc")},m(o,u){V(o,e,u),c(e,t),lt(t,s[1]),c(e,n),c(e,r),t.focus(),a||(l=[X(t,"input",s[25]),X(t,"keydown",s[26]),X(r,"click",s[17])],a=!0)},p(o,u){u[0]&2&&t.value!==o[1]&&lt(t,o[1])},d(o){o&&_(e),a=!1,De(l)}}}function hl(s){let e,t="Ã—",n,r;function i(){return s[29](s[44])}return{c(){e=y("button"),e.textContent=t,this.h()},l(a){e=k(a,"BUTTON",{class:!0,"data-svelte-h":!0}),$(e)!=="svelte-12rgdhl"&&(e.textContent=t),this.h()},h(){d(e,"class","delete-btn svelte-yyh4lc")},m(a,l){V(a,e,l),n||(r=X(e,"click",vt(i)),n=!0)},p(a,l){s=a},d(a){a&&_(e),n=!1,r()}}}function pl(s,e){let t,n,r,i="#",a,l=e[44].name+"",o,u,f,p,h="ðŸ“Œ",g,m,v,T;function C(){return e[27](e[44])}function E(){return e[28](e[44])}let S=e[44].id!=="general"&&hl(e);return{key:s,first:null,c(){t=y("div"),n=y("button"),r=y("span"),r.textContent=i,a=F(),o=K(l),u=F(),f=y("div"),p=y("button"),p.textContent=h,g=F(),S&&S.c(),m=F(),this.h()},l(b){t=k(b,"DIV",{class:!0});var A=D(t);n=k(A,"BUTTON",{class:!0});var I=D(n);r=k(I,"SPAN",{class:!0,"data-svelte-h":!0}),$(r)!=="svelte-16vlh54"&&(r.textContent=i),a=P(I),o=Z(I,l),I.forEach(_),u=P(A),f=k(A,"DIV",{class:!0});var w=D(f);p=k(w,"BUTTON",{class:!0,title:!0,"data-svelte-h":!0}),$(p)!=="svelte-18aqzoy"&&(p.textContent=h),g=P(w),S&&S.l(w),w.forEach(_),m=P(A),A.forEach(_),this.h()},h(){d(r,"class","hash svelte-yyh4lc"),d(n,"class","channel-btn svelte-yyh4lc"),d(p,"class","pin-btn svelte-yyh4lc"),d(p,"title","View pinned messages"),d(f,"class","channel-actions svelte-yyh4lc"),d(t,"class","channel-item svelte-yyh4lc"),me(t,"active",e[14]===e[44].id),this.first=t},m(b,A){V(b,t,A),c(t,n),c(n,r),c(n,a),c(n,o),c(t,u),c(t,f),c(f,p),c(f,g),S&&S.m(f,null),c(t,m),v||(T=[X(n,"click",C),X(p,"click",vt(E))],v=!0)},p(b,A){e=b,A[0]&8192&&l!==(l=e[44].name+"")&&ne(o,l),e[44].id!=="general"?S?S.p(e,A):(S=hl(e),S.c(),S.m(f,null)):S&&(S.d(1),S=null),A[0]&24576&&me(t,"active",e[14]===e[44].id)},d(b){b&&_(t),S&&S.d(),v=!1,De(T)}}}function gl(s){let e,t="Direct Messages",n,r=[],i=new Map,a,l=ze(s[12]);const o=u=>u[44].id;for(let u=0;u<l.length;u+=1){let f=ul(s,l,u),p=o(f);i.set(p,r[u]=ml(p,f))}return{c(){e=y("div"),e.textContent=t,n=F();for(let u=0;u<r.length;u+=1)r[u].c();a=Ie(),this.h()},l(u){e=k(u,"DIV",{class:!0,"data-svelte-h":!0}),$(e)!=="svelte-r1afib"&&(e.textContent=t),n=P(u);for(let f=0;f<r.length;f+=1)r[f].l(u);a=Ie(),this.h()},h(){d(e,"class","section-header svelte-yyh4lc")},m(u,f){V(u,e,f),V(u,n,f);for(let p=0;p<r.length;p+=1)r[p]&&r[p].m(u,f);V(u,a,f)},p(u,f){f[0]&1396736&&(l=ze(u[12]),r=Qt(r,f,o,1,u,l,i,a.parentNode,Kt,ml,a,ul))},d(u){u&&(_(e),_(n),_(a));for(let f=0;f<r.length;f+=1)r[f].d(u)}}}function ml(s,e){let t,n,r,i="ðŸ’¬",a,l=e[44].name+"",o,u,f,p,h="ðŸ“Œ",g,m,v="Ã—",T,C,E;function S(){return e[30](e[44])}function b(){return e[31](e[44])}function A(){return e[32](e[44])}return{key:s,first:null,c(){t=y("div"),n=y("button"),r=y("span"),r.textContent=i,a=F(),o=K(l),u=F(),f=y("div"),p=y("button"),p.textContent=h,g=F(),m=y("button"),m.textContent=v,T=F(),this.h()},l(I){t=k(I,"DIV",{class:!0});var w=D(t);n=k(w,"BUTTON",{class:!0});var O=D(n);r=k(O,"SPAN",{class:!0,"data-svelte-h":!0}),$(r)!=="svelte-q0xuov"&&(r.textContent=i),a=P(O),o=Z(O,l),O.forEach(_),u=P(w),f=k(w,"DIV",{class:!0});var N=D(f);p=k(N,"BUTTON",{class:!0,title:!0,"data-svelte-h":!0}),$(p)!=="svelte-18aqzoy"&&(p.textContent=h),g=P(N),m=k(N,"BUTTON",{class:!0,"data-svelte-h":!0}),$(m)!=="svelte-12rgdhl"&&(m.textContent=v),N.forEach(_),T=P(w),w.forEach(_),this.h()},h(){d(r,"class","dm-icon svelte-yyh4lc"),d(n,"class","channel-btn svelte-yyh4lc"),d(p,"class","pin-btn svelte-yyh4lc"),d(p,"title","View pinned messages"),d(m,"class","delete-btn svelte-yyh4lc"),d(f,"class","channel-actions svelte-yyh4lc"),d(t,"class","channel-item svelte-yyh4lc"),me(t,"active",e[14]===e[44].id),this.first=t},m(I,w){V(I,t,w),c(t,n),c(n,r),c(n,a),c(n,o),c(t,u),c(t,f),c(f,p),c(f,g),c(f,m),c(t,T),C||(E=[X(n,"click",S),X(p,"click",vt(b)),X(m,"click",vt(A))],C=!0)},p(I,w){e=I,w[0]&4096&&l!==(l=e[44].name+"")&&ne(o,l),w[0]&20480&&me(t,"active",e[14]===e[44].id)},d(I){I&&_(t),C=!1,De(E)}}}function vl(s){let e,t="Group Chats",n,r=[],i=new Map,a,l=ze(s[11]);const o=u=>u[44].id;for(let u=0;u<l.length;u+=1){let f=cl(s,l,u),p=o(f);i.set(p,r[u]=_l(p,f))}return{c(){e=y("div"),e.textContent=t,n=F();for(let u=0;u<r.length;u+=1)r[u].c();a=Ie(),this.h()},l(u){e=k(u,"DIV",{class:!0,"data-svelte-h":!0}),$(e)!=="svelte-1fof55m"&&(e.textContent=t),n=P(u);for(let f=0;f<r.length;f+=1)r[f].l(u);a=Ie(),this.h()},h(){d(e,"class","section-header svelte-yyh4lc")},m(u,f){V(u,e,f),V(u,n,f);for(let p=0;p<r.length;p+=1)r[p]&&r[p].m(u,f);V(u,a,f)},p(u,f){f[0]&1394688&&(l=ze(u[11]),r=Qt(r,f,o,1,u,l,i,a.parentNode,Kt,_l,a,cl))},d(u){u&&(_(e),_(n),_(a));for(let f=0;f<r.length;f+=1)r[f].d(u)}}}function _l(s,e){let t,n,r,i="ðŸ‘¥",a,l=e[44].name+"",o,u,f,p,h="ðŸ“Œ",g,m,v="Ã—",T,C,E;function S(){return e[33](e[44])}function b(){return e[34](e[44])}function A(){return e[35](e[44])}return{key:s,first:null,c(){t=y("div"),n=y("button"),r=y("span"),r.textContent=i,a=F(),o=K(l),u=F(),f=y("div"),p=y("button"),p.textContent=h,g=F(),m=y("button"),m.textContent=v,T=F(),this.h()},l(I){t=k(I,"DIV",{class:!0});var w=D(t);n=k(w,"BUTTON",{class:!0});var O=D(n);r=k(O,"SPAN",{class:!0,"data-svelte-h":!0}),$(r)!=="svelte-4z5ugu"&&(r.textContent=i),a=P(O),o=Z(O,l),O.forEach(_),u=P(w),f=k(w,"DIV",{class:!0});var N=D(f);p=k(N,"BUTTON",{class:!0,title:!0,"data-svelte-h":!0}),$(p)!=="svelte-18aqzoy"&&(p.textContent=h),g=P(N),m=k(N,"BUTTON",{class:!0,"data-svelte-h":!0}),$(m)!=="svelte-12rgdhl"&&(m.textContent=v),N.forEach(_),T=P(w),w.forEach(_),this.h()},h(){d(r,"class","group-icon svelte-yyh4lc"),d(n,"class","channel-btn svelte-yyh4lc"),d(p,"class","pin-btn svelte-yyh4lc"),d(p,"title","View pinned messages"),d(m,"class","delete-btn svelte-yyh4lc"),d(f,"class","channel-actions svelte-yyh4lc"),d(t,"class","channel-item svelte-yyh4lc"),me(t,"active",e[14]===e[44].id),this.first=t},m(I,w){V(I,t,w),c(t,n),c(n,r),c(n,a),c(n,o),c(t,u),c(t,f),c(f,p),c(f,g),c(f,m),c(t,T),C||(E=[X(n,"click",S),X(p,"click",vt(b)),X(m,"click",vt(A))],C=!0)},p(I,w){e=I,w[0]&2048&&l!==(l=e[44].name+"")&&ne(o,l),w[0]&18432&&me(t,"active",e[14]===e[44].id)},d(I){I&&_(t),C=!1,De(E)}}}function bl(s){let e,t,n,r,i,a,l,o,u=s[15].username+"",f,p,h,g,m=s[15].id.slice(0,4)+"",v,T,C,E,S=s[4]?"ðŸ”‡":"ðŸŽ¤",b,A,I,w,O=s[5]?"ðŸ”‡":"ðŸŽ§",N,M,L,B,H="âš™ï¸",z,R;function x(j,G){return j[15].profilePicture?vd:md}let W=x(s),q=W(s);return{c(){e=y("div"),t=y("button"),n=y("div"),q.c(),r=F(),i=y("div"),a=F(),l=y("div"),o=y("div"),f=K(u),p=F(),h=y("div"),g=K("#"),v=K(m),T=F(),C=y("div"),E=y("button"),b=K(S),I=F(),w=y("button"),N=K(O),L=F(),B=y("button"),B.textContent=H,this.h()},l(j){e=k(j,"DIV",{class:!0});var G=D(e);t=k(G,"BUTTON",{class:!0});var Q=D(t);n=k(Q,"DIV",{class:!0});var Y=D(n);q.l(Y),r=P(Y),i=k(Y,"DIV",{class:!0}),D(i).forEach(_),Y.forEach(_),a=P(Q),l=k(Q,"DIV",{class:!0});var te=D(l);o=k(te,"DIV",{class:!0});var fe=D(o);f=Z(fe,u),fe.forEach(_),p=P(te),h=k(te,"DIV",{class:!0});var se=D(h);g=Z(se,"#"),v=Z(se,m),se.forEach(_),te.forEach(_),Q.forEach(_),T=P(G),C=k(G,"DIV",{class:!0});var ue=D(C);E=k(ue,"BUTTON",{class:!0,title:!0});var ce=D(E);b=Z(ce,S),ce.forEach(_),I=P(ue),w=k(ue,"BUTTON",{class:!0,title:!0});var le=D(w);N=Z(le,O),le.forEach(_),L=P(ue),B=k(ue,"BUTTON",{class:!0,title:!0,"data-svelte-h":!0}),$(B)!=="svelte-18txcln"&&(B.textContent=H),ue.forEach(_),G.forEach(_),this.h()},h(){d(i,"class","status-indicator svelte-yyh4lc"),me(i,"online",s[15].status==="active"),me(i,"away",s[15].status==="away"),me(i,"busy",s[15].status==="busy"),d(n,"class","avatar-container svelte-yyh4lc"),d(o,"class","username svelte-yyh4lc"),d(h,"class","user-tag svelte-yyh4lc"),d(l,"class","user-details svelte-yyh4lc"),d(t,"class","profile-info svelte-yyh4lc"),d(E,"class","control-btn svelte-yyh4lc"),d(E,"title",A=s[4]?"Unmute":"Mute"),me(E,"active",s[4]),d(w,"class","control-btn svelte-yyh4lc"),d(w,"title",M=s[5]?"Undeafen":"Deafen"),me(w,"active",s[5]),d(B,"class","control-btn svelte-yyh4lc"),d(B,"title","User Settings"),d(C,"class","profile-controls svelte-yyh4lc"),d(e,"class","profile-card svelte-yyh4lc")},m(j,G){V(j,e,G),c(e,t),c(t,n),q.m(n,null),c(n,r),c(n,i),c(t,a),c(t,l),c(l,o),c(o,f),c(l,p),c(l,h),c(h,g),c(h,v),c(e,T),c(e,C),c(C,E),c(E,b),c(C,I),c(C,w),c(w,N),c(C,L),c(C,B),z||(R=[X(t,"click",s[21]),X(E,"click",s[36]),X(w,"click",s[37]),X(B,"click",s[38])],z=!0)},p(j,G){W===(W=x(j))&&q?q.p(j,G):(q.d(1),q=W(j),q&&(q.c(),q.m(n,r))),G[0]&32768&&me(i,"online",j[15].status==="active"),G[0]&32768&&me(i,"away",j[15].status==="away"),G[0]&32768&&me(i,"busy",j[15].status==="busy"),G[0]&32768&&u!==(u=j[15].username+"")&&ne(f,u),G[0]&32768&&m!==(m=j[15].id.slice(0,4)+"")&&ne(v,m),G[0]&16&&S!==(S=j[4]?"ðŸ”‡":"ðŸŽ¤")&&ne(b,S),G[0]&16&&A!==(A=j[4]?"Unmute":"Mute")&&d(E,"title",A),G[0]&16&&me(E,"active",j[4]),G[0]&32&&O!==(O=j[5]?"ðŸ”‡":"ðŸŽ§")&&ne(N,O),G[0]&32&&M!==(M=j[5]?"Undeafen":"Deafen")&&d(w,"title",M),G[0]&32&&me(w,"active",j[5])},d(j){j&&_(e),q.d(),z=!1,De(R)}}}function md(s){let e,t=s[15].username.charAt(0).toUpperCase()+"",n;return{c(){e=y("div"),n=K(t),this.h()},l(r){e=k(r,"DIV",{class:!0,style:!0});var i=D(e);n=Z(i,t),i.forEach(_),this.h()},h(){d(e,"class","avatar-placeholder svelte-yyh4lc"),Ee(e,"background-color",s[15].color)},m(r,i){V(r,e,i),c(e,n)},p(r,i){i[0]&32768&&t!==(t=r[15].username.charAt(0).toUpperCase()+"")&&ne(n,t),i[0]&32768&&Ee(e,"background-color",r[15].color)},d(r){r&&_(e)}}}function vd(s){let e,t,n;return{c(){e=y("img"),this.h()},l(r){e=k(r,"IMG",{src:!0,alt:!0,class:!0}),this.h()},h(){Be(e.src,t=s[15].profilePicture)||d(e,"src",t),d(e,"alt",n=s[15].username),d(e,"class","avatar svelte-yyh4lc")},m(r,i){V(r,e,i)},p(r,i){i[0]&32768&&!Be(e.src,t=r[15].profilePicture)&&d(e,"src",t),i[0]&32768&&n!==(n=r[15].username)&&d(e,"alt",n)},d(r){r&&_(e)}}}function _d(s){let e,t,n='<div class="logo svelte-yyh4lc"><img src="/wabi-logo.png" alt="Wabi" class="logo-img svelte-yyh4lc"/></div>',r,i,a,l="Text Channels",o,u,f,p="ðŸ“º",h,g,m="+",v,T,C,E=[],S=new Map,b,A,I,w,O,N,M,L,B,H,z,R,x,W,q,j,G,Q,Y=s[2]&&dl(s),te=ze(s[13]);const fe=J=>J[44].id;for(let J=0;J<te.length;J+=1){let oe=fl(s,te,J),ye=fe(oe);S.set(ye,E[J]=pl(ye,oe))}let se=s[12].length>0&&gl(s),ue=s[11].length>0&&vl(s),ce=s[15]&&bl(s);function le(J){s[39](J)}let he={};s[3]!==void 0&&(he.isOpen=s[3]),O=new ud({props:he}),st.push(()=>Lt(O,"isOpen",le)),L=new Cs({props:{isOpen:s[6],title:"Delete Channel",message:"Delete channel #"+s[7]+"? This action cannot be undone.",confirmText:"Delete",variant:"danger",onConfirm:s[19],onCancel:s[40]}});function Re(J){s[41](J)}let ae={channelId:s[9]};s[8]!==void 0&&(ae.isOpen=s[8]),H=new gd({props:ae}),st.push(()=>Lt(H,"isOpen",Re));function Ve(J){s[42](J)}function Te(J){s[43](J)}let re={isOwnProfile:!0};return s[10]!==void 0&&(re.isOpen=s[10]),s[15]!==void 0&&(re.user=s[15]),x=new Sr({props:re}),st.push(()=>Lt(x,"isOpen",Ve)),st.push(()=>Lt(x,"user",Te)),{c(){e=y("div"),t=y("div"),t.innerHTML=n,r=F(),i=y("div"),a=y("h3"),a.textContent=l,o=F(),u=y("div"),f=y("button"),f.textContent=p,h=F(),g=y("button"),g.textContent=m,v=F(),Y&&Y.c(),T=F(),C=y("div");for(let J=0;J<E.length;J+=1)E[J].c();b=F(),se&&se.c(),A=F(),ue&&ue.c(),I=F(),ce&&ce.c(),w=F(),Ye(O.$$.fragment),M=F(),Ye(L.$$.fragment),B=F(),Ye(H.$$.fragment),R=F(),Ye(x.$$.fragment),this.h()},l(J){e=k(J,"DIV",{class:!0});var oe=D(e);t=k(oe,"DIV",{class:!0,"data-svelte-h":!0}),$(t)!=="svelte-18mdtge"&&(t.innerHTML=n),r=P(oe),i=k(oe,"DIV",{class:!0});var ye=D(i);a=k(ye,"H3",{class:!0,"data-svelte-h":!0}),$(a)!=="svelte-cahn79"&&(a.textContent=l),o=P(ye),u=k(ye,"DIV",{class:!0});var _e=D(u);f=k(_e,"BUTTON",{class:!0,title:!0,"data-svelte-h":!0}),$(f)!=="svelte-5el016"&&(f.textContent=p),h=P(_e),g=k(_e,"BUTTON",{class:!0,title:!0,"data-svelte-h":!0}),$(g)!=="svelte-ou792o"&&(g.textContent=m),_e.forEach(_),ye.forEach(_),v=P(oe),Y&&Y.l(oe),T=P(oe),C=k(oe,"DIV",{class:!0});var we=D(C);for(let xe=0;xe<E.length;xe+=1)E[xe].l(we);b=P(we),se&&se.l(we),A=P(we),ue&&ue.l(we),we.forEach(_),I=P(oe),ce&&ce.l(oe),oe.forEach(_),w=P(J),We(O.$$.fragment,J),M=P(J),We(L.$$.fragment,J),B=P(J),We(H.$$.fragment,J),R=P(J),We(x.$$.fragment,J),this.h()},h(){d(t,"class","top-section svelte-yyh4lc"),d(a,"class","svelte-yyh4lc"),d(f,"class","screen-share-icon-btn svelte-yyh4lc"),d(f,"title","Screen Share"),me(f,"active",s[0]==="screen"),d(g,"class","add-btn svelte-yyh4lc"),d(g,"title","Create channel"),d(u,"class","header-buttons svelte-yyh4lc"),d(i,"class","sidebar-header svelte-yyh4lc"),d(C,"class","channel-list svelte-yyh4lc"),d(e,"class","channel-sidebar svelte-yyh4lc")},m(J,oe){V(J,e,oe),c(e,t),c(e,r),c(e,i),c(i,a),c(i,o),c(i,u),c(u,f),c(u,h),c(u,g),c(e,v),Y&&Y.m(e,null),c(e,T),c(e,C);for(let ye=0;ye<E.length;ye+=1)E[ye]&&E[ye].m(C,null);c(C,b),se&&se.m(C,null),c(C,A),ue&&ue.m(C,null),c(e,I),ce&&ce.m(e,null),V(J,w,oe),Ge(O,J,oe),V(J,M,oe),Ge(L,J,oe),V(J,B,oe),Ge(H,J,oe),V(J,R,oe),Ge(x,J,oe),j=!0,G||(Q=[X(f,"click",s[23]),X(g,"click",s[24])],G=!0)},p(J,oe){(!j||oe[0]&1)&&me(f,"active",J[0]==="screen"),J[2]?Y?Y.p(J,oe):(Y=dl(J),Y.c(),Y.m(e,T)):Y&&(Y.d(1),Y=null),oe[0]&1400832&&(te=ze(J[13]),E=Qt(E,oe,fe,1,J,te,S,C,Kt,pl,b,fl)),J[12].length>0?se?se.p(J,oe):(se=gl(J),se.c(),se.m(C,A)):se&&(se.d(1),se=null),J[11].length>0?ue?ue.p(J,oe):(ue=vl(J),ue.c(),ue.m(C,null)):ue&&(ue.d(1),ue=null),J[15]?ce?ce.p(J,oe):(ce=bl(J),ce.c(),ce.m(e,null)):ce&&(ce.d(1),ce=null);const ye={};!N&&oe[0]&8&&(N=!0,ye.isOpen=J[3],Ft(()=>N=!1)),O.$set(ye);const _e={};oe[0]&64&&(_e.isOpen=J[6]),oe[0]&128&&(_e.message="Delete channel #"+J[7]+"? This action cannot be undone."),oe[0]&64&&(_e.onCancel=J[40]),L.$set(_e);const we={};oe[0]&512&&(we.channelId=J[9]),!z&&oe[0]&256&&(z=!0,we.isOpen=J[8],Ft(()=>z=!1)),H.$set(we);const xe={};!W&&oe[0]&1024&&(W=!0,xe.isOpen=J[10],Ft(()=>W=!1)),!q&&oe[0]&32768&&(q=!0,xe.user=J[15],Ft(()=>q=!1)),x.$set(xe)},i(J){j||(ke(O.$$.fragment,J),ke(L.$$.fragment,J),ke(H.$$.fragment,J),ke(x.$$.fragment,J),j=!0)},o(J){Ae(O.$$.fragment,J),Ae(L.$$.fragment,J),Ae(H.$$.fragment,J),Ae(x.$$.fragment,J),j=!1},d(J){J&&(_(e),_(w),_(M),_(B),_(R)),Y&&Y.d();for(let oe=0;oe<E.length;oe+=1)E[oe].d();se&&se.d(),ue&&ue.d(),ce&&ce.d(),He(O,J),He(L,J),He(H,J),He(x,J),G=!1,De(Q)}}}function bd(s,e,t){let n,r,i,a,l,o;Ne(s,us,ae=>t(22,a=ae)),Ne(s,Os,ae=>t(14,l=ae)),Ne(s,ns,ae=>t(15,o=ae));let{activeView:u="chat"}=e,f="",p=!1,h=!1,g=!1,m=!1,v=!1,T="",C=!1,E="",S=!1;function b(ae){ou(ae)}function A(){f.trim()&&(cu(f.trim()),t(1,f=""),t(2,p=!1))}function I(ae){t(7,T=ae),t(6,v=!0)}function w(){uu(T),t(6,v=!1)}function O(ae){t(9,E=ae),t(8,C=!0)}function N(){t(10,S=!0)}const M=()=>t(0,u="screen"),L=()=>t(2,p=!p);function B(){f=this.value,t(1,f)}const H=ae=>ae.key==="Enter"&&A(),z=ae=>b(ae.id),R=ae=>O(ae.id),x=ae=>I(ae.id),W=ae=>b(ae.id),q=ae=>O(ae.id),j=ae=>I(ae.id),G=ae=>b(ae.id),Q=ae=>O(ae.id),Y=ae=>I(ae.id),te=()=>t(4,g=!g),fe=()=>t(5,m=!m),se=()=>t(3,h=!0);function ue(ae){h=ae,t(3,h)}const ce=()=>t(6,v=!1);function le(ae){C=ae,t(8,C)}function he(ae){S=ae,t(10,S)}function Re(ae){o=ae,ns.set(o)}return s.$$set=ae=>{"activeView"in ae&&t(0,u=ae.activeView)},s.$$.update=()=>{s.$$.dirty[0]&4194304&&t(13,n=a.filter(ae=>!ae.type||ae.type==="public")),s.$$.dirty[0]&4194304&&t(12,r=a.filter(ae=>ae.type==="dm")),s.$$.dirty[0]&4194304&&t(11,i=a.filter(ae=>ae.type==="group")),s.$$.dirty[0]&1&&u==="chat"&&hu()},[u,f,p,h,g,m,v,T,C,E,S,i,r,n,l,o,b,A,I,w,O,N,a,M,L,B,H,z,R,x,W,q,j,G,Q,Y,te,fe,se,ue,ce,le,he,Re]}class kd extends ct{constructor(e){super(),ut(this,e,bd,_d,ot,{activeView:0},null,[-1,-1])}}const Cr=_t([]),In=_t(null),Fn=_t(!1),rn=_t(!1),ln=_t(!1),Ms=new Map;let ht=null;const xa={iceServers:[{urls:"stun:stun.l.google.com:19302"},{urls:"stun:stun1.l.google.com:19302"}]};async function kl(s,e,t=!1){try{return ht=await navigator.mediaDevices.getUserMedia({video:t,audio:!0}),Fn.set(!0),rn.set(!1),ln.set(!t),s.emit("call-initiate",{targetUserId:e,isVideoCall:t}),ht}catch(n){throw console.error("Error starting call:",n),n}}async function yd(s,e,t=!1){try{return ht=await navigator.mediaDevices.getUserMedia({video:t,audio:!0}),Fn.set(!0),rn.set(!1),ln.set(!t),s.emit("call-answer",{callerId:e,isVideoCall:t}),In.set(null),ht}catch(n){throw console.error("Error answering call:",n),n}}function wd(s,e){s.emit("call-reject",{callerId:e}),In.set(null)}function Zn(s){ht&&(ht.getTracks().forEach(e=>e.stop()),ht=null),Fn.set(!1),rn.set(!1),ln.set(!1),s.emit("call-end"),Ms.forEach(e=>e.close()),Ms.clear(),Cr.set([])}function Ed(){if(ht){const s=ht.getAudioTracks()[0];s&&(s.enabled=!s.enabled,rn.set(!s.enabled))}}function Td(){if(ht){const s=ht.getVideoTracks()[0];s&&(s.enabled=!s.enabled,ln.set(!s.enabled))}}async function Sd(s,e){const t=new RTCPeerConnection(xa);Ms.set(e,t),ht&&ht.getTracks().forEach(r=>{t.addTrack(r,ht)}),t.onicecandidate=r=>{r.candidate&&s.emit("call-ice-candidate",{candidate:r.candidate,targetId:e})},t.ontrack=r=>{Ua(e,r.streams[0])};const n=await t.createOffer();await t.setLocalDescription(n),s.emit("call-offer",{offer:n,targetId:e})}async function Ad(s,e,t,n){const r=new RTCPeerConnection(xa);Ms.set(e,r),ht&&ht.getTracks().forEach(a=>{r.addTrack(a,ht)}),r.ontrack=a=>{Ua(e,a.streams[0])},r.onicecandidate=a=>{a.candidate&&s.emit("call-ice-candidate",{candidate:a.candidate,targetId:e})},await r.setRemoteDescription(n);const i=await r.createAnswer();await r.setLocalDescription(i),s.emit("call-answer-sdp",{answer:i,targetId:e})}async function Cd(s,e){const t=Ms.get(s);t&&await t.setRemoteDescription(e)}async function Id(s,e){const t=Ms.get(s);t&&await t.addIceCandidate(e)}function Ua(s,e){Cr.update(t=>{const n=t.findIndex(i=>i.userId===s),r={userId:s,username:"",stream:e,isVideoEnabled:e.getVideoTracks().length>0,isAudioEnabled:e.getAudioTracks().length>0};return n>=0?(t[n]=r,t):[...t,r]})}function Dd(){return ht}function Od(s){let e,t=s[0].username.charAt(0).toUpperCase()+"",n;return{c(){e=y("div"),n=K(t),this.h()},l(r){e=k(r,"DIV",{class:!0,style:!0});var i=D(e);n=Z(i,t),i.forEach(_),this.h()},h(){d(e,"class","avatar-placeholder svelte-1uo45wz"),Ee(e,"background-color",s[0].color)},m(r,i){V(r,e,i),c(e,n)},p(r,i){i&1&&t!==(t=r[0].username.charAt(0).toUpperCase()+"")&&ne(n,t),i&1&&Ee(e,"background-color",r[0].color)},d(r){r&&_(e)}}}function Nd(s){let e,t,n;return{c(){e=y("img"),this.h()},l(r){e=k(r,"IMG",{src:!0,alt:!0,class:!0}),this.h()},h(){Be(e.src,t=s[0].profilePicture)||d(e,"src",t),d(e,"alt",n=s[0].username),d(e,"class","avatar svelte-1uo45wz")},m(r,i){V(r,e,i)},p(r,i){i&1&&!Be(e.src,t=r[0].profilePicture)&&d(e,"src",t),i&1&&n!==(n=r[0].username)&&d(e,"alt",n)},d(r){r&&_(e)}}}function yl(s){let e,t='<span class="icon svelte-1uo45wz">ðŸ’¬</span> <span>Send Message</span>',n,r,i='<span class="icon svelte-1uo45wz">ðŸ“ž</span> <span>Voice Call</span>',a,l,o='<span class="icon svelte-1uo45wz">ðŸ“¹</span> <span>Video Call</span>',u,f,p,h;return{c(){e=y("button"),e.innerHTML=t,n=F(),r=y("button"),r.innerHTML=i,a=F(),l=y("button"),l.innerHTML=o,u=F(),f=y("div"),this.h()},l(g){e=k(g,"BUTTON",{class:!0,"data-svelte-h":!0}),$(e)!=="svelte-1mal7hn"&&(e.innerHTML=t),n=P(g),r=k(g,"BUTTON",{class:!0,"data-svelte-h":!0}),$(r)!=="svelte-1om8irr"&&(r.innerHTML=i),a=P(g),l=k(g,"BUTTON",{class:!0,"data-svelte-h":!0}),$(l)!=="svelte-124vjww"&&(l.innerHTML=o),u=P(g),f=k(g,"DIV",{class:!0}),D(f).forEach(_),this.h()},h(){d(e,"class","menu-item svelte-1uo45wz"),d(r,"class","menu-item svelte-1uo45wz"),d(l,"class","menu-item svelte-1uo45wz"),d(f,"class","menu-divider svelte-1uo45wz")},m(g,m){V(g,e,m),V(g,n,m),V(g,r,m),V(g,a,m),V(g,l,m),V(g,u,m),V(g,f,m),p||(h=[X(e,"click",s[7]),X(r,"click",s[5]),X(l,"click",s[6])],p=!0)},p:Ce,d(g){g&&(_(e),_(n),_(r),_(a),_(l),_(u),_(f)),p=!1,De(h)}}}function Rd(s){let e,t,n,r,i,a=s[0].username+"",l,o,u,f,p,h,g='<span class="icon svelte-1uo45wz">ðŸ‘¤</span> <span>View Profile</span>',m,v;function T(b,A){return b[0].profilePicture?Nd:Od}let C=T(s),E=C(s),S=!s[3]&&yl(s);return{c(){e=y("div"),t=y("div"),n=y("div"),E.c(),r=F(),i=y("span"),l=K(a),o=F(),u=y("div"),f=F(),S&&S.c(),p=F(),h=y("button"),h.innerHTML=g,this.h()},l(b){e=k(b,"DIV",{class:!0,style:!0});var A=D(e);t=k(A,"DIV",{class:!0});var I=D(t);n=k(I,"DIV",{class:!0});var w=D(n);E.l(w),r=P(w),i=k(w,"SPAN",{class:!0});var O=D(i);l=Z(O,a),O.forEach(_),w.forEach(_),I.forEach(_),o=P(A),u=k(A,"DIV",{class:!0}),D(u).forEach(_),f=P(A),S&&S.l(A),p=P(A),h=k(A,"BUTTON",{class:!0,"data-svelte-h":!0}),$(h)!=="svelte-1rwejc6"&&(h.innerHTML=g),A.forEach(_),this.h()},h(){d(i,"class","username svelte-1uo45wz"),d(n,"class","user-info svelte-1uo45wz"),d(t,"class","menu-header svelte-1uo45wz"),d(u,"class","menu-divider svelte-1uo45wz"),d(h,"class","menu-item svelte-1uo45wz"),d(e,"class","context-menu svelte-1uo45wz"),Ee(e,"left",s[1]+"px"),Ee(e,"top",s[2]+"px")},m(b,A){V(b,e,A),c(e,t),c(t,n),E.m(n,null),c(n,r),c(n,i),c(i,l),c(e,o),c(e,u),c(e,f),S&&S.m(e,null),c(e,p),c(e,h),m||(v=[X(window,"click",s[4]),X(h,"click",s[8]),X(e,"click",vt(s[9]))],m=!0)},p(b,[A]){C===(C=T(b))&&E?E.p(b,A):(E.d(1),E=C(b),E&&(E.c(),E.m(n,r))),A&1&&a!==(a=b[0].username+"")&&ne(l,a),b[3]?S&&(S.d(1),S=null):S?S.p(b,A):(S=yl(b),S.c(),S.m(e,p)),A&2&&Ee(e,"left",b[1]+"px"),A&4&&Ee(e,"top",b[2]+"px")},i:Ce,o:Ce,d(b){b&&_(e),E.d(),S&&S.d(),m=!1,De(v)}}}function Pd(s,e,t){let{user:n}=e,{x:r}=e,{y:i}=e,{isOwnProfile:a}=e;const l=or();function o(m){l("close")}function u(){l("voiceCall"),l("close")}function f(){l("videoCall"),l("close")}function p(){l("openDM"),l("close")}function h(){l("viewProfile"),l("close")}function g(m){ds.call(this,s,m)}return s.$$set=m=>{"user"in m&&t(0,n=m.user),"x"in m&&t(1,r=m.x),"y"in m&&t(2,i=m.y),"isOwnProfile"in m&&t(3,a=m.isOwnProfile)},[n,r,i,a,o,u,f,p,h,g]}class Fd extends ct{constructor(e){super(),ut(this,e,Pd,Rd,ot,{user:0,x:1,y:2,isOwnProfile:3})}}function wl(s,e,t){const n=s.slice();return n[9]=e[t],n}function El(s){let e,t,n,r,i,a="Start a Direct Message",l,o,u="Ã—",f,p,h,g,m,v,T;function C(b,A){return b[2].length===0?Md:Ld}let E=C(s),S=E(s);return{c(){e=y("div"),t=F(),n=y("div"),r=y("div"),i=y("h2"),i.textContent=a,l=F(),o=y("button"),o.textContent=u,f=F(),p=y("div"),h=y("input"),g=F(),m=y("div"),S.c(),this.h()},l(b){e=k(b,"DIV",{class:!0}),D(e).forEach(_),t=P(b),n=k(b,"DIV",{class:!0});var A=D(n);r=k(A,"DIV",{class:!0});var I=D(r);i=k(I,"H2",{class:!0,"data-svelte-h":!0}),$(i)!=="svelte-14qt3ql"&&(i.textContent=a),l=P(I),o=k(I,"BUTTON",{class:!0,"data-svelte-h":!0}),$(o)!=="svelte-mm165g"&&(o.textContent=u),I.forEach(_),f=P(A),p=k(A,"DIV",{class:!0});var w=D(p);h=k(w,"INPUT",{type:!0,placeholder:!0,class:!0}),w.forEach(_),g=P(A),m=k(A,"DIV",{class:!0});var O=D(m);S.l(O),O.forEach(_),A.forEach(_),this.h()},h(){d(e,"class","modal-overlay svelte-1wgtlqt"),d(i,"class","svelte-1wgtlqt"),d(o,"class","close-btn svelte-1wgtlqt"),d(r,"class","modal-header svelte-1wgtlqt"),d(h,"type","text"),d(h,"placeholder","Search users..."),h.autofocus=!0,d(h,"class","svelte-1wgtlqt"),d(p,"class","search-container svelte-1wgtlqt"),d(m,"class","user-list svelte-1wgtlqt"),d(n,"class","modal svelte-1wgtlqt")},m(b,A){V(b,e,A),V(b,t,A),V(b,n,A),c(n,r),c(r,i),c(r,l),c(r,o),c(n,f),c(n,p),c(p,h),lt(h,s[1]),c(n,g),c(n,m),S.m(m,null),h.focus(),v||(T=[X(e,"click",s[4]),X(o,"click",s[4]),X(h,"input",s[7])],v=!0)},p(b,A){A&2&&h.value!==b[1]&&lt(h,b[1]),E===(E=C(b))&&S?S.p(b,A):(S.d(1),S=E(b),S&&(S.c(),S.m(m,null)))},d(b){b&&(_(e),_(t),_(n)),S.d(),v=!1,De(T)}}}function Ld(s){let e=[],t=new Map,n,r=ze(s[2]);const i=a=>a[9].id;for(let a=0;a<r.length;a+=1){let l=wl(s,r,a),o=i(l);t.set(o,e[a]=Tl(o,l))}return{c(){for(let a=0;a<e.length;a+=1)e[a].c();n=Ie()},l(a){for(let l=0;l<e.length;l+=1)e[l].l(a);n=Ie()},m(a,l){for(let o=0;o<e.length;o+=1)e[o]&&e[o].m(a,l);V(a,n,l)},p(a,l){l&12&&(r=ze(a[2]),e=Qt(e,l,i,1,a,r,t,n.parentNode,Kt,Tl,n,wl))},d(a){a&&_(n);for(let l=0;l<e.length;l+=1)e[l].d(a)}}}function Md(s){let e,t="No users found";return{c(){e=y("div"),e.textContent=t,this.h()},l(n){e=k(n,"DIV",{class:!0,"data-svelte-h":!0}),$(e)!=="svelte-wdjf3i"&&(e.textContent=t),this.h()},h(){d(e,"class","no-users svelte-1wgtlqt")},m(n,r){V(n,e,r)},p:Ce,d(n){n&&_(e)}}}function xd(s){let e,t=s[9].username.charAt(0).toUpperCase()+"",n;return{c(){e=y("div"),n=K(t),this.h()},l(r){e=k(r,"DIV",{class:!0,style:!0});var i=D(e);n=Z(i,t),i.forEach(_),this.h()},h(){d(e,"class","user-avatar-placeholder svelte-1wgtlqt"),Ee(e,"background-color",s[9].color)},m(r,i){V(r,e,i),c(e,n)},p(r,i){i&4&&t!==(t=r[9].username.charAt(0).toUpperCase()+"")&&ne(n,t),i&4&&Ee(e,"background-color",r[9].color)},d(r){r&&_(e)}}}function Ud(s){let e,t,n;return{c(){e=y("img"),this.h()},l(r){e=k(r,"IMG",{src:!0,alt:!0,class:!0}),this.h()},h(){Be(e.src,t=s[9].profilePicture)||d(e,"src",t),d(e,"alt",n=s[9].username),d(e,"class","user-avatar svelte-1wgtlqt")},m(r,i){V(r,e,i)},p(r,i){i&4&&!Be(e.src,t=r[9].profilePicture)&&d(e,"src",t),i&4&&n!==(n=r[9].username)&&d(e,"alt",n)},d(r){r&&_(e)}}}function Tl(s,e){let t,n,r,i,a,l,o,u=e[9].username+"",f,p,h,g=e[9].status+"",m,v,T,C;function E(I,w){return I[9].profilePicture?Ud:xd}let S=E(e),b=S(e);function A(){return e[8](e[9])}return{key:s,first:null,c(){t=y("button"),n=y("div"),b.c(),r=F(),i=y("div"),a=F(),l=y("div"),o=y("div"),f=K(u),p=F(),h=y("div"),m=K(g),v=F(),this.h()},l(I){t=k(I,"BUTTON",{class:!0});var w=D(t);n=k(w,"DIV",{class:!0});var O=D(n);b.l(O),r=P(O),i=k(O,"DIV",{class:!0,style:!0}),D(i).forEach(_),O.forEach(_),a=P(w),l=k(w,"DIV",{class:!0});var N=D(l);o=k(N,"DIV",{class:!0});var M=D(o);f=Z(M,u),M.forEach(_),p=P(N),h=k(N,"DIV",{class:!0});var L=D(h);m=Z(L,g),L.forEach(_),N.forEach(_),v=P(w),w.forEach(_),this.h()},h(){d(i,"class","status-indicator svelte-1wgtlqt"),Ee(i,"background-color",Sl(e[9].status)),d(n,"class","user-avatar-container svelte-1wgtlqt"),d(o,"class","username svelte-1wgtlqt"),d(h,"class","status-text svelte-1wgtlqt"),d(l,"class","user-info svelte-1wgtlqt"),d(t,"class","user-item svelte-1wgtlqt"),this.first=t},m(I,w){V(I,t,w),c(t,n),b.m(n,null),c(n,r),c(n,i),c(t,a),c(t,l),c(l,o),c(o,f),c(l,p),c(l,h),c(h,m),c(t,v),T||(C=X(t,"click",A),T=!0)},p(I,w){e=I,S===(S=E(e))&&b?b.p(e,w):(b.d(1),b=S(e),b&&(b.c(),b.m(n,r))),w&4&&Ee(i,"background-color",Sl(e[9].status)),w&4&&u!==(u=e[9].username+"")&&ne(f,u),w&4&&g!==(g=e[9].status+"")&&ne(m,g)},d(I){I&&_(t),b.d(),T=!1,C()}}}function Bd(s){let e,t=s[0]&&El(s);return{c(){t&&t.c(),e=Ie()},l(n){t&&t.l(n),e=Ie()},m(n,r){t&&t.m(n,r),V(n,e,r)},p(n,[r]){n[0]?t?t.p(n,r):(t=El(n),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},i:Ce,o:Ce,d(n){n&&_(e),t&&t.d(n)}}}function Sl(s){switch(s){case"active":return"var(--status-online)";case"away":return"var(--status-away)";case"busy":return"var(--status-busy)";default:return"var(--status-offline)"}}function Vd(s,e,t){let n,r,i;Ne(s,ns,h=>t(5,r=h)),Ne(s,Zt,h=>t(6,i=h));let{isOpen:a=!1}=e,l="";function o(h){Na(h.id),u()}function u(){t(0,a=!1),t(1,l="")}function f(){l=this.value,t(1,l)}const p=h=>o(h);return s.$$set=h=>{"isOpen"in h&&t(0,a=h.isOpen)},s.$$.update=()=>{s.$$.dirty&98&&t(2,n=i.filter(h=>h.id===(r==null?void 0:r.id)?!1:l?h.username.toLowerCase().includes(l.toLowerCase()):!0))},[a,l,n,o,u,r,i,f,p]}class zd extends ct{constructor(e){super(),ut(this,e,Vd,Bd,ot,{isOpen:0})}}function Al(s,e,t){const n=s.slice();return n[28]=e[t],n}function qd(s){let e,t=s[28].username.charAt(0).toUpperCase()+"",n;return{c(){e=y("div"),n=K(t),this.h()},l(r){e=k(r,"DIV",{class:!0,style:!0});var i=D(e);n=Z(i,t),i.forEach(_),this.h()},h(){d(e,"class","user-avatar-placeholder svelte-1dxxmv3"),Ee(e,"background-color",s[28].color)},m(r,i){V(r,e,i),c(e,n)},p(r,i){i&512&&t!==(t=r[28].username.charAt(0).toUpperCase()+"")&&ne(n,t),i&512&&Ee(e,"background-color",r[28].color)},d(r){r&&_(e)}}}function jd(s){let e,t,n;return{c(){e=y("img"),this.h()},l(r){e=k(r,"IMG",{src:!0,alt:!0,class:!0}),this.h()},h(){Be(e.src,t=s[28].profilePicture)||d(e,"src",t),d(e,"alt",n=s[28].username),d(e,"class","user-avatar svelte-1dxxmv3")},m(r,i){V(r,e,i)},p(r,i){i&512&&!Be(e.src,t=r[28].profilePicture)&&d(e,"src",t),i&512&&n!==(n=r[28].username)&&d(e,"alt",n)},d(r){r&&_(e)}}}function Cl(s){let e,t="(you)";return{c(){e=y("span"),e.textContent=t,this.h()},l(n){e=k(n,"SPAN",{class:!0,"data-svelte-h":!0}),$(e)!=="svelte-2b4nly"&&(e.textContent=t),this.h()},h(){d(e,"class","you-badge svelte-1dxxmv3")},m(n,r){V(n,e,r)},d(n){n&&_(e)}}}function Il(s){let e,t,n="ðŸ“ž",r,i,a="ðŸ“¹",l,o;function u(...p){return s[19](s[28],...p)}function f(...p){return s[20](s[28],...p)}return{c(){e=y("div"),t=y("button"),t.textContent=n,r=F(),i=y("button"),i.textContent=a,this.h()},l(p){e=k(p,"DIV",{class:!0});var h=D(e);t=k(h,"BUTTON",{class:!0,title:!0,"data-svelte-h":!0}),$(t)!=="svelte-jmuv4z"&&(t.textContent=n),r=P(h),i=k(h,"BUTTON",{class:!0,title:!0,"data-svelte-h":!0}),$(i)!=="svelte-1whn4df"&&(i.textContent=a),h.forEach(_),this.h()},h(){d(t,"class","call-btn voice-call svelte-1dxxmv3"),d(t,"title","Voice call"),d(i,"class","call-btn video-call svelte-1dxxmv3"),d(i,"title","Video call"),d(e,"class","call-buttons svelte-1dxxmv3")},m(p,h){V(p,e,h),c(e,t),c(e,r),c(e,i),l||(o=[X(t,"click",u),X(i,"click",f)],l=!0)},p(p,h){s=p},d(p){p&&_(e),l=!1,De(o)}}}function Dl(s,e){var B,H;let t,n,r,i,a,l=e[28].username+"",o,u,f,p,h,g,m,v=e[28].status+"",T,C,E,S,b;function A(z,R){return z[28].profilePicture?jd:qd}let I=A(e),w=I(e),O=e[28].id===((B=e[8])==null?void 0:B.id)&&Cl();function N(){return e[17](e[28])}function M(...z){return e[18](e[28],...z)}let L=e[28].id!==((H=e[8])==null?void 0:H.id)&&Il(e);return{key:s,first:null,c(){t=y("div"),n=y("button"),w.c(),r=F(),i=y("div"),a=y("span"),o=K(l),u=F(),O&&O.c(),f=F(),p=y("div"),h=y("span"),g=F(),m=y("span"),T=K(v),C=F(),L&&L.c(),E=F(),this.h()},l(z){t=k(z,"DIV",{class:!0});var R=D(t);n=k(R,"BUTTON",{class:!0});var x=D(n);w.l(x),r=P(x),i=k(x,"DIV",{class:!0});var W=D(i);a=k(W,"SPAN",{class:!0});var q=D(a);o=Z(q,l),u=P(q),O&&O.l(q),q.forEach(_),f=P(W),p=k(W,"DIV",{class:!0});var j=D(p);h=k(j,"SPAN",{class:!0,style:!0}),D(h).forEach(_),g=P(j),m=k(j,"SPAN",{class:!0});var G=D(m);T=Z(G,v),G.forEach(_),j.forEach(_),W.forEach(_),x.forEach(_),C=P(R),L&&L.l(R),E=P(R),R.forEach(_),this.h()},h(){d(a,"class","user-name svelte-1dxxmv3"),d(h,"class","status-dot svelte-1dxxmv3"),Ee(h,"background-color",Nl(e[28].status)),d(m,"class","status-text svelte-1dxxmv3"),d(p,"class","user-status svelte-1dxxmv3"),d(i,"class","user-info svelte-1dxxmv3"),d(n,"class","user svelte-1dxxmv3"),d(t,"class","user-container svelte-1dxxmv3"),this.first=t},m(z,R){V(z,t,R),c(t,n),w.m(n,null),c(n,r),c(n,i),c(i,a),c(a,o),c(a,u),O&&O.m(a,null),c(i,f),c(i,p),c(p,h),c(p,g),c(p,m),c(m,T),c(t,C),L&&L.m(t,null),c(t,E),S||(b=[X(n,"click",N),X(n,"contextmenu",M)],S=!0)},p(z,R){var x,W;e=z,I===(I=A(e))&&w?w.p(e,R):(w.d(1),w=I(e),w&&(w.c(),w.m(n,r))),R&512&&l!==(l=e[28].username+"")&&ne(o,l),e[28].id===((x=e[8])==null?void 0:x.id)?O||(O=Cl(),O.c(),O.m(a,null)):O&&(O.d(1),O=null),R&512&&Ee(h,"background-color",Nl(e[28].status)),R&512&&v!==(v=e[28].status+"")&&ne(T,v),e[28].id!==((W=e[8])==null?void 0:W.id)?L?L.p(e,R):(L=Il(e),L.c(),L.m(t,E)):L&&(L.d(1),L=null)},d(z){z&&_(t),w.d(),O&&O.d(),L&&L.d(),S=!1,De(b)}}}function Ol(s){var n;let e,t;return e=new Fd({props:{user:s[5],x:s[6],y:s[7],isOwnProfile:s[5].id===((n=s[8])==null?void 0:n.id)}}),e.$on("close",s[12]),e.$on("voiceCall",s[23]),e.$on("videoCall",s[24]),e.$on("openDM",s[13]),e.$on("viewProfile",s[25]),{c(){Ye(e.$$.fragment)},l(r){We(e.$$.fragment,r)},m(r,i){Ge(e,r,i),t=!0},p(r,i){var l;const a={};i&32&&(a.user=r[5]),i&64&&(a.x=r[6]),i&128&&(a.y=r[7]),i&288&&(a.isOwnProfile=r[5].id===((l=r[8])==null?void 0:l.id)),e.$set(a)},i(r){t||(ke(e.$$.fragment,r),t=!0)},o(r){Ae(e.$$.fragment,r),t=!1},d(r){He(e,r)}}}function Hd(s){let e,t,n,r,i=s[9].length+"",a,l,o,u,f="ðŸ’¬",p,h,g=[],m=new Map,v,T,C,E,S,b,A,I,w,O,N,M=ze(s[9]);const L=q=>q[28].id;for(let q=0;q<M.length;q+=1){let j=Al(s,M,q),G=L(j);m.set(G,g[q]=Dl(G,j))}function B(q){s[21](q)}function H(q){s[22](q)}let z={isOwnProfile:s[2]};s[0]!==void 0&&(z.isOpen=s[0]),s[1]!==void 0&&(z.user=s[1]),T=new Sr({props:z}),st.push(()=>Lt(T,"isOpen",B)),st.push(()=>Lt(T,"user",H));let R=s[4]&&s[5]&&Ol(s);function x(q){s[26](q)}let W={};return s[3]!==void 0&&(W.isOpen=s[3]),A=new zd({props:W}),st.push(()=>Lt(A,"isOpen",x)),{c(){e=y("aside"),t=y("div"),n=y("h3"),r=K("Online ("),a=K(i),l=K(")"),o=F(),u=y("button"),u.textContent=f,p=F(),h=y("div");for(let q=0;q<g.length;q+=1)g[q].c();v=F(),Ye(T.$$.fragment),S=F(),R&&R.c(),b=F(),Ye(A.$$.fragment),this.h()},l(q){e=k(q,"ASIDE",{class:!0});var j=D(e);t=k(j,"DIV",{class:!0});var G=D(t);n=k(G,"H3",{class:!0});var Q=D(n);r=Z(Q,"Online ("),a=Z(Q,i),l=Z(Q,")"),Q.forEach(_),o=P(G),u=k(G,"BUTTON",{class:!0,title:!0,"data-svelte-h":!0}),$(u)!=="svelte-1sotr3f"&&(u.textContent=f),G.forEach(_),p=P(j),h=k(j,"DIV",{class:!0});var Y=D(h);for(let te=0;te<g.length;te+=1)g[te].l(Y);Y.forEach(_),j.forEach(_),v=P(q),We(T.$$.fragment,q),S=P(q),R&&R.l(q),b=P(q),We(A.$$.fragment,q),this.h()},h(){d(n,"class","svelte-1dxxmv3"),d(u,"class","dm-btn svelte-1dxxmv3"),d(u,"title","Start a DM"),d(t,"class","panel-header svelte-1dxxmv3"),d(h,"class","user-list svelte-1dxxmv3"),d(e,"class","user-panel svelte-1dxxmv3")},m(q,j){V(q,e,j),c(e,t),c(t,n),c(n,r),c(n,a),c(n,l),c(t,o),c(t,u),c(e,p),c(e,h);for(let G=0;G<g.length;G+=1)g[G]&&g[G].m(h,null);V(q,v,j),Ge(T,q,j),V(q,S,j),R&&R.m(q,j),V(q,b,j),Ge(A,q,j),w=!0,O||(N=X(u,"click",s[14]),O=!0)},p(q,[j]){(!w||j&512)&&i!==(i=q[9].length+"")&&ne(a,i),j&102144&&(M=ze(q[9]),g=Qt(g,j,L,1,q,M,m,h,Kt,Dl,null,Al));const G={};j&4&&(G.isOwnProfile=q[2]),!C&&j&1&&(C=!0,G.isOpen=q[0],Ft(()=>C=!1)),!E&&j&2&&(E=!0,G.user=q[1],Ft(()=>E=!1)),T.$set(G),q[4]&&q[5]?R?(R.p(q,j),j&48&&ke(R,1)):(R=Ol(q),R.c(),ke(R,1),R.m(b.parentNode,b)):R&&(xs(),Ae(R,1,1,()=>{R=null}),Us());const Q={};!I&&j&8&&(I=!0,Q.isOpen=q[3],Ft(()=>I=!1)),A.$set(Q)},i(q){w||(ke(T.$$.fragment,q),ke(R),ke(A.$$.fragment,q),w=!0)},o(q){Ae(T.$$.fragment,q),Ae(R),Ae(A.$$.fragment,q),w=!1},d(q){q&&(_(e),_(v),_(S),_(b));for(let j=0;j<g.length;j+=1)g[j].d();He(T,q),R&&R.d(q),He(A,q),O=!1,N()}}}function Nl(s){switch(s){case"active":return"var(--status-online)";case"away":return"var(--status-away)";case"busy":return"var(--status-busy)";default:return"var(--status-offline)"}}function Gd(s,e,t){let n,r,i;Ne(s,Vs,R=>t(27,n=R)),Ne(s,ns,R=>t(8,r=R)),Ne(s,Zt,R=>t(9,i=R));let a=!1,l=null,o=!1,u=!1,f=!1,p=null,h=0,g=0;function m(R){t(1,l=R),t(2,o=R.id===(r==null?void 0:r.id)),t(0,a=!0)}function v(R,x){R.preventDefault(),R.stopPropagation(),t(5,p=x),t(6,h=R.clientX),t(7,g=R.clientY),t(4,f=!0)}function T(){t(4,f=!1),t(5,p=null)}function C(){p&&Na(p.id)}function E(){t(3,u=!0)}async function S(R,x){R&&R.stopPropagation();const W=x||p;if(!(!n||!W||W.id===(r==null?void 0:r.id)))try{await kl(n,W.id,!1)}catch{alert("Failed to start voice call. Please check microphone permissions.")}}async function b(R,x){R&&R.stopPropagation();const W=x||p;if(!(!n||!W||W.id===(r==null?void 0:r.id)))try{await kl(n,W.id,!0)}catch{alert("Failed to start video call. Please check camera and microphone permissions.")}}const A=R=>m(R),I=(R,x)=>v(x,R),w=(R,x)=>S(x,R),O=(R,x)=>b(x,R);function N(R){a=R,t(0,a)}function M(R){l=R,t(1,l)}const L=()=>S(),B=()=>b(),H=()=>{p&&m(p)};function z(R){u=R,t(3,u)}return[a,l,o,u,f,p,h,g,r,i,m,v,T,C,E,S,b,A,I,w,O,N,M,L,B,H,z]}class Wd extends ct{constructor(e){super(),ut(this,e,Gd,Hd,ot,{})}}const Ir=_t([]),Dr=_t(!1),vs=new Map;let fs=null;const Ba={iceServers:[{urls:"stun:stun.l.google.com:19302"},{urls:"stun:stun1.l.google.com:19302"}]};async function Yd(s){try{return fs=await navigator.mediaDevices.getDisplayMedia({video:!0,audio:!1}),Dr.set(!0),s.emit("start-screen-share"),fs.getVideoTracks()[0].onended=()=>{Va(s)},fs}catch(e){throw console.error("Error starting screen share:",e),e}}function Va(s){fs&&(fs.getTracks().forEach(e=>e.stop()),fs=null),Dr.set(!1),s.emit("stop-screen-share"),vs.forEach(e=>e.close()),vs.clear()}async function Xd(s,e){const t=new RTCPeerConnection(Ba);vs.set(e,t),fs&&fs.getTracks().forEach(r=>{t.addTrack(r,fs)}),t.onicecandidate=r=>{r.candidate&&s.emit("webrtc-ice-candidate",{candidate:r.candidate,targetId:e})};const n=await t.createOffer();await t.setLocalDescription(n),s.emit("webrtc-offer",{offer:n,targetId:e})}async function Zd(s,e,t,n){const r=new RTCPeerConnection(Ba);vs.set(e,r),r.ontrack=a=>{Ir.update(l=>{const o=l.findIndex(f=>f.userId===e),u={userId:e,username:t,stream:a.streams[0]};return o>=0?(l[o]=u,l):[...l,u]})},r.onicecandidate=a=>{a.candidate&&s.emit("webrtc-ice-candidate",{candidate:a.candidate,targetId:e})},await r.setRemoteDescription(n);const i=await r.createAnswer();await r.setLocalDescription(i),s.emit("webrtc-answer",{answer:i,targetId:e})}async function Kd(s,e){const t=vs.get(s);t&&await t.setRemoteDescription(e)}async function Qd(s,e){const t=vs.get(s);t&&await t.addIceCandidate(e)}function Jd(s){Ir.update(t=>t.filter(n=>n.userId!==s));const e=vs.get(s);e&&(e.close(),vs.delete(s))}function Rl(s,e,t){const n=s.slice();return n[12]=e[t],n}function $d(s){let e,t="Start Sharing",n,r;return{c(){e=y("button"),e.textContent=t},l(i){e=k(i,"BUTTON",{"data-svelte-h":!0}),$(e)!=="svelte-1ms5zeg"&&(e.textContent=t)},m(i,a){V(i,e,a),n||(r=X(e,"click",s[6]),n=!0)},p:Ce,d(i){i&&_(e),n=!1,r()}}}function eh(s){let e,t="Stop Sharing",n,r;return{c(){e=y("button"),e.textContent=t,this.h()},l(i){e=k(i,"BUTTON",{class:!0,"data-svelte-h":!0}),$(e)!=="svelte-1urv00m"&&(e.textContent=t),this.h()},h(){d(e,"class","stop-btn svelte-1oqngqd")},m(i,a){V(i,e,a),n||(r=X(e,"click",s[7]),n=!0)},p:Ce,d(i){i&&_(e),n=!1,r()}}}function Pl(s){let e,t;return{c(){e=y("div"),t=K(s[2]),this.h()},l(n){e=k(n,"DIV",{class:!0});var r=D(e);t=Z(r,s[2]),r.forEach(_),this.h()},h(){d(e,"class","error svelte-1oqngqd")},m(n,r){V(n,e,r),c(e,t)},p(n,r){r&4&&ne(t,n[2])},d(n){n&&_(e)}}}function Fl(s){let e,t,n='<span class="badge svelte-1oqngqd">Your Screen</span>',r,i;return{c(){e=y("div"),t=y("div"),t.innerHTML=n,r=F(),i=y("video"),this.h()},l(a){e=k(a,"DIV",{class:!0});var l=D(e);t=k(l,"DIV",{class:!0,"data-svelte-h":!0}),$(t)!=="svelte-16dlolc"&&(t.innerHTML=n),r=P(l),i=k(l,"VIDEO",{class:!0}),D(i).forEach(_),l.forEach(_),this.h()},h(){d(t,"class","screen-header svelte-1oqngqd"),i.autoplay=!0,i.muted=!0,i.playsInline=!0,d(i,"class","svelte-1oqngqd"),d(e,"class","screen-item svelte-1oqngqd")},m(a,l){V(a,e,l),c(e,t),c(e,r),c(e,i),s[9](i)},p:Ce,d(a){a&&_(e),s[9](null)}}}function Ll(s,e){let t,n,r,i=e[12].username+"",a,l,o,u,f,p,h;return{key:s,first:null,c(){t=y("div"),n=y("div"),r=y("span"),a=K(i),l=K("'s Screen"),o=F(),u=y("video"),this.h()},l(g){t=k(g,"DIV",{class:!0});var m=D(t);n=k(m,"DIV",{class:!0});var v=D(n);r=k(v,"SPAN",{class:!0});var T=D(r);a=Z(T,i),l=Z(T,"'s Screen"),T.forEach(_),v.forEach(_),o=P(m),u=k(m,"VIDEO",{class:!0}),D(u).forEach(_),m.forEach(_),this.h()},h(){d(r,"class","username svelte-1oqngqd"),d(n,"class","screen-header svelte-1oqngqd"),u.autoplay=!0,u.playsInline=!0,d(u,"class","svelte-1oqngqd"),d(t,"class","screen-item svelte-1oqngqd"),this.first=t},m(g,m){V(g,t,m),c(t,n),c(n,r),c(r,a),c(r,l),c(t,o),c(t,u),p||(h=Xa(f=sh.call(null,u,e[12].stream)),p=!0)},p(g,m){e=g,m&16&&i!==(i=e[12].username+"")&&ne(a,i),f&&Is(f.update)&&m&16&&f.update.call(null,e[12].stream)},d(g){g&&_(t),p=!1,h()}}}function Ml(s){let e,t='<p class="svelte-1oqngqd">No active screen shares</p> <p class="hint svelte-1oqngqd">Click &quot;Start Sharing&quot; to share your screen</p>';return{c(){e=y("div"),e.innerHTML=t,this.h()},l(n){e=k(n,"DIV",{class:!0,"data-svelte-h":!0}),$(e)!=="svelte-reuplr"&&(e.innerHTML=t),this.h()},h(){d(e,"class","empty-state svelte-1oqngqd")},m(n,r){V(n,e,r)},d(n){n&&_(e)}}}function th(s){let e,t,n,r,i="â† Back",a,l,o="ðŸ–¥ï¸ Screen Sharing",u,f,p,h,g,m=[],v=new Map,T,C,E;function S(L,B){return L[3]?eh:$d}let b=S(s),A=b(s),I=s[2]&&Pl(s),w=s[3]&&s[0]&&Fl(s),O=ze(s[4]);const N=L=>L[12].userId;for(let L=0;L<O.length;L+=1){let B=Rl(s,O,L),H=N(B);v.set(H,m[L]=Ll(H,B))}let M=!s[3]&&s[4].length===0&&Ml();return{c(){e=y("div"),t=y("div"),n=y("div"),r=y("button"),r.textContent=i,a=F(),l=y("h2"),l.textContent=o,u=F(),A.c(),f=F(),I&&I.c(),p=F(),h=y("div"),w&&w.c(),g=F();for(let L=0;L<m.length;L+=1)m[L].c();T=F(),M&&M.c(),this.h()},l(L){e=k(L,"DIV",{class:!0});var B=D(e);t=k(B,"DIV",{class:!0});var H=D(t);n=k(H,"DIV",{class:!0});var z=D(n);r=k(z,"BUTTON",{class:!0,title:!0,"data-svelte-h":!0}),$(r)!=="svelte-ts724a"&&(r.textContent=i),a=P(z),l=k(z,"H2",{class:!0,"data-svelte-h":!0}),$(l)!=="svelte-1el2fdv"&&(l.textContent=o),z.forEach(_),u=P(H),A.l(H),H.forEach(_),f=P(B),I&&I.l(B),p=P(B),h=k(B,"DIV",{class:!0});var R=D(h);w&&w.l(R),g=P(R);for(let x=0;x<m.length;x+=1)m[x].l(R);T=P(R),M&&M.l(R),R.forEach(_),B.forEach(_),this.h()},h(){d(r,"class","back-btn svelte-1oqngqd"),d(r,"title","Back to chat"),d(l,"class","svelte-1oqngqd"),d(n,"class","header-left svelte-1oqngqd"),d(t,"class","header svelte-1oqngqd"),d(h,"class","screens svelte-1oqngqd"),d(e,"class","screen-share-container svelte-1oqngqd")},m(L,B){V(L,e,B),c(e,t),c(t,n),c(n,r),c(n,a),c(n,l),c(t,u),A.m(t,null),c(e,f),I&&I.m(e,null),c(e,p),c(e,h),w&&w.m(h,null),c(h,g);for(let H=0;H<m.length;H+=1)m[H]&&m[H].m(h,null);c(h,T),M&&M.m(h,null),C||(E=X(r,"click",s[5]),C=!0)},p(L,[B]){b===(b=S(L))&&A?A.p(L,B):(A.d(1),A=b(L),A&&(A.c(),A.m(t,null))),L[2]?I?I.p(L,B):(I=Pl(L),I.c(),I.m(e,p)):I&&(I.d(1),I=null),L[3]&&L[0]?w?w.p(L,B):(w=Fl(L),w.c(),w.m(h,g)):w&&(w.d(1),w=null),B&16&&(O=ze(L[4]),m=Qt(m,B,N,1,L,O,v,h,Kt,Ll,T,Rl)),!L[3]&&L[4].length===0?M||(M=Ml(),M.c(),M.m(h,null)):M&&(M.d(1),M=null)},i:Ce,o:Ce,d(L){L&&_(e),A.d(),I&&I.d(),w&&w.d();for(let B=0;B<m.length;B+=1)m[B].d();M&&M.d(),C=!1,E()}}}function sh(s,e){return console.log("Setting remote video srcObject",e,"tracks:",e.getTracks()),s.srcObject=e,s.play().catch(t=>console.error("Error playing remote video:",t)),{update(t){console.log("Updating remote video srcObject",t,"tracks:",t.getTracks()),s.srcObject=t,s.play().catch(n=>console.error("Error playing updated remote video:",n))}}}function nh(s,e,t){let n,r,i,a;Ne(s,Vs,v=>t(10,n=v)),Ne(s,Dr,v=>t(3,r=v)),Ne(s,Zt,v=>t(11,i=v)),Ne(s,Ir,v=>t(4,a=v));let{activeView:l="screen"}=e,o=null,u="",f;function p(){t(8,l="chat")}async function h(){try{if(!n)return;t(0,o=await Yd(n)),console.log("Screen share started, stream:",o),console.log("Stream tracks:",o==null?void 0:o.getTracks()),console.log("Video tracks:",o==null?void 0:o.getVideoTracks()),t(2,u="")}catch(v){t(2,u="Failed to start screen sharing. Please grant permissions."),console.error("Screen share error:",v)}}function g(){n&&(Va(n),t(0,o=null))}rs(()=>{n&&(n.on("screen-share-started",async v=>{n&&(console.log(`${v.username} started screen sharing`),ua(),t(8,l="screen"),document.hidden&&"Notification"in window&&Notification.permission==="granted"&&new Notification("Screen Share Started",{body:`${v.username} is sharing their screen`,icon:"/icon-192.png"}))}),n.on("screen-share-stopped",v=>{Jd(v)}),n.on("webrtc-offer",async v=>{if(!n)return;const T=i.find(C=>C.id===v.senderId);T&&await Zd(n,v.senderId,T.username,v.offer)}),n.on("webrtc-answer",async v=>{await Kd(v.senderId,v.answer)}),n.on("webrtc-ice-candidate",async v=>{await Qd(v.senderId,v.candidate)}),n.on("user-joined",async v=>{r&&n&&setTimeout(()=>{n&&Xd(n,v.id)},1e3)}))});function m(v){st[v?"unshift":"push"](()=>{f=v,t(1,f),t(0,o)})}return s.$$set=v=>{"activeView"in v&&t(8,l=v.activeView)},s.$$.update=()=>{s.$$.dirty&3&&f&&o&&(console.log("Setting local video srcObject",o),t(1,f.srcObject=o,f),f.play().catch(v=>console.error("Error playing local video:",v)))},[o,f,u,r,a,p,h,g,l,m]}class rh extends ct{constructor(e){super(),ut(this,e,nh,th,ot,{activeView:8})}}function xl(s,e,t){const n=s.slice();return n[17]=e[t],n[18]=e,n[19]=t,n}function Ul(s){let e,t,n,r,i=s[2].username.charAt(0).toUpperCase()+"",a,l,o,u=s[2].username+"",f,p,h,g=s[2].isVideoCall?"ðŸ“¹ Video":"ðŸ“ž Voice",m,v,T,C,E,S=`<span class="btn-icon svelte-1mc89jk">ðŸ“ž</span>
					Answer`,b,A,I=`<span class="btn-icon svelte-1mc89jk">âœ–ï¸</span>
					Decline`,w,O;return{c(){e=y("div"),t=y("div"),n=y("div"),r=y("div"),a=K(i),l=F(),o=y("h2"),f=K(u),p=F(),h=y("p"),m=K(g),v=K(" Call"),T=F(),C=y("div"),E=y("button"),E.innerHTML=S,b=F(),A=y("button"),A.innerHTML=I,this.h()},l(N){e=k(N,"DIV",{class:!0});var M=D(e);t=k(M,"DIV",{class:!0});var L=D(t);n=k(L,"DIV",{class:!0});var B=D(n);r=k(B,"DIV",{class:!0});var H=D(r);a=Z(H,i),H.forEach(_),l=P(B),o=k(B,"H2",{class:!0});var z=D(o);f=Z(z,u),z.forEach(_),p=P(B),h=k(B,"P",{class:!0});var R=D(h);m=Z(R,g),v=Z(R," Call"),R.forEach(_),B.forEach(_),T=P(L),C=k(L,"DIV",{class:!0});var x=D(C);E=k(x,"BUTTON",{class:!0,"data-svelte-h":!0}),$(E)!=="svelte-u3s2jz"&&(E.innerHTML=S),b=P(x),A=k(x,"BUTTON",{class:!0,"data-svelte-h":!0}),$(A)!=="svelte-om1ns7"&&(A.innerHTML=I),x.forEach(_),L.forEach(_),M.forEach(_),this.h()},h(){d(r,"class","caller-avatar svelte-1mc89jk"),d(o,"class","svelte-1mc89jk"),d(h,"class","call-type svelte-1mc89jk"),d(n,"class","caller-info svelte-1mc89jk"),d(E,"class","answer-btn svelte-1mc89jk"),d(A,"class","reject-btn svelte-1mc89jk"),d(C,"class","call-actions svelte-1mc89jk"),d(t,"class","incoming-call-modal svelte-1mc89jk"),d(e,"class","call-modal-overlay svelte-1mc89jk")},m(N,M){V(N,e,M),c(e,t),c(t,n),c(n,r),c(r,a),c(n,l),c(n,o),c(o,f),c(n,p),c(n,h),c(h,m),c(h,v),c(t,T),c(t,C),c(C,E),c(C,b),c(C,A),w||(O=[X(E,"click",s[7]),X(A,"click",s[8])],w=!0)},p(N,M){M&4&&i!==(i=N[2].username.charAt(0).toUpperCase()+"")&&ne(a,i),M&4&&u!==(u=N[2].username+"")&&ne(f,u),M&4&&g!==(g=N[2].isVideoCall?"ðŸ“¹ Video":"ðŸ“ž Voice")&&ne(m,g)},d(N){N&&_(e),w=!1,De(O)}}}function Bl(s){let e,t,n,r,i,a,l,o="You",u,f=[],p=new Map,h,g,m,v,T=s[6]?"ðŸ”‡":"ðŸŽ¤",C,E,S,b,A,I=s[5]?"ðŸ“¹":"ðŸ“·",w,O,N,M,L='<span class="control-icon svelte-1mc89jk">ðŸ“ž</span>',B,H,z=s[5]&&Vl(),R=ze(s[3]);const x=W=>W[17].userId;for(let W=0;W<R.length;W+=1){let q=xl(s,R,W),j=x(q);p.set(j,f[W]=ql(j,q))}return{c(){e=y("div"),t=y("div"),n=y("div"),r=y("video"),i=F(),z&&z.c(),a=F(),l=y("div"),l.textContent=o,u=F();for(let W=0;W<f.length;W+=1)f[W].c();h=F(),g=y("div"),m=y("button"),v=y("span"),C=K(T),S=F(),b=y("button"),A=y("span"),w=K(I),N=F(),M=y("button"),M.innerHTML=L,this.h()},l(W){e=k(W,"DIV",{class:!0});var q=D(e);t=k(q,"DIV",{class:!0});var j=D(t);n=k(j,"DIV",{class:!0});var G=D(n);r=k(G,"VIDEO",{class:!0}),D(r).forEach(_),i=P(G),z&&z.l(G),a=P(G),l=k(G,"DIV",{class:!0,"data-svelte-h":!0}),$(l)!=="svelte-1l6ztyc"&&(l.textContent=o),G.forEach(_),u=P(j);for(let ue=0;ue<f.length;ue+=1)f[ue].l(j);j.forEach(_),h=P(q),g=k(q,"DIV",{class:!0});var Q=D(g);m=k(Q,"BUTTON",{class:!0,title:!0});var Y=D(m);v=k(Y,"SPAN",{class:!0});var te=D(v);C=Z(te,T),te.forEach(_),Y.forEach(_),S=P(Q),b=k(Q,"BUTTON",{class:!0,title:!0});var fe=D(b);A=k(fe,"SPAN",{class:!0});var se=D(A);w=Z(se,I),se.forEach(_),fe.forEach(_),N=P(Q),M=k(Q,"BUTTON",{class:!0,title:!0,"data-svelte-h":!0}),$(M)!=="svelte-1rszrze"&&(M.innerHTML=L),Q.forEach(_),q.forEach(_),this.h()},h(){r.autoplay=!0,r.muted=!0,r.playsInline=!0,d(r,"class","video-element svelte-1mc89jk"),me(r,"video-hidden",s[5]),d(l,"class","video-label svelte-1mc89jk"),d(n,"class","video-wrapper local-video svelte-1mc89jk"),d(t,"class","video-grid svelte-1mc89jk"),d(v,"class","control-icon svelte-1mc89jk"),d(m,"class","control-btn svelte-1mc89jk"),d(m,"title",E=s[6]?"Unmute":"Mute"),me(m,"active",s[6]),d(A,"class","control-icon svelte-1mc89jk"),d(b,"class","control-btn svelte-1mc89jk"),d(b,"title",O=s[5]?"Turn on camera":"Turn off camera"),me(b,"active",s[5]),d(M,"class","control-btn end-call-btn svelte-1mc89jk"),d(M,"title","End call"),d(g,"class","call-controls svelte-1mc89jk"),d(e,"class","active-call-container svelte-1mc89jk")},m(W,q){V(W,e,q),c(e,t),c(t,n),c(n,r),s[13](r),c(n,i),z&&z.m(n,null),c(n,a),c(n,l),c(t,u);for(let j=0;j<f.length;j+=1)f[j]&&f[j].m(t,null);c(e,h),c(e,g),c(g,m),c(m,v),c(v,C),c(g,S),c(g,b),c(b,A),c(A,w),c(g,N),c(g,M),B||(H=[X(m,"click",s[10]),X(b,"click",s[11]),X(M,"click",s[9])],B=!0)},p(W,q){q&32&&me(r,"video-hidden",W[5]),W[5]?z||(z=Vl(),z.c(),z.m(n,a)):z&&(z.d(1),z=null),q&10&&(R=ze(W[3]),f=Qt(f,q,x,1,W,R,p,t,Kt,ql,null,xl)),q&64&&T!==(T=W[6]?"ðŸ”‡":"ðŸŽ¤")&&ne(C,T),q&64&&E!==(E=W[6]?"Unmute":"Mute")&&d(m,"title",E),q&64&&me(m,"active",W[6]),q&32&&I!==(I=W[5]?"ðŸ“¹":"ðŸ“·")&&ne(w,I),q&32&&O!==(O=W[5]?"Turn on camera":"Turn off camera")&&d(b,"title",O),q&32&&me(b,"active",W[5])},d(W){W&&_(e),s[13](null),z&&z.d();for(let q=0;q<f.length;q+=1)f[q].d();B=!1,De(H)}}}function Vl(s){let e,t='<span class="placeholder-icon svelte-1mc89jk">ðŸ“¹</span> <span>Camera Off</span>';return{c(){e=y("div"),e.innerHTML=t,this.h()},l(n){e=k(n,"DIV",{class:!0,"data-svelte-h":!0}),$(e)!=="svelte-57tuav"&&(e.innerHTML=t),this.h()},h(){d(e,"class","video-placeholder svelte-1mc89jk")},m(n,r){V(n,e,r)},d(n){n&&_(e)}}}function zl(s){let e,t,n="ðŸ‘¤",r,i,a=(s[17].username||"User")+"",l;return{c(){e=y("div"),t=y("span"),t.textContent=n,r=F(),i=y("span"),l=K(a),this.h()},l(o){e=k(o,"DIV",{class:!0});var u=D(e);t=k(u,"SPAN",{class:!0,"data-svelte-h":!0}),$(t)!=="svelte-18bpbb5"&&(t.textContent=n),r=P(u),i=k(u,"SPAN",{});var f=D(i);l=Z(f,a),f.forEach(_),u.forEach(_),this.h()},h(){d(t,"class","placeholder-icon svelte-1mc89jk"),d(e,"class","video-placeholder svelte-1mc89jk")},m(o,u){V(o,e,u),c(e,t),c(e,r),c(e,i),c(i,l)},p(o,u){u&8&&a!==(a=(o[17].username||"User")+"")&&ne(l,a)},d(o){o&&_(e)}}}function ql(s,e){let t,n,r=e[17],i,a,l,o=(e[17].username||"User")+"",u,f;const p=()=>e[14](n,r),h=()=>e[14](null,r);let g=!e[17].isVideoEnabled&&zl(e);return{key:s,first:null,c(){t=y("div"),n=y("video"),i=F(),g&&g.c(),a=F(),l=y("div"),u=K(o),f=F(),this.h()},l(m){t=k(m,"DIV",{class:!0});var v=D(t);n=k(v,"VIDEO",{class:!0}),D(n).forEach(_),i=P(v),g&&g.l(v),a=P(v),l=k(v,"DIV",{class:!0});var T=D(l);u=Z(T,o),T.forEach(_),f=P(v),v.forEach(_),this.h()},h(){n.autoplay=!0,n.playsInline=!0,d(n,"class","video-element svelte-1mc89jk"),me(n,"video-hidden",!e[17].isVideoEnabled),d(l,"class","video-label svelte-1mc89jk"),d(t,"class","video-wrapper remote-video svelte-1mc89jk"),this.first=t},m(m,v){V(m,t,v),c(t,n),p(),c(t,i),g&&g.m(t,null),c(t,a),c(t,l),c(l,u),c(t,f)},p(m,v){e=m,r!==e[17]&&(h(),r=e[17],p()),v&8&&me(n,"video-hidden",!e[17].isVideoEnabled),e[17].isVideoEnabled?g&&(g.d(1),g=null):g?g.p(e,v):(g=zl(e),g.c(),g.m(t,a)),v&8&&o!==(o=(e[17].username||"User")+"")&&ne(u,o)},d(m){m&&_(t),h(),g&&g.d()}}}function ih(s){let e,t,n=s[2]&&Ul(s),r=s[4]&&Bl(s);return{c(){n&&n.c(),e=F(),r&&r.c(),t=Ie()},l(i){n&&n.l(i),e=P(i),r&&r.l(i),t=Ie()},m(i,a){n&&n.m(i,a),V(i,e,a),r&&r.m(i,a),V(i,t,a)},p(i,[a]){i[2]?n?n.p(i,a):(n=Ul(i),n.c(),n.m(e.parentNode,e)):n&&(n.d(1),n=null),i[4]?r?r.p(i,a):(r=Bl(i),r.c(),r.m(t.parentNode,t)):r&&(r.d(1),r=null)},i:Ce,o:Ce,d(i){i&&(_(e),_(t)),n&&n.d(i),r&&r.d(i)}}}function lh(s,e,t){let n,r,i,a,l,o;Ne(s,Vs,b=>t(15,n=b)),Ne(s,In,b=>t(2,r=b)),Ne(s,Cr,b=>t(3,i=b)),Ne(s,Fn,b=>t(4,a=b)),Ne(s,ln,b=>t(5,l=b)),Ne(s,rn,b=>t(6,o=b));let u,f={},p=null;rs(()=>{n&&(n.on("call-incoming",b=>{In.set({userId:b.userId,username:b.username,isVideoCall:b.isVideoCall})}),n.on("call-accepted",async b=>{await Sd(n,b.userId)}),n.on("call-rejected",b=>{alert("Call was rejected"),Zn(n)}),n.on("call-ended",b=>{Zn(n)}),n.on("call-offer",async b=>{const A=i.find(w=>w.userId===b.senderId)||r,I=A?A.username:"Unknown";await Ad(n,b.senderId,I,b.offer)}),n.on("call-answer-sdp",async b=>{await Cd(b.senderId,b.answer)}),n.on("call-ice-candidate",async b=>{await Id(b.senderId,b.candidate)}))}),Xl(()=>{n&&(n.off("call-incoming"),n.off("call-accepted"),n.off("call-rejected"),n.off("call-ended"),n.off("call-offer"),n.off("call-answer-sdp"),n.off("call-ice-candidate"))});function h(){fa()}async function g(){!r||!n||await yd(n,r.userId,r.isVideoCall)}function m(){!r||!n||wd(n,r.userId)}function v(){n&&Zn(n)}function T(){Ed()}function C(){Td()}function E(b){st[b?"unshift":"push"](()=>{u=b,t(0,u),t(4,a)})}function S(b,A){st[b?"unshift":"push"](()=>{f[A.userId]=b,t(1,f)})}return s.$$.update=()=>{if(s.$$.dirty&4100&&(r?(h(),t(12,p=Ho(r.username,r.isVideoCall,()=>g()))):p&&(p.close(),t(12,p=null))),s.$$.dirty&17&&a&&u){const b=Dd();b&&t(0,u.srcObject=b,u)}s.$$.dirty&10&&i.length>0&&i.forEach(b=>{const A=f[b.userId];A&&b.stream&&(A.srcObject=b.stream)})},[u,f,r,i,a,l,o,g,m,v,T,C,p,E,S]}class ah extends ct{constructor(e){super(),ut(this,e,lh,ih,ot,{})}}const{window:jl}=Zl;function oh(s){let e,t,n,r,i,a,l,o,u,f,p,h,g,m,v,T,C,E=s[2]?"â†’":"â†",S,b,A,I,w,O,N,M;function L(x){s[13](x)}let B={};s[1]!==void 0&&(B.activeView=s[1]),n=new kd({props:B}),st.push(()=>Lt(n,"activeView",L)),f=new $f({});function H(x){s[14](x)}let z={};s[1]!==void 0&&(z.activeView=s[1]),g=new rh({props:z}),st.push(()=>Lt(g,"activeView",H));let R=s[2]&&Hl(s);return w=new ah({}),{c(){e=y("div"),t=y("div"),Ye(n.$$.fragment),i=F(),a=y("div"),l=F(),o=y("div"),u=y("div"),Ye(f.$$.fragment),p=F(),h=y("div"),Ye(g.$$.fragment),v=F(),R&&R.c(),T=F(),C=y("button"),S=K(E),I=F(),Ye(w.$$.fragment),this.h()},l(x){e=k(x,"DIV",{class:!0});var W=D(e);t=k(W,"DIV",{class:!0,style:!0});var q=D(t);We(n.$$.fragment,q),i=P(q),a=k(q,"DIV",{class:!0}),D(a).forEach(_),q.forEach(_),l=P(W),o=k(W,"DIV",{class:!0});var j=D(o);u=k(j,"DIV",{class:!0});var G=D(u);We(f.$$.fragment,G),G.forEach(_),p=P(j),h=k(j,"DIV",{class:!0});var Q=D(h);We(g.$$.fragment,Q),Q.forEach(_),j.forEach(_),v=P(W),R&&R.l(W),T=P(W),C=k(W,"BUTTON",{class:!0,title:!0,style:!0});var Y=D(C);S=Z(Y,E),Y.forEach(_),W.forEach(_),I=P(x),We(w.$$.fragment,x),this.h()},h(){d(a,"class","resize-handle resize-handle-channel svelte-10wao8h"),d(t,"class","channel-sidebar-container svelte-10wao8h"),Ee(t,"width",s[3]+"px"),d(u,"class","svelte-10wao8h"),me(u,"hidden",s[1]!=="chat"),d(h,"class","svelte-10wao8h"),me(h,"hidden",s[1]!=="screen"),d(o,"class","main-content svelte-10wao8h"),d(C,"class","user-panel-toggle svelte-10wao8h"),d(C,"title",b=s[2]?"Hide user panel":"Show user panel"),d(C,"style",A=s[2]?`right: ${s[4]}px`:"right: 0"),me(C,"open",s[2]),d(e,"class","app-container svelte-10wao8h"),me(e,"resizing",s[5]||s[6])},m(x,W){V(x,e,W),c(e,t),Ge(n,t,null),c(t,i),c(t,a),c(e,l),c(e,o),c(o,u),Ge(f,u,null),c(o,p),c(o,h),Ge(g,h,null),c(e,v),R&&R.m(e,null),c(e,T),c(e,C),c(C,S),V(x,I,W),Ge(w,x,W),O=!0,N||(M=[X(a,"mousedown",s[8]),X(C,"click",s[15])],N=!0)},p(x,W){const q={};!r&&W&2&&(r=!0,q.activeView=x[1],Ft(()=>r=!1)),n.$set(q),(!O||W&8)&&Ee(t,"width",x[3]+"px"),(!O||W&2)&&me(u,"hidden",x[1]!=="chat");const j={};!m&&W&2&&(m=!0,j.activeView=x[1],Ft(()=>m=!1)),g.$set(j),(!O||W&2)&&me(h,"hidden",x[1]!=="screen"),x[2]?R?(R.p(x,W),W&4&&ke(R,1)):(R=Hl(x),R.c(),ke(R,1),R.m(e,T)):R&&(xs(),Ae(R,1,1,()=>{R=null}),Us()),(!O||W&4)&&E!==(E=x[2]?"â†’":"â†")&&ne(S,E),(!O||W&4&&b!==(b=x[2]?"Hide user panel":"Show user panel"))&&d(C,"title",b),(!O||W&20&&A!==(A=x[2]?`right: ${x[4]}px`:"right: 0"))&&d(C,"style",A),(!O||W&4)&&me(C,"open",x[2]),(!O||W&96)&&me(e,"resizing",x[5]||x[6])},i(x){O||(ke(n.$$.fragment,x),ke(f.$$.fragment,x),ke(g.$$.fragment,x),ke(R),ke(w.$$.fragment,x),O=!0)},o(x){Ae(n.$$.fragment,x),Ae(f.$$.fragment,x),Ae(g.$$.fragment,x),Ae(R),Ae(w.$$.fragment,x),O=!1},d(x){x&&(_(e),_(I)),He(n),He(f),He(g),R&&R.d(),He(w,x),N=!1,De(M)}}}function ch(s){let e,t;return e=new sd({}),e.$on("login",s[7]),{c(){Ye(e.$$.fragment)},l(n){We(e.$$.fragment,n)},m(n,r){Ge(e,n,r),t=!0},p:Ce,i(n){t||(ke(e.$$.fragment,n),t=!0)},o(n){Ae(e.$$.fragment,n),t=!1},d(n){He(e,n)}}}function Hl(s){let e,t,n,r,i,a,l;return r=new Wd({}),{c(){e=y("div"),t=y("div"),n=F(),Ye(r.$$.fragment),this.h()},l(o){e=k(o,"DIV",{class:!0,style:!0});var u=D(e);t=k(u,"DIV",{class:!0}),D(t).forEach(_),n=P(u),We(r.$$.fragment,u),u.forEach(_),this.h()},h(){d(t,"class","resize-handle resize-handle-user svelte-10wao8h"),d(e,"class","user-panel-container svelte-10wao8h"),Ee(e,"width",s[4]+"px")},m(o,u){V(o,e,u),c(e,t),c(e,n),Ge(r,e,null),i=!0,a||(l=X(t,"mousedown",s[9]),a=!0)},p(o,u){(!i||u&16)&&Ee(e,"width",o[4]+"px")},i(o){i||(ke(r.$$.fragment,o),i=!0)},o(o){Ae(r.$$.fragment,o),i=!1},d(o){o&&_(e),He(r),a=!1,l()}}}function uh(s){let e,t,n,r,i,a;const l=[ch,oh],o=[];function u(f,p){return f[0]?1:0}return e=u(s),t=o[e]=l[e](s),{c(){t.c(),n=Ie()},l(f){t.l(f),n=Ie()},m(f,p){o[e].m(f,p),V(f,n,p),r=!0,i||(a=[X(jl,"mousemove",s[10]),X(jl,"mouseup",s[11])],i=!0)},p(f,[p]){let h=e;e=u(f),e===h?o[e].p(f,p):(xs(),Ae(o[h],1,1,()=>{o[h]=null}),Us(),t=o[e],t?t.p(f,p):(t=o[e]=l[e](f),t.c()),ke(t,1),t.m(n.parentNode,n))},i(f){r||(ke(t),r=!0)},o(f){Ae(t),r=!1},d(f){f&&_(n),o[e].d(f),i=!1,De(a)}}}function fh(s,e,t){let{data:n}=e,r="",i=!1,a="chat",l=!1,o=240,u=250,f=!1,p=!1;rs(async()=>{localStorage.getItem("notificationsEnabled")!=="false"&&await Go()});function h(b){r=b.detail,au(r),t(0,i=!0)}function g(b){t(5,f=!0),b.preventDefault()}function m(b){t(6,p=!0),b.preventDefault()}function v(b){if(f){const A=b.clientX;A>=180&&A<=400&&t(3,o=A)}else if(p){const A=window.innerWidth-b.clientX;A>=200&&A<=500&&t(4,u=A)}}function T(){t(5,f=!1),t(6,p=!1)}Xl(()=>{du()});function C(b){a=b,t(1,a)}function E(b){a=b,t(1,a)}const S=()=>t(2,l=!l);return s.$$set=b=>{"data"in b&&t(12,n=b.data)},[i,a,l,o,u,f,p,h,g,m,v,T,n,C,E,S]}class _h extends ct{constructor(e){super(),ut(this,e,fh,uh,ot,{data:12})}}export{_h as component};
